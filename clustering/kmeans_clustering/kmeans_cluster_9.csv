commit,file,added_code,deleted_code,hash_clean,cve_id,hash,repo_url,rel_type,score,extraction_status,text_norm,cluster_kmeans
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9
