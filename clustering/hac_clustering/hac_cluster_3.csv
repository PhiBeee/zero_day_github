commit,file,added_code,deleted_code,hash_clean,cve_id,hash,repo_url,rel_type,score,extraction_status,text_norm,cluster_kmeans,cluster_hac
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,collector/README.md,"# How to collect data for vectorizing
This process should be run first. This will enable you to collect a ton of data across various sources. Currently the following services are supported:
- [x] YouTube Channels
- [x] Medium
- [x] Substack
- [x] Arbitrary Link
- [x] Gitbook
- [x] Local Files (.txt, .pdf, etc) [See full list](./hotdir/__HOTDIR__.md)
_these resources are under development or require PR_
- Twitter
![Choices](../images/choices.png)

### Requirements
- [ ] Python 3.8+
- [ ] Google Cloud Account (for YouTube channels)
- [ ] `brew install pandoc` [pandoc](https://pandoc.org/installing.html) (for .ODT document processing)

### Setup
This example will be using python3.9, but will work with 3.8+. Tested on MacOs. Untested on Windows
- install virtualenv for python3.8+ first before any other steps. `python3.9 -m pip install virtualenv`
- `cd collector` from root directory
- `python3.9 -m virtualenv v-env`
- `source v-env/bin/activate`
- `pip install -r requirements.txt`
- `cp .env.example .env`
- `python main.py` for interactive collection or `python watch.py` to process local documents.
- Select the option you want and follow follow the prompts - Done!
- run `deactivate` to get back to regular shell

### Outputs
All JSON file data is cached in the `output/` folder. This is to prevent redundant API calls to services which may have rate limits to quota caps. Clearing out the `output/` folder will execute the script as if there was no cache.

As files are processed you will see data being written to both the `collector/outputs` folder as well as the `server/documents` folder. Later in this process, once you boot up the server you will then bulk vectorize this content from a simple UI!

If collection fails at any point in the process it will pick up where it last bailed out so you are not reusing credits.

### Running the document processing API locally
From the `collector` directory with the `v-env` active run `flask run --host '0.0.0.0' --port 8888`.
Now uploads from the frontend will be processed as if you ran the `watch.py` script manually.

**Docker**: If you run this application via docker the API is already started for you and no additional action is needed.

### How to get a Google Cloud API Key (YouTube data collection only)
**required to fetch YouTube transcripts and data**
- Have a google account
- [Visit the GCP Cloud Console](https://console.cloud.google.com/welcome)
- Click on dropdown in top right > Create new project. Name it whatever you like
  - ![GCP Project Bar](../images/gcp-project-bar.png)
- [Enable YouTube Data APIV3](https://console.cloud.google.com/apis/library/youtube.googleapis.com)
- Once enabled generate a Credential key for this API
- Paste your key after `GOOGLE_APIS_KEY=` in your `collector/.env` file.

### Using ther Twitter API
***required to get data form twitter with tweepy**
- Go to https://developer.twitter.com/en/portal/dashboard with your twitter account
- Create a new Project App
  - Get your 4 keys and place them in your `collector.env` file
  * TW_CONSUMER_KEY
  * TW_CONSUMER_SECRET
  * TW_ACCESS_TOKEN
  * TW_ACCESS_TOKEN_SECRET
  populate the .env with the values",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR: - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR VAR (.VAR, .VAR, VAR) [VAR VAR VAR](./VAR/VAR.VAR) VAR VAR VAR VAR VAR VAR VAR VAR - VAR ![VAR](../VAR/VAR.VAR)  - [ ] VAR 3.8+ - [ ] VAR VAR VAR (VAR VAR VAR) - [ ] `VAR VAR VAR` [VAR](VAR:  VAR VAR VAR VAR VAR VAR.9, VAR VAR VAR VAR 3.8+. VAR VAR VAR. VAR VAR VAR - VAR VAR VAR VAR.8+ VAR VAR VAR VAR VAR. `VAR.9 -VAR VAR VAR VAR` - `VAR VAR` VAR VAR VAR - `VAR.9 -VAR VAR VAR-VAR` - `VAR VAR-VAR/VAR/VAR` - `VAR VAR -VAR VAR.VAR` - `VAR .VAR.VAR .VAR` - `VAR VAR.VAR` VAR VAR VAR VAR `VAR VAR.VAR` VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR! - VAR `VAR` VAR VAR VAR VAR VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR `VAR/` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR/VAR` VAR VAR VAR VAR VAR `VAR/VAR` VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR `VAR` VAR VAR VAR `VAR-VAR` VAR VAR `VAR VAR --VAR '0.0.0.0' --VAR 8888`. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. **VAR**: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  **VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR VAR - [VAR VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR > VAR VAR VAR. VAR VAR VAR VAR VAR - ![VAR VAR VAR](../VAR/VAR-VAR-VAR.VAR) - [VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR `VAR=` VAR VAR `VAR/.VAR` VAR.  ***VAR VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR: - VAR VAR VAR VAR VAR - VAR VAR 4 VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR * VAR * VAR * VAR * VAR VAR VAR .VAR VAR VAR VAR ",0,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,collector/scripts/yt_utils.py,"import json, requests, os, re
from slugify import slugify
from dotenv import load_dotenv
load_dotenv()

def is_yt_short(videoId):
    url = 'https://www.youtube.com/shorts/' + videoId
    ret = requests.head(url)
    return ret.status_code == 200

def get_channel_id(channel_link):
  if('@' in channel_link):
    pattern = r'https?://www\.youtube\.com/(@\w+)/?'
    match = re.match(pattern, channel_link)
    if match is False: return None
    handle = match.group(1)
    print('Need to map username to channelId - this can take a while sometimes.')
    response = requests.get(f""https://yt.lemnoslife.com/channels?handle={handle}"", timeout=20)

    if(response.ok == False):
      print(""Handle => ChannelId mapping endpoint is too slow - use regular youtube.com/channel URL"")
      return None

    json_data = response.json()
    return json_data.get('items')[0].get('id')
  else:
    pattern = r""youtube\.com/channel/([\w-]+)""
    match = re.search(pattern, channel_link)
    return match.group(1) if match else None


def clean_text(text):
  return re.sub(r""\[.*?\]"", """", text)

def append_meta(video, duration, text):
  meta = {
    'youtubeURL': f""https://youtube.com/watch?v={video.get('id')}"",
    'thumbnail': video.get('thumbnail'),
    'description': video.get('description'),
    'createdAt': video.get('published'),
    'videoDurationInSeconds': duration,
  }
  return ""Video JSON Metadata:\n""+json.dumps(meta, indent=4)+""\n\n\nAudio Transcript:\n"" + text

def get_duration(json_str):
  data = json.loads(json_str)
  return data[-1].get('start')

def fetch_channel_video_information(channel_id, windowSize = 50):
    if channel_id == None or len(channel_id) == 0:
      print(""No channel id provided!"")
      exit(1)

    if os.path.isdir(""./outputs/channel-logs"") == False:
      os.makedirs(""./outputs/channel-logs"")

    file_path = f""./outputs/channel-logs/channel-{channel_id}.json""
    if os.path.exists(file_path):
      with open(file_path, ""r"") as file:
        print(f""Returning cached data for channel {channel_id}. If you do not wish to use stored data then delete the file for this channel to allow refetching."")
        return json.load(file)

    if(os.getenv('GOOGLE_APIS_KEY') == None):
        print(""GOOGLE_APIS_KEY env variable not set!"")
        exit(1)

    done = False
    currentPage = None
    pageTokens = []
    items = []
    data = {
       'id': channel_id,
    }

    print(""Fetching first page of results..."")
    while(done == False):
        url = f""https://www.googleapis.com/youtube/v3/search?key={os.getenv('GOOGLE_APIS_KEY')}&channelId={channel_id}&part=snippet,id&order=date&type=video&maxResults={windowSize}""
        if(currentPage != None):
           print(f""Fetching page ${currentPage}"")
           url += f""&pageToken={currentPage}""

        req = requests.get(url)
        if(req.ok == False):
           print(""Could not fetch channel_id items!"")
           exit(1)

        response = req.json()
        currentPage = response.get('nextPageToken')
        if currentPage in pageTokens:
          print('All pages iterated and logged!')
          done = True
          break

        for item in response.get('items'):
          if 'id' in item and 'videoId' in item.get('id'):
            if is_yt_short(item.get('id').get('videoId')):
              print(f""Filtering out YT Short {item.get('id').get('videoId')}"")
              continue

            if data.get('channelTitle') is None:
              data['channelTitle'] = slugify(item.get('snippet').get('channelTitle'))

            newItem = {
              'id': item.get('id').get('videoId'),
              'url': f""https://youtube.com/watch?v={item.get('id').get('videoId')}"",
              'title': item.get('snippet').get('title'),
              'description':  item.get('snippet').get('description'),
              'thumbnail': item.get('snippet').get('thumbnails').get('high').get('url'),
              'published': item.get('snippet').get('publishTime'),
            }
            items.append(newItem)

        pageTokens.append(currentPage)

    data['items'] = items
    with open(file_path, 'w+', encoding='utf-8') as json_file:
      json.dump(data, json_file, ensure_ascii=True, indent=2)
      print(f""{len(items)} videos found for channel {data.get('channelTitle')}. Saved to channel-logs/channel-{channel_id}.json"")

    return data",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR() VAR VAR(VAR): VAR = 'VAR: VAR = VAR.VAR(VAR) VAR VAR.VAR == 200 VAR VAR(VAR): VAR('@' VAR VAR): VAR = VAR'VAR?: VAR = VAR.VAR(VAR, VAR) VAR VAR VAR VAR: VAR VAR VAR = VAR.VAR(1) VAR('VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR.') VAR = VAR.VAR(VAR""VAR: VAR(VAR.VAR == VAR): VAR(""VAR => VAR VAR VAR VAR VAR VAR - VAR VAR VAR.VAR/VAR VAR"") VAR VAR VAR = VAR.VAR() VAR VAR.VAR('VAR')[0].VAR('VAR') VAR: VAR = VAR""VAR\.VAR/VAR/([\VAR-]+)"" VAR = VAR.VAR(VAR, VAR) VAR VAR.VAR(1) VAR VAR VAR VAR VAR VAR(VAR): VAR VAR.VAR(VAR""\[.*?\]"", """", VAR) VAR VAR(VAR, VAR, VAR): VAR = { 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR, } VAR ""VAR VAR VAR:\VAR""+VAR.VAR(VAR, VAR=4)+""\VAR\VAR\VAR VAR:\VAR"" + VAR VAR VAR(VAR): VAR = VAR.VAR(VAR) VAR VAR[-1].VAR('VAR') VAR VAR(VAR, VAR = 50): VAR VAR == VAR VAR VAR(VAR) == 0: VAR(""VAR VAR VAR VAR!"") VAR(1) VAR VAR.VAR.VAR(""./VAR/VAR-VAR"") == VAR: VAR.VAR(""./VAR/VAR-VAR"") VAR = VAR""./VAR/VAR-VAR/VAR-{VAR}.VAR"" VAR VAR.VAR.VAR(VAR): VAR VAR(VAR, ""VAR"") VAR VAR: VAR(VAR""VAR VAR VAR VAR VAR {VAR}. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR."") VAR VAR.VAR(VAR) VAR(VAR.VAR('VAR') == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR VAR = VAR VAR = [] VAR = [] VAR = { 'VAR': VAR, } VAR(""VAR VAR VAR VAR VAR..."") VAR(VAR == VAR): VAR = VAR""VAR: VAR(VAR != VAR): VAR(VAR""VAR VAR ${VAR}"") VAR += VAR""&VAR={VAR}"" VAR = VAR.VAR(VAR) VAR(VAR.VAR == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR.VAR() VAR = VAR.VAR('VAR') VAR VAR VAR VAR: VAR('VAR VAR VAR VAR VAR!') VAR = VAR VAR VAR VAR VAR VAR.VAR('VAR'): VAR 'VAR' VAR VAR VAR 'VAR' VAR VAR.VAR('VAR'): VAR VAR(VAR.VAR('VAR').VAR('VAR')): VAR(VAR""VAR VAR VAR VAR {VAR.VAR('VAR').VAR('VAR')}"") VAR VAR VAR.VAR('VAR') VAR VAR: VAR['VAR'] = VAR(VAR.VAR('VAR').VAR('VAR')) VAR = { 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR').VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), } VAR.VAR(VAR) VAR.VAR(VAR) VAR['VAR'] = VAR VAR VAR(VAR, 'VAR+', VAR='VAR-8') VAR VAR: VAR.VAR(VAR, VAR, VAR=VAR, VAR=2) VAR(VAR""{VAR(VAR)} VAR VAR VAR VAR {VAR.VAR('VAR')}. VAR VAR VAR-VAR/VAR-{VAR}.VAR"") VAR VAR ",8,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,docker/docker-entrypoint.sh,"#!/bin/bash
node /app/server/index.js &
{ FLASK_ENV=production FLASK_APP=wsgi.py cd collector && gunicorn --timeout 300 --workers 4 --bind 0.0.0.0:8888 wsgi:api; } &
wait -n
exit $?",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED, VAR /VAR/VAR/VAR.VAR & { VAR=VAR VAR=VAR.VAR VAR VAR && VAR --VAR 300 --VAR 4 --VAR 0.0.0.0:8888 VAR:VAR; } & VAR -VAR VAR $? ,0,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/components/Modals/Password/index.jsx,"import React, { useState, useEffect } from ""react"";
import System from ""../../../models/system"";
import SingleUserAuth from ""./SingleUserAuth"";
import MultiUserAuth from ""./MultiUserAuth"";
import { AUTH_TOKEN, AUTH_USER } from ""../../../utils/constants"";

export default function PasswordModal({ mode = ""single"" }) {
  return (
    <div className=""fixed top-0 left-0 right-0 z-50 w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] h-full bg-black bg-opacity-50 flex items-center justify-center"">
      <div className=""flex fixed top-0 left-0 right-0 w-full h-full"" />
      <div className=""relative w-full max-w-2xl max-h-full"">
        {mode === ""single"" ? <SingleUserAuth /> : <MultiUserAuth />}
      </div>
    </div>
  );
}

export function usePasswordModal() {
  const [auth, setAuth] = useState({
    required: false,
    mode: ""single"",
  });

  useEffect(() => {
    async function checkAuthReq() {
      if (!window) return;
      const settings = await System.keys();

      if (settings?.MultiUserMode) {
        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""multi"",
            });
            window.localStorage.removeItem(AUTH_USER);
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""multi"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""multi"",
          });
          return;
        }
      } else {
        // Running token check in single user Auth mode.
        // If Single user Auth is disabled - skip check
        const requiresAuth = settings?.RequiresAuth || false;
        if (!requiresAuth) {
          setAuth({
            requiresAuth: false,
            mode: ""single"",
          });
          return;
        }

        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""single"",
            });
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""single"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""single"",
          });
          return;
        }
      }
    }
    checkAuthReq();
  }, []);

  return auth;
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR { VAR, VAR } VAR ""../../../VAR/VAR""; VAR VAR VAR VAR({ VAR = ""VAR"" }) { VAR ( <VAR VAR=""VAR VAR-0 VAR-0 VAR-0 VAR-50 VAR-VAR VAR-4 VAR-VAR-VAR VAR-VAR-VAR VAR:VAR-0 VAR-[VAR(100%-1rem)] VAR-VAR VAR-VAR VAR-VAR-50 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR VAR VAR-0 VAR-0 VAR-0 VAR-VAR VAR-VAR"" /> <VAR VAR=""VAR VAR-VAR VAR-VAR-2xl VAR-VAR-VAR""> {VAR === ""VAR"" ? <VAR /> : <VAR />} </VAR> </VAR> ); } VAR VAR VAR() { VAR [VAR, VAR] = VAR({ VAR: VAR, VAR: ""VAR"", }); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(); VAR (VAR?.VAR) { VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR {   VAR VAR = VAR?.VAR || VAR; VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } } VAR(); }, []); VAR VAR; } ",0,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9,3
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,server/models/workspace.js,"const slugify = require(""slugify"");
const { Document } = require(""./documents"");
const { checkForMigrations } = require(""../utils/database"");
const { WorkspaceUser } = require(""./workspaceUsers"");

const Workspace = {
  tablename: ""workspaces"",
  writable: [
    // Used for generic updates so we can validate keys in request body
    ""name"",
    ""slug"",
    ""vectorTag"",
    ""openAiTemp"",
    ""openAiHistory"",
    ""lastUpdatedAt"",
    ""openAiPrompt"",
  ],
  colsInit: `
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  slug TEXT NOT NULL UNIQUE,
  vectorTag TEXT DEFAULT NULL,
  createdAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiTemp REAL DEFAULT NULL,
  openAiHistory INTEGER DEFAULT 20,
  lastUpdatedAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiPrompt TEXT DEFAULT NULL
  `,
  migrateTable: async function () {
    console.log(`\x1b[34m[MIGRATING]\x1b[0m Checking for Workspace migrations`);
    const db = await this.db(false);
    await checkForMigrations(this, db);
  },
  migrations: function () {
    return [
      {
        colName: ""openAiTemp"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiTemp REAL DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""openAiPrompt"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiPrompt TEXT DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""id"",
        execCmd: `CREATE TRIGGER IF NOT EXISTS Trg_LastUpdated AFTER UPDATE ON ${this.tablename}
                                 FOR EACH ROW
                                 BEGIN
                                  UPDATE ${this.tablename} SET lastUpdatedAt = CURRENT_TIMESTAMP WHERE id = old.id;
                                 END`,
        doif: true,
      },
      {
        colName: ""openAiHistory"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiHistory INTEGER DEFAULT 20`,
        doif: false,
      },
    ];
  },
  db: async function (tracing = true) {
    const sqlite3 = require(""sqlite3"").verbose();
    const { open } = require(""sqlite"");

    const db = await open({
      filename: `${
        !!process.env.STORAGE_DIR ? `${process.env.STORAGE_DIR}/` : ""storage/""
      }anythingllm.db`,
      driver: sqlite3.Database,
    });

    await db.exec(
      `PRAGMA foreign_keys = ON;CREATE TABLE IF NOT EXISTS ${this.tablename} (${this.colsInit})`
    );

    if (tracing) db.on(""trace"", (sql) => console.log(sql));
    return db;
  },
  new: async function (name = null, creatorId = null) {
    if (!name) return { result: null, message: ""name cannot be null"" };
    var slug = slugify(name, { lower: true });

    const existingBySlug = await this.get(`slug = '${slug}'`);
    if (existingBySlug !== null) {
      const slugSeed = Math.floor(10000000 + Math.random() * 90000000);
      slug = slugify(`${name}-${slugSeed}`, { lower: true });
    }

    const db = await this.db();
    const { id, success, message } = await db
      .run(`INSERT INTO ${this.tablename} (name, slug) VALUES (?, ?)`, [
        name,
        slug,
      ])
      .then((res) => {
        return { id: res.lastID, success: true, message: null };
      })
      .catch((error) => {
        return { id: null, success: false, message: error.message };
      });

    if (!success) {
      db.close();
      return { workspace: null, message };
    }

    const workspace = await db.get(
      `SELECT * FROM ${this.tablename} WHERE id = ${id}`
    );
    db.close();

    // If created with a user then we need to create the relationship as well.
    // If creating with an admin User it wont change anything because admins can
    // view all workspaces anyway.
    if (!!creatorId) await WorkspaceUser.create(creatorId, workspace.id);
    return { workspace, message: null };
  },
  update: async function (id = null, data = {}) {
    if (!id) throw new Error(""No workspace id provided for update"");

    const validKeys = Object.keys(data).filter((key) =>
      this.writable.includes(key)
    );
    const values = Object.values(data);
    if (validKeys.length === 0 || validKeys.length !== values.length)
      return { workspace: { id }, message: ""No valid fields to update!"" };

    const template = `UPDATE ${this.tablename} SET ${validKeys.map((key) => {
      return `${key}=?`;
    })} WHERE id = ?`;
    const db = await this.db();
    const { success, message } = await db
      .run(template, [...values, id])
      .then(() => {
        return { success: true, message: null };
      })
      .catch((error) => {
        return { success: false, message: error.message };
      });

    db.close();
    if (!success) {
      return { workspace: null, message };
    }

    const updatedWorkspace = await this.get(`id = ${id}`);
    return { workspace: updatedWorkspace, message: null };
  },
  getWithUser: async function (user = null, clause = """") {
    if (user.role === ""admin"") return this.get(clause);

    const db = await this.db();
    const result = await db
      .get(
        `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user?.id} AND ${clause}`
      )
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const workspace = { ...result, id: result.workspace_id };
    const documents = await Document.forWorkspace(workspace.id);
    return { ...workspace, documents };
  },
  get: async function (clause = """") {
    const db = await this.db();
    const result = await db
      .get(`SELECT * FROM ${this.tablename} WHERE ${clause}`)
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const documents = await Document.forWorkspace(result.id);
    return { ...result, documents };
  },
  delete: async function (clause = """") {
    const db = await this.db();
    await db.get(`DELETE FROM ${this.tablename} WHERE ${clause}`);
    db.close();

    return true;
  },
  where: async function (clause = """", limit = null, orderBy = null) {
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} ${clause ? `WHERE ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();

    return results;
  },
  whereWithUser: async function (
    user,
    clause = null,
    limit = null,
    orderBy = null
  ) {
    if (user.role === ""admin"") return await this.where(clause, limit);
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user.id} ${clause ? `AND ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();
    const workspaces = results.map((ws) => {
      return { ...ws, id: ws.workspace_id };
    });

    return workspaces;
  },
  whereWithUsers: async function (clause = """", limit = null, orderBy = null) {
    const workspaces = await this.where(clause, limit, orderBy);
    for (const workspace of workspaces) {
      const userIds = (
        await WorkspaceUser.where(`workspace_id = ${workspace.id}`)
      ).map((rel) => rel.user_id);
      workspace.userIds = userIds;
    }
    return workspaces;
  },
  updateUsers: async function (workspaceId, userIds = []) {
    await WorkspaceUser.delete(`workspace_id = ${workspaceId}`);
    await WorkspaceUser.createManyUsers(userIds, workspaceId);
    return { success: true, error: null };
  },
};

module.exports = { Workspace };",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = VAR(""VAR""); VAR { VAR } = VAR(""./VAR""); VAR { VAR } = VAR(""../VAR/VAR""); VAR { VAR } = VAR(""./VAR""); VAR VAR = { VAR: ""VAR"", VAR: [  ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ], VAR: ` VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR 20, VAR VAR VAR VAR, VAR VAR VAR VAR `, VAR: VAR VAR () { VAR.VAR(`\VAR[34m[VAR]\VAR[0m VAR VAR VAR VAR`); VAR VAR = VAR VAR.VAR(VAR); VAR VAR(VAR, VAR); }, VAR: VAR () { VAR [ { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR = VAR VAR VAR = VAR.VAR; VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR 20`, VAR: VAR, }, ]; }, VAR: VAR VAR (VAR = VAR) { VAR VAR = VAR(""VAR"").VAR(); VAR { VAR } = VAR(""VAR""); VAR VAR = VAR VAR({ VAR: `${ !!VAR.VAR.VAR ? `${VAR.VAR.VAR}/` : ""VAR/"" }VAR.VAR`, VAR: VAR.VAR, }); VAR VAR.VAR( `VAR VAR = VAR;VAR VAR VAR VAR VAR ${VAR.VAR} (${VAR.VAR})` ); VAR (VAR) VAR.VAR(""VAR"", (VAR) => VAR.VAR(VAR)); VAR VAR; }, VAR: VAR VAR (VAR = VAR, VAR = VAR) { VAR (!VAR) VAR { VAR: VAR, VAR: ""VAR VAR VAR VAR"" }; VAR VAR = VAR(VAR, { VAR: VAR }); VAR VAR = VAR VAR.VAR(`VAR = '${VAR}'`); VAR (VAR !== VAR) { VAR VAR = VAR.VAR(10000000 + VAR.VAR() * 90000000); VAR = VAR(`${VAR}-${VAR}`, { VAR: VAR }); } VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR, VAR } = VAR VAR .VAR(`VAR VAR ${VAR.VAR} (VAR, VAR) VAR (?, ?)`, [ VAR, VAR, ]) .VAR((VAR) => { VAR { VAR: VAR.VAR, VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR, VAR: VAR.VAR }; }); VAR (!VAR) { VAR.VAR(); VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR = ${VAR}` ); VAR.VAR();    VAR (!!VAR) VAR VAR.VAR(VAR, VAR.VAR); VAR { VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = {}) { VAR (!VAR) VAR VAR VAR(""VAR VAR VAR VAR VAR VAR""); VAR VAR = VAR.VAR(VAR).VAR((VAR) => VAR.VAR.VAR(VAR) ); VAR VAR = VAR.VAR(VAR); VAR (VAR.VAR === 0 || VAR.VAR !== VAR.VAR) VAR { VAR: { VAR }, VAR: ""VAR VAR VAR VAR VAR!"" }; VAR VAR = `VAR ${VAR.VAR} VAR ${VAR.VAR((VAR) => { VAR `${VAR}=?`; })} VAR VAR = ?`; VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR } = VAR VAR .VAR(VAR, [...VAR, VAR]) .VAR(() => { VAR { VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR.VAR }; }); VAR.VAR(); VAR (!VAR) { VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR(`VAR = ${VAR}`); VAR { VAR: VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = """") { VAR (VAR.VAR === ""VAR"") VAR VAR.VAR(VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR?.VAR} VAR ${VAR}` ) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = { ...VAR, VAR: VAR.VAR }; VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR(`VAR * VAR ${VAR.VAR} VAR ${VAR}`) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR.VAR(`VAR VAR ${VAR.VAR} VAR ${VAR}`); VAR.VAR(); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR; }, VAR: VAR VAR ( VAR, VAR = VAR, VAR = VAR, VAR = VAR ) { VAR (VAR.VAR === ""VAR"") VAR VAR VAR.VAR(VAR, VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR = VAR.VAR((VAR) => { VAR { ...VAR, VAR: VAR.VAR }; }); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(VAR, VAR, VAR); VAR (VAR VAR VAR VAR) { VAR VAR = ( VAR VAR.VAR(`VAR = ${VAR.VAR}`) ).VAR((VAR) => VAR.VAR); VAR.VAR = VAR; } VAR VAR; }, VAR: VAR VAR (VAR, VAR = []) { VAR VAR.VAR(`VAR = ${VAR}`); VAR VAR.VAR(VAR, VAR); VAR { VAR: VAR, VAR: VAR }; }, }; VAR.VAR = { VAR }; ",7,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,collector/README.md,"# How to collect data for vectorizing
This process should be run first. This will enable you to collect a ton of data across various sources. Currently the following services are supported:
- [x] YouTube Channels
- [x] Medium
- [x] Substack
- [x] Arbitrary Link
- [x] Gitbook
- [x] Local Files (.txt, .pdf, etc) [See full list](./hotdir/__HOTDIR__.md)
_these resources are under development or require PR_
- Twitter
![Choices](../images/choices.png)

### Requirements
- [ ] Python 3.8+
- [ ] Google Cloud Account (for YouTube channels)
- [ ] `brew install pandoc` [pandoc](https://pandoc.org/installing.html) (for .ODT document processing)

### Setup
This example will be using python3.9, but will work with 3.8+. Tested on MacOs. Untested on Windows
- install virtualenv for python3.8+ first before any other steps. `python3.9 -m pip install virtualenv`
- `cd collector` from root directory
- `python3.9 -m virtualenv v-env`
- `source v-env/bin/activate`
- `pip install -r requirements.txt`
- `cp .env.example .env`
- `python main.py` for interactive collection or `python watch.py` to process local documents.
- Select the option you want and follow follow the prompts - Done!
- run `deactivate` to get back to regular shell

### Outputs
All JSON file data is cached in the `output/` folder. This is to prevent redundant API calls to services which may have rate limits to quota caps. Clearing out the `output/` folder will execute the script as if there was no cache.

As files are processed you will see data being written to both the `collector/outputs` folder as well as the `server/documents` folder. Later in this process, once you boot up the server you will then bulk vectorize this content from a simple UI!

If collection fails at any point in the process it will pick up where it last bailed out so you are not reusing credits.

### Running the document processing API locally
From the `collector` directory with the `v-env` active run `flask run --host '0.0.0.0' --port 8888`.
Now uploads from the frontend will be processed as if you ran the `watch.py` script manually.

**Docker**: If you run this application via docker the API is already started for you and no additional action is needed.

### How to get a Google Cloud API Key (YouTube data collection only)
**required to fetch YouTube transcripts and data**
- Have a google account
- [Visit the GCP Cloud Console](https://console.cloud.google.com/welcome)
- Click on dropdown in top right > Create new project. Name it whatever you like
  - ![GCP Project Bar](../images/gcp-project-bar.png)
- [Enable YouTube Data APIV3](https://console.cloud.google.com/apis/library/youtube.googleapis.com)
- Once enabled generate a Credential key for this API
- Paste your key after `GOOGLE_APIS_KEY=` in your `collector/.env` file.

### Using ther Twitter API
***required to get data form twitter with tweepy**
- Go to https://developer.twitter.com/en/portal/dashboard with your twitter account
- Create a new Project App
  - Get your 4 keys and place them in your `collector.env` file
  * TW_CONSUMER_KEY
  * TW_CONSUMER_SECRET
  * TW_ACCESS_TOKEN
  * TW_ACCESS_TOKEN_SECRET
  populate the .env with the values",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR: - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR VAR (.VAR, .VAR, VAR) [VAR VAR VAR](./VAR/VAR.VAR) VAR VAR VAR VAR VAR VAR VAR VAR - VAR ![VAR](../VAR/VAR.VAR)  - [ ] VAR 3.8+ - [ ] VAR VAR VAR (VAR VAR VAR) - [ ] `VAR VAR VAR` [VAR](VAR:  VAR VAR VAR VAR VAR VAR.9, VAR VAR VAR VAR 3.8+. VAR VAR VAR. VAR VAR VAR - VAR VAR VAR VAR.8+ VAR VAR VAR VAR VAR. `VAR.9 -VAR VAR VAR VAR` - `VAR VAR` VAR VAR VAR - `VAR.9 -VAR VAR VAR-VAR` - `VAR VAR-VAR/VAR/VAR` - `VAR VAR -VAR VAR.VAR` - `VAR .VAR.VAR .VAR` - `VAR VAR.VAR` VAR VAR VAR VAR `VAR VAR.VAR` VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR! - VAR `VAR` VAR VAR VAR VAR VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR `VAR/` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR/VAR` VAR VAR VAR VAR VAR `VAR/VAR` VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR `VAR` VAR VAR VAR `VAR-VAR` VAR VAR `VAR VAR --VAR '0.0.0.0' --VAR 8888`. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. **VAR**: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  **VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR VAR - [VAR VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR > VAR VAR VAR. VAR VAR VAR VAR VAR - ![VAR VAR VAR](../VAR/VAR-VAR-VAR.VAR) - [VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR `VAR=` VAR VAR `VAR/.VAR` VAR.  ***VAR VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR: - VAR VAR VAR VAR VAR - VAR VAR 4 VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR * VAR * VAR * VAR * VAR VAR VAR .VAR VAR VAR VAR ",0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,collector/README.md,"# How to collect data for vectorizing
This process should be run first. This will enable you to collect a ton of data across various sources. Currently the following services are supported:
- [x] YouTube Channels
- [x] Medium
- [x] Substack
- [x] Arbitrary Link
- [x] Gitbook
- [x] Local Files (.txt, .pdf, etc) [See full list](./hotdir/__HOTDIR__.md)
_these resources are under development or require PR_
- Twitter
![Choices](../images/choices.png)

### Requirements
- [ ] Python 3.8+
- [ ] Google Cloud Account (for YouTube channels)
- [ ] `brew install pandoc` [pandoc](https://pandoc.org/installing.html) (for .ODT document processing)

### Setup
This example will be using python3.9, but will work with 3.8+. Tested on MacOs. Untested on Windows
- install virtualenv for python3.8+ first before any other steps. `python3.9 -m pip install virtualenv`
- `cd collector` from root directory
- `python3.9 -m virtualenv v-env`
- `source v-env/bin/activate`
- `pip install -r requirements.txt`
- `cp .env.example .env`
- `python main.py` for interactive collection or `python watch.py` to process local documents.
- Select the option you want and follow follow the prompts - Done!
- run `deactivate` to get back to regular shell

### Outputs
All JSON file data is cached in the `output/` folder. This is to prevent redundant API calls to services which may have rate limits to quota caps. Clearing out the `output/` folder will execute the script as if there was no cache.

As files are processed you will see data being written to both the `collector/outputs` folder as well as the `server/documents` folder. Later in this process, once you boot up the server you will then bulk vectorize this content from a simple UI!

If collection fails at any point in the process it will pick up where it last bailed out so you are not reusing credits.

### Running the document processing API locally
From the `collector` directory with the `v-env` active run `flask run --host '0.0.0.0' --port 8888`.
Now uploads from the frontend will be processed as if you ran the `watch.py` script manually.

**Docker**: If you run this application via docker the API is already started for you and no additional action is needed.

### How to get a Google Cloud API Key (YouTube data collection only)
**required to fetch YouTube transcripts and data**
- Have a google account
- [Visit the GCP Cloud Console](https://console.cloud.google.com/welcome)
- Click on dropdown in top right > Create new project. Name it whatever you like
  - ![GCP Project Bar](../images/gcp-project-bar.png)
- [Enable YouTube Data APIV3](https://console.cloud.google.com/apis/library/youtube.googleapis.com)
- Once enabled generate a Credential key for this API
- Paste your key after `GOOGLE_APIS_KEY=` in your `collector/.env` file.

### Using ther Twitter API
***required to get data form twitter with tweepy**
- Go to https://developer.twitter.com/en/portal/dashboard with your twitter account
- Create a new Project App
  - Get your 4 keys and place them in your `collector.env` file
  * TW_CONSUMER_KEY
  * TW_CONSUMER_SECRET
  * TW_ACCESS_TOKEN
  * TW_ACCESS_TOKEN_SECRET
  populate the .env with the values",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR: - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR - [VAR] VAR VAR - [VAR] VAR - [VAR] VAR VAR (.VAR, .VAR, VAR) [VAR VAR VAR](./VAR/VAR.VAR) VAR VAR VAR VAR VAR VAR VAR VAR - VAR ![VAR](../VAR/VAR.VAR)  - [ ] VAR 3.8+ - [ ] VAR VAR VAR (VAR VAR VAR) - [ ] `VAR VAR VAR` [VAR](VAR:  VAR VAR VAR VAR VAR VAR.9, VAR VAR VAR VAR 3.8+. VAR VAR VAR. VAR VAR VAR - VAR VAR VAR VAR.8+ VAR VAR VAR VAR VAR. `VAR.9 -VAR VAR VAR VAR` - `VAR VAR` VAR VAR VAR - `VAR.9 -VAR VAR VAR-VAR` - `VAR VAR-VAR/VAR/VAR` - `VAR VAR -VAR VAR.VAR` - `VAR .VAR.VAR .VAR` - `VAR VAR.VAR` VAR VAR VAR VAR `VAR VAR.VAR` VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR! - VAR `VAR` VAR VAR VAR VAR VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR `VAR/` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR/VAR` VAR VAR VAR VAR VAR `VAR/VAR` VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR `VAR` VAR VAR VAR `VAR-VAR` VAR VAR `VAR VAR --VAR '0.0.0.0' --VAR 8888`. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. **VAR**: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  **VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR VAR - [VAR VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR > VAR VAR VAR. VAR VAR VAR VAR VAR - ![VAR VAR VAR](../VAR/VAR-VAR-VAR.VAR) - [VAR VAR VAR VAR](VAR: - VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR `VAR=` VAR VAR `VAR/.VAR` VAR.  ***VAR VAR VAR VAR VAR VAR VAR VAR** - VAR VAR VAR: - VAR VAR VAR VAR VAR - VAR VAR 4 VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR * VAR * VAR * VAR * VAR VAR VAR .VAR VAR VAR VAR ",0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,collector/scripts/yt_utils.py,"import json, requests, os, re
from slugify import slugify
from dotenv import load_dotenv
load_dotenv()

def is_yt_short(videoId):
    url = 'https://www.youtube.com/shorts/' + videoId
    ret = requests.head(url)
    return ret.status_code == 200

def get_channel_id(channel_link):
  if('@' in channel_link):
    pattern = r'https?://www\.youtube\.com/(@\w+)/?'
    match = re.match(pattern, channel_link)
    if match is False: return None
    handle = match.group(1)
    print('Need to map username to channelId - this can take a while sometimes.')
    response = requests.get(f""https://yt.lemnoslife.com/channels?handle={handle}"", timeout=20)

    if(response.ok == False):
      print(""Handle => ChannelId mapping endpoint is too slow - use regular youtube.com/channel URL"")
      return None

    json_data = response.json()
    return json_data.get('items')[0].get('id')
  else:
    pattern = r""youtube\.com/channel/([\w-]+)""
    match = re.search(pattern, channel_link)
    return match.group(1) if match else None


def clean_text(text):
  return re.sub(r""\[.*?\]"", """", text)

def append_meta(video, duration, text):
  meta = {
    'youtubeURL': f""https://youtube.com/watch?v={video.get('id')}"",
    'thumbnail': video.get('thumbnail'),
    'description': video.get('description'),
    'createdAt': video.get('published'),
    'videoDurationInSeconds': duration,
  }
  return ""Video JSON Metadata:\n""+json.dumps(meta, indent=4)+""\n\n\nAudio Transcript:\n"" + text

def get_duration(json_str):
  data = json.loads(json_str)
  return data[-1].get('start')

def fetch_channel_video_information(channel_id, windowSize = 50):
    if channel_id == None or len(channel_id) == 0:
      print(""No channel id provided!"")
      exit(1)

    if os.path.isdir(""./outputs/channel-logs"") == False:
      os.makedirs(""./outputs/channel-logs"")

    file_path = f""./outputs/channel-logs/channel-{channel_id}.json""
    if os.path.exists(file_path):
      with open(file_path, ""r"") as file:
        print(f""Returning cached data for channel {channel_id}. If you do not wish to use stored data then delete the file for this channel to allow refetching."")
        return json.load(file)

    if(os.getenv('GOOGLE_APIS_KEY') == None):
        print(""GOOGLE_APIS_KEY env variable not set!"")
        exit(1)

    done = False
    currentPage = None
    pageTokens = []
    items = []
    data = {
       'id': channel_id,
    }

    print(""Fetching first page of results..."")
    while(done == False):
        url = f""https://www.googleapis.com/youtube/v3/search?key={os.getenv('GOOGLE_APIS_KEY')}&channelId={channel_id}&part=snippet,id&order=date&type=video&maxResults={windowSize}""
        if(currentPage != None):
           print(f""Fetching page ${currentPage}"")
           url += f""&pageToken={currentPage}""

        req = requests.get(url)
        if(req.ok == False):
           print(""Could not fetch channel_id items!"")
           exit(1)

        response = req.json()
        currentPage = response.get('nextPageToken')
        if currentPage in pageTokens:
          print('All pages iterated and logged!')
          done = True
          break

        for item in response.get('items'):
          if 'id' in item and 'videoId' in item.get('id'):
            if is_yt_short(item.get('id').get('videoId')):
              print(f""Filtering out YT Short {item.get('id').get('videoId')}"")
              continue

            if data.get('channelTitle') is None:
              data['channelTitle'] = slugify(item.get('snippet').get('channelTitle'))

            newItem = {
              'id': item.get('id').get('videoId'),
              'url': f""https://youtube.com/watch?v={item.get('id').get('videoId')}"",
              'title': item.get('snippet').get('title'),
              'description':  item.get('snippet').get('description'),
              'thumbnail': item.get('snippet').get('thumbnails').get('high').get('url'),
              'published': item.get('snippet').get('publishTime'),
            }
            items.append(newItem)

        pageTokens.append(currentPage)

    data['items'] = items
    with open(file_path, 'w+', encoding='utf-8') as json_file:
      json.dump(data, json_file, ensure_ascii=True, indent=2)
      print(f""{len(items)} videos found for channel {data.get('channelTitle')}. Saved to channel-logs/channel-{channel_id}.json"")

    return data",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR() VAR VAR(VAR): VAR = 'VAR: VAR = VAR.VAR(VAR) VAR VAR.VAR == 200 VAR VAR(VAR): VAR('@' VAR VAR): VAR = VAR'VAR?: VAR = VAR.VAR(VAR, VAR) VAR VAR VAR VAR: VAR VAR VAR = VAR.VAR(1) VAR('VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR.') VAR = VAR.VAR(VAR""VAR: VAR(VAR.VAR == VAR): VAR(""VAR => VAR VAR VAR VAR VAR VAR - VAR VAR VAR.VAR/VAR VAR"") VAR VAR VAR = VAR.VAR() VAR VAR.VAR('VAR')[0].VAR('VAR') VAR: VAR = VAR""VAR\.VAR/VAR/([\VAR-]+)"" VAR = VAR.VAR(VAR, VAR) VAR VAR.VAR(1) VAR VAR VAR VAR VAR VAR(VAR): VAR VAR.VAR(VAR""\[.*?\]"", """", VAR) VAR VAR(VAR, VAR, VAR): VAR = { 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR, } VAR ""VAR VAR VAR:\VAR""+VAR.VAR(VAR, VAR=4)+""\VAR\VAR\VAR VAR:\VAR"" + VAR VAR VAR(VAR): VAR = VAR.VAR(VAR) VAR VAR[-1].VAR('VAR') VAR VAR(VAR, VAR = 50): VAR VAR == VAR VAR VAR(VAR) == 0: VAR(""VAR VAR VAR VAR!"") VAR(1) VAR VAR.VAR.VAR(""./VAR/VAR-VAR"") == VAR: VAR.VAR(""./VAR/VAR-VAR"") VAR = VAR""./VAR/VAR-VAR/VAR-{VAR}.VAR"" VAR VAR.VAR.VAR(VAR): VAR VAR(VAR, ""VAR"") VAR VAR: VAR(VAR""VAR VAR VAR VAR VAR {VAR}. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR."") VAR VAR.VAR(VAR) VAR(VAR.VAR('VAR') == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR VAR = VAR VAR = [] VAR = [] VAR = { 'VAR': VAR, } VAR(""VAR VAR VAR VAR VAR..."") VAR(VAR == VAR): VAR = VAR""VAR: VAR(VAR != VAR): VAR(VAR""VAR VAR ${VAR}"") VAR += VAR""&VAR={VAR}"" VAR = VAR.VAR(VAR) VAR(VAR.VAR == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR.VAR() VAR = VAR.VAR('VAR') VAR VAR VAR VAR: VAR('VAR VAR VAR VAR VAR!') VAR = VAR VAR VAR VAR VAR VAR.VAR('VAR'): VAR 'VAR' VAR VAR VAR 'VAR' VAR VAR.VAR('VAR'): VAR VAR(VAR.VAR('VAR').VAR('VAR')): VAR(VAR""VAR VAR VAR VAR {VAR.VAR('VAR').VAR('VAR')}"") VAR VAR VAR.VAR('VAR') VAR VAR: VAR['VAR'] = VAR(VAR.VAR('VAR').VAR('VAR')) VAR = { 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR').VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), } VAR.VAR(VAR) VAR.VAR(VAR) VAR['VAR'] = VAR VAR VAR(VAR, 'VAR+', VAR='VAR-8') VAR VAR: VAR.VAR(VAR, VAR, VAR=VAR, VAR=2) VAR(VAR""{VAR(VAR)} VAR VAR VAR VAR {VAR.VAR('VAR')}. VAR VAR VAR-VAR/VAR-{VAR}.VAR"") VAR VAR ",8,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,collector/scripts/yt_utils.py,"import json, requests, os, re
from slugify import slugify
from dotenv import load_dotenv
load_dotenv()

def is_yt_short(videoId):
    url = 'https://www.youtube.com/shorts/' + videoId
    ret = requests.head(url)
    return ret.status_code == 200

def get_channel_id(channel_link):
  if('@' in channel_link):
    pattern = r'https?://www\.youtube\.com/(@\w+)/?'
    match = re.match(pattern, channel_link)
    if match is False: return None
    handle = match.group(1)
    print('Need to map username to channelId - this can take a while sometimes.')
    response = requests.get(f""https://yt.lemnoslife.com/channels?handle={handle}"", timeout=20)

    if(response.ok == False):
      print(""Handle => ChannelId mapping endpoint is too slow - use regular youtube.com/channel URL"")
      return None

    json_data = response.json()
    return json_data.get('items')[0].get('id')
  else:
    pattern = r""youtube\.com/channel/([\w-]+)""
    match = re.search(pattern, channel_link)
    return match.group(1) if match else None


def clean_text(text):
  return re.sub(r""\[.*?\]"", """", text)

def append_meta(video, duration, text):
  meta = {
    'youtubeURL': f""https://youtube.com/watch?v={video.get('id')}"",
    'thumbnail': video.get('thumbnail'),
    'description': video.get('description'),
    'createdAt': video.get('published'),
    'videoDurationInSeconds': duration,
  }
  return ""Video JSON Metadata:\n""+json.dumps(meta, indent=4)+""\n\n\nAudio Transcript:\n"" + text

def get_duration(json_str):
  data = json.loads(json_str)
  return data[-1].get('start')

def fetch_channel_video_information(channel_id, windowSize = 50):
    if channel_id == None or len(channel_id) == 0:
      print(""No channel id provided!"")
      exit(1)

    if os.path.isdir(""./outputs/channel-logs"") == False:
      os.makedirs(""./outputs/channel-logs"")

    file_path = f""./outputs/channel-logs/channel-{channel_id}.json""
    if os.path.exists(file_path):
      with open(file_path, ""r"") as file:
        print(f""Returning cached data for channel {channel_id}. If you do not wish to use stored data then delete the file for this channel to allow refetching."")
        return json.load(file)

    if(os.getenv('GOOGLE_APIS_KEY') == None):
        print(""GOOGLE_APIS_KEY env variable not set!"")
        exit(1)

    done = False
    currentPage = None
    pageTokens = []
    items = []
    data = {
       'id': channel_id,
    }

    print(""Fetching first page of results..."")
    while(done == False):
        url = f""https://www.googleapis.com/youtube/v3/search?key={os.getenv('GOOGLE_APIS_KEY')}&channelId={channel_id}&part=snippet,id&order=date&type=video&maxResults={windowSize}""
        if(currentPage != None):
           print(f""Fetching page ${currentPage}"")
           url += f""&pageToken={currentPage}""

        req = requests.get(url)
        if(req.ok == False):
           print(""Could not fetch channel_id items!"")
           exit(1)

        response = req.json()
        currentPage = response.get('nextPageToken')
        if currentPage in pageTokens:
          print('All pages iterated and logged!')
          done = True
          break

        for item in response.get('items'):
          if 'id' in item and 'videoId' in item.get('id'):
            if is_yt_short(item.get('id').get('videoId')):
              print(f""Filtering out YT Short {item.get('id').get('videoId')}"")
              continue

            if data.get('channelTitle') is None:
              data['channelTitle'] = slugify(item.get('snippet').get('channelTitle'))

            newItem = {
              'id': item.get('id').get('videoId'),
              'url': f""https://youtube.com/watch?v={item.get('id').get('videoId')}"",
              'title': item.get('snippet').get('title'),
              'description':  item.get('snippet').get('description'),
              'thumbnail': item.get('snippet').get('thumbnails').get('high').get('url'),
              'published': item.get('snippet').get('publishTime'),
            }
            items.append(newItem)

        pageTokens.append(currentPage)

    data['items'] = items
    with open(file_path, 'w+', encoding='utf-8') as json_file:
      json.dump(data, json_file, ensure_ascii=True, indent=2)
      print(f""{len(items)} videos found for channel {data.get('channelTitle')}. Saved to channel-logs/channel-{channel_id}.json"")

    return data",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR() VAR VAR(VAR): VAR = 'VAR: VAR = VAR.VAR(VAR) VAR VAR.VAR == 200 VAR VAR(VAR): VAR('@' VAR VAR): VAR = VAR'VAR?: VAR = VAR.VAR(VAR, VAR) VAR VAR VAR VAR: VAR VAR VAR = VAR.VAR(1) VAR('VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR.') VAR = VAR.VAR(VAR""VAR: VAR(VAR.VAR == VAR): VAR(""VAR => VAR VAR VAR VAR VAR VAR - VAR VAR VAR.VAR/VAR VAR"") VAR VAR VAR = VAR.VAR() VAR VAR.VAR('VAR')[0].VAR('VAR') VAR: VAR = VAR""VAR\.VAR/VAR/([\VAR-]+)"" VAR = VAR.VAR(VAR, VAR) VAR VAR.VAR(1) VAR VAR VAR VAR VAR VAR(VAR): VAR VAR.VAR(VAR""\[.*?\]"", """", VAR) VAR VAR(VAR, VAR, VAR): VAR = { 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR.VAR('VAR'), 'VAR': VAR, } VAR ""VAR VAR VAR:\VAR""+VAR.VAR(VAR, VAR=4)+""\VAR\VAR\VAR VAR:\VAR"" + VAR VAR VAR(VAR): VAR = VAR.VAR(VAR) VAR VAR[-1].VAR('VAR') VAR VAR(VAR, VAR = 50): VAR VAR == VAR VAR VAR(VAR) == 0: VAR(""VAR VAR VAR VAR!"") VAR(1) VAR VAR.VAR.VAR(""./VAR/VAR-VAR"") == VAR: VAR.VAR(""./VAR/VAR-VAR"") VAR = VAR""./VAR/VAR-VAR/VAR-{VAR}.VAR"" VAR VAR.VAR.VAR(VAR): VAR VAR(VAR, ""VAR"") VAR VAR: VAR(VAR""VAR VAR VAR VAR VAR {VAR}. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR."") VAR VAR.VAR(VAR) VAR(VAR.VAR('VAR') == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR VAR = VAR VAR = [] VAR = [] VAR = { 'VAR': VAR, } VAR(""VAR VAR VAR VAR VAR..."") VAR(VAR == VAR): VAR = VAR""VAR: VAR(VAR != VAR): VAR(VAR""VAR VAR ${VAR}"") VAR += VAR""&VAR={VAR}"" VAR = VAR.VAR(VAR) VAR(VAR.VAR == VAR): VAR(""VAR VAR VAR VAR VAR!"") VAR(1) VAR = VAR.VAR() VAR = VAR.VAR('VAR') VAR VAR VAR VAR: VAR('VAR VAR VAR VAR VAR!') VAR = VAR VAR VAR VAR VAR VAR.VAR('VAR'): VAR 'VAR' VAR VAR VAR 'VAR' VAR VAR.VAR('VAR'): VAR VAR(VAR.VAR('VAR').VAR('VAR')): VAR(VAR""VAR VAR VAR VAR {VAR.VAR('VAR').VAR('VAR')}"") VAR VAR VAR.VAR('VAR') VAR VAR: VAR['VAR'] = VAR(VAR.VAR('VAR').VAR('VAR')) VAR = { 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR""VAR: 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR').VAR('VAR').VAR('VAR'), 'VAR': VAR.VAR('VAR').VAR('VAR'), } VAR.VAR(VAR) VAR.VAR(VAR) VAR['VAR'] = VAR VAR VAR(VAR, 'VAR+', VAR='VAR-8') VAR VAR: VAR.VAR(VAR, VAR, VAR=VAR, VAR=2) VAR(VAR""{VAR(VAR)} VAR VAR VAR VAR {VAR.VAR('VAR')}. VAR VAR VAR-VAR/VAR-{VAR}.VAR"") VAR VAR ",8,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,docker/docker-entrypoint.sh,"#!/bin/bash
node /app/server/index.js &
{ FLASK_ENV=production FLASK_APP=wsgi.py cd collector && gunicorn --timeout 300 --workers 4 --bind 0.0.0.0:8888 wsgi:api; } &
wait -n
exit $?",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED, VAR /VAR/VAR/VAR.VAR & { VAR=VAR VAR=VAR.VAR VAR VAR && VAR --VAR 300 --VAR 4 --VAR 0.0.0.0:8888 VAR:VAR; } & VAR -VAR VAR $? ,0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,docker/docker-entrypoint.sh,"#!/bin/bash
node /app/server/index.js &
{ FLASK_ENV=production FLASK_APP=wsgi.py cd collector && gunicorn --timeout 300 --workers 4 --bind 0.0.0.0:8888 wsgi:api; } &
wait -n
exit $?",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED, VAR /VAR/VAR/VAR.VAR & { VAR=VAR VAR=VAR.VAR VAR VAR && VAR --VAR 300 --VAR 4 --VAR 0.0.0.0:8888 VAR:VAR; } & VAR -VAR VAR $? ,0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/components/Modals/Password/index.jsx,"import React, { useState, useEffect } from ""react"";
import System from ""../../../models/system"";
import SingleUserAuth from ""./SingleUserAuth"";
import MultiUserAuth from ""./MultiUserAuth"";
import { AUTH_TOKEN, AUTH_USER } from ""../../../utils/constants"";

export default function PasswordModal({ mode = ""single"" }) {
  return (
    <div className=""fixed top-0 left-0 right-0 z-50 w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] h-full bg-black bg-opacity-50 flex items-center justify-center"">
      <div className=""flex fixed top-0 left-0 right-0 w-full h-full"" />
      <div className=""relative w-full max-w-2xl max-h-full"">
        {mode === ""single"" ? <SingleUserAuth /> : <MultiUserAuth />}
      </div>
    </div>
  );
}

export function usePasswordModal() {
  const [auth, setAuth] = useState({
    required: false,
    mode: ""single"",
  });

  useEffect(() => {
    async function checkAuthReq() {
      if (!window) return;
      const settings = await System.keys();

      if (settings?.MultiUserMode) {
        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""multi"",
            });
            window.localStorage.removeItem(AUTH_USER);
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""multi"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""multi"",
          });
          return;
        }
      } else {
        // Running token check in single user Auth mode.
        // If Single user Auth is disabled - skip check
        const requiresAuth = settings?.RequiresAuth || false;
        if (!requiresAuth) {
          setAuth({
            requiresAuth: false,
            mode: ""single"",
          });
          return;
        }

        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""single"",
            });
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""single"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""single"",
          });
          return;
        }
      }
    }
    checkAuthReq();
  }, []);

  return auth;
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR { VAR, VAR } VAR ""../../../VAR/VAR""; VAR VAR VAR VAR({ VAR = ""VAR"" }) { VAR ( <VAR VAR=""VAR VAR-0 VAR-0 VAR-0 VAR-50 VAR-VAR VAR-4 VAR-VAR-VAR VAR-VAR-VAR VAR:VAR-0 VAR-[VAR(100%-1rem)] VAR-VAR VAR-VAR VAR-VAR-50 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR VAR VAR-0 VAR-0 VAR-0 VAR-VAR VAR-VAR"" /> <VAR VAR=""VAR VAR-VAR VAR-VAR-2xl VAR-VAR-VAR""> {VAR === ""VAR"" ? <VAR /> : <VAR />} </VAR> </VAR> ); } VAR VAR VAR() { VAR [VAR, VAR] = VAR({ VAR: VAR, VAR: ""VAR"", }); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(); VAR (VAR?.VAR) { VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR {   VAR VAR = VAR?.VAR || VAR; VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } } VAR(); }, []); VAR VAR; } ",0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/components/Modals/Password/index.jsx,"import React, { useState, useEffect } from ""react"";
import System from ""../../../models/system"";
import SingleUserAuth from ""./SingleUserAuth"";
import MultiUserAuth from ""./MultiUserAuth"";
import { AUTH_TOKEN, AUTH_USER } from ""../../../utils/constants"";

export default function PasswordModal({ mode = ""single"" }) {
  return (
    <div className=""fixed top-0 left-0 right-0 z-50 w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] h-full bg-black bg-opacity-50 flex items-center justify-center"">
      <div className=""flex fixed top-0 left-0 right-0 w-full h-full"" />
      <div className=""relative w-full max-w-2xl max-h-full"">
        {mode === ""single"" ? <SingleUserAuth /> : <MultiUserAuth />}
      </div>
    </div>
  );
}

export function usePasswordModal() {
  const [auth, setAuth] = useState({
    required: false,
    mode: ""single"",
  });

  useEffect(() => {
    async function checkAuthReq() {
      if (!window) return;
      const settings = await System.keys();

      if (settings?.MultiUserMode) {
        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""multi"",
            });
            window.localStorage.removeItem(AUTH_USER);
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""multi"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""multi"",
          });
          return;
        }
      } else {
        // Running token check in single user Auth mode.
        // If Single user Auth is disabled - skip check
        const requiresAuth = settings?.RequiresAuth || false;
        if (!requiresAuth) {
          setAuth({
            requiresAuth: false,
            mode: ""single"",
          });
          return;
        }

        const currentToken = window.localStorage.getItem(AUTH_TOKEN);
        if (!!currentToken) {
          const valid = await System.checkAuth(currentToken);
          if (!valid) {
            setAuth({
              requiresAuth: true,
              mode: ""single"",
            });
            window.localStorage.removeItem(AUTH_TOKEN);
            return;
          } else {
            setAuth({
              requiresAuth: false,
              mode: ""single"",
            });
            return;
          }
        } else {
          setAuth({
            requiresAuth: true,
            mode: ""single"",
          });
          return;
        }
      }
    }
    checkAuthReq();
  }, []);

  return auth;
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR { VAR, VAR } VAR ""../../../VAR/VAR""; VAR VAR VAR VAR({ VAR = ""VAR"" }) { VAR ( <VAR VAR=""VAR VAR-0 VAR-0 VAR-0 VAR-50 VAR-VAR VAR-4 VAR-VAR-VAR VAR-VAR-VAR VAR:VAR-0 VAR-[VAR(100%-1rem)] VAR-VAR VAR-VAR VAR-VAR-50 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR VAR VAR-0 VAR-0 VAR-0 VAR-VAR VAR-VAR"" /> <VAR VAR=""VAR VAR-VAR VAR-VAR-2xl VAR-VAR-VAR""> {VAR === ""VAR"" ? <VAR /> : <VAR />} </VAR> </VAR> ); } VAR VAR VAR() { VAR [VAR, VAR] = VAR({ VAR: VAR, VAR: ""VAR"", }); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(); VAR (VAR?.VAR) { VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR {   VAR VAR = VAR?.VAR || VAR; VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } VAR VAR = VAR.VAR.VAR(VAR); VAR (!!VAR) { VAR VAR = VAR VAR.VAR(VAR); VAR (!VAR) { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR.VAR.VAR(VAR); VAR; } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } VAR { VAR({ VAR: VAR, VAR: ""VAR"", }); VAR; } } } VAR(); }, []); VAR VAR; } ",0,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/ApiKeys/ApiKeyRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import Admin from ""../../../../models/admin"";
import showToast from ""../../../../utils/toast"";

export default function ApiKeyRow({ apiKey }) {
  const rowRef = useRef(null);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this api key?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.remove();
    }
    await Admin.deleteApiKey(apiKey.id);
    showToast(""API Key permanently deleted"", ""info"");
  };
  const copyApiKey = () => {
    if (!apiKey) return false;
    window.navigator.clipboard.writeText(apiKey.secret);
    showToast(""API Key copied to clipboard"", ""success"");
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {apiKey.secret}
        </td>
        <td className=""px-6 py-4"">
          {apiKey.createdBy?.username || ""unknown user""}
        </td>
        <td className=""px-6 py-4"">{apiKey.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={copyApiKey}
            disabled={copied}
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            {copied ? ""Copied"" : ""Copy API Key""}
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Deactivate API Key
          </button>
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR(); } VAR VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR"", ""VAR""); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR(VAR.VAR); VAR(""VAR VAR VAR VAR VAR"", ""VAR""); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR VAR </VAR> </VAR> </VAR> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Invitations/InviteRow/index.jsx,"import { useEffect, useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";

export default function InviteRow({ invite }) {
  const rowRef = useRef(null);
  const [status, setStatus] = useState(invite.status);
  const [copied, setCopied] = useState(false);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to deactivate this invite?\nAfter you do this it will not longer be useable.\n\nThis action is irreversible.`
      )
    )
      return false;
    if (rowRef?.current) {
      rowRef.current.children[0].innerText = ""Disabled"";
    }
    setStatus(""disabled"");
    await Admin.disableInvite(invite.id);
  };
  const copyInviteLink = () => {
    if (!invite) return false;
    window.navigator.clipboard.writeText(
      `${window.location.origin}/accept-invite/${invite.code}`
    );
    setCopied(true);
  };

  useEffect(() => {
    function resetStatus() {
      if (!copied) return false;
      setTimeout(() => {
        setCopied(false);
      }, 3000);
    }
    resetStatus();
  }, [copied]);

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <td
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white font-mono""
        >
          {titleCase(status)}
        </td>
        <td className=""px-6 py-4"">
          {invite.claimedBy
            ? invite.claimedBy?.username || ""deleted user""
            : ""--""}
        </td>
        <td className=""px-6 py-4"">
          {invite.createdBy?.username || ""deleted user""}
        </td>
        <td className=""px-6 py-4"">{invite.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          {status === ""pending"" && (
            <>
              <button
                onClick={copyInviteLink}
                disabled={copied}
                className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
              >
                {copied ? ""Copied"" : ""Copy Invite Link""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Deactivate
              </button>
            </>
          )}
        </td>
      </tr>
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR VAR({ VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR VAR VAR?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR (VAR?.VAR) { VAR.VAR.VAR[0].VAR = ""VAR""; } VAR(""VAR""); VAR VAR.VAR(VAR.VAR); }; VAR VAR = () => { VAR (!VAR) VAR VAR; VAR.VAR.VAR.VAR( `${VAR.VAR.VAR}/VAR-VAR/${VAR.VAR}` ); VAR(VAR); }; VAR(() => { VAR VAR() { VAR (!VAR) VAR VAR; VAR(() => { VAR(VAR); }, 3000); } VAR(); }, [VAR]); VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR VAR-VAR"" > {VAR(VAR)} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR ? VAR.VAR?.VAR || ""VAR VAR"" : ""--""} </VAR> <VAR VAR=""VAR-6 VAR-4""> {VAR.VAR?.VAR || ""VAR VAR""} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> {VAR === ""VAR"" && ( <> <VAR VAR={VAR} VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR VAR VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Users/UserRow/index.jsx,"import { useRef, useState } from ""react"";
import { titleCase } from ""text-case"";
import Admin from ""../../../../models/admin"";
import EditUserModal, { EditUserModalId } from ""./EditUserModal"";

export default function UserRow({ currUser, user }) {
  const rowRef = useRef(null);
  const [suspended, setSuspended] = useState(user.suspended === 1);
  const handleSuspend = async () => {
    if (
      !window.confirm(
        `Are you sure you want to suspend ${user.username}?\nAfter you do this they will be logged out and unable to log back into this instance of AnythingLLM until unsuspended by an admin.`
      )
    )
      return false;
    setSuspended(!suspended);
    await Admin.updateUser(user.id, { suspended: suspended ? 0 : 1 });
  };
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${user.username}?\nAfter you do this they will be logged out and unable to use this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteUser(user.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {user.username}
        </th>
        <td className=""px-6 py-4"">{titleCase(user.role)}</td>
        <td className=""px-6 py-4"">{user.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document?.getElementById(EditUserModalId(user))?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit
          </button>
          {currUser.id !== user.id && (
            <>
              <button
                onClick={handleSuspend}
                className=""font-medium text-orange-600 dark:text-orange-300 px-2 py-1 rounded-lg hover:bg-orange-50 hover:dark:bg-orange-800 hover:dark:bg-opacity-20""
              >
                {suspended ? ""Unsuspend"" : ""Suspend""}
              </button>
              <button
                onClick={handleDelete}
                className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
              >
                Delete
              </button>
            </>
          )}
        </td>
      </tr>
      <EditUserModal user={user} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR [VAR, VAR] = VAR(VAR.VAR === 1); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.` ) ) VAR VAR; VAR(!VAR); VAR VAR.VAR(VAR.VAR, { VAR: VAR ? 0 : 1 }); }; VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR(VAR.VAR)}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR?.VAR(VAR(VAR))?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> {VAR.VAR !== VAR.VAR && ( <> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > {VAR ? ""VAR"" : ""VAR""} </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </> )} </VAR> </VAR> <VAR VAR={VAR} /> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Admin/Workspaces/WorkspaceRow/index.jsx,"import { useRef } from ""react"";
import Admin from ""../../../../models/admin"";
import paths from ""../../../../utils/paths"";
import EditWorkspaceUsersModal, {
  EditWorkspaceUsersModalId,
} from ""./EditWorkspaceUsersModal"";

export default function WorkspaceRow({ workspace, users }) {
  const rowRef = useRef(null);
  const handleDelete = async () => {
    if (
      !window.confirm(
        `Are you sure you want to delete ${workspace.name}?\nAfter you do this it will be unavailable in this instance of AnythingLLM.\n\nThis action is irreversible.`
      )
    )
      return false;
    rowRef?.current?.remove();
    await Admin.deleteWorkspace(workspace.id);
  };

  return (
    <>
      <tr ref={rowRef} className=""bg-transparent"">
        <th
          scope=""row""
          className=""px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white""
        >
          {workspace.name}
        </th>
        <td className=""px-6 py-4"">
          <a
            href={paths.workspace.chat(workspace.slug)}
            target=""_blank""
            className=""text-blue-500""
          >
            {workspace.slug}
          </a>
        </td>
        <td className=""px-6 py-4"">{workspace.userIds?.length}</td>
        <td className=""px-6 py-4"">{workspace.createdAt}</td>
        <td className=""px-6 py-4 flex items-center gap-x-6"">
          <button
            onClick={() =>
              document
                ?.getElementById(EditWorkspaceUsersModalId(workspace))
                ?.showModal()
            }
            className=""font-medium text-blue-600 dark:text-blue-300 px-2 py-1 rounded-lg hover:bg-blue-50 hover:dark:bg-blue-800 hover:dark:bg-opacity-20""
          >
            Edit Users
          </button>
          <button
            onClick={handleDelete}
            className=""font-medium text-red-600 dark:text-red-300 px-2 py-1 rounded-lg hover:bg-red-50 hover:dark:bg-red-800 hover:dark:bg-opacity-20""
          >
            Delete
          </button>
        </td>
      </tr>
      <EditWorkspaceUsersModal workspace={workspace} users={users} />
    </>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR } VAR ""VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR VAR ""../../../../VAR/VAR""; VAR VAR, { VAR, } VAR ""./VAR""; VAR VAR VAR VAR({ VAR, VAR }) { VAR VAR = VAR(VAR); VAR VAR = VAR () => { VAR ( !VAR.VAR( `VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR}?\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR.` ) ) VAR VAR; VAR?.VAR?.VAR(); VAR VAR.VAR(VAR.VAR); }; VAR ( <> <VAR VAR={VAR} VAR=""VAR-VAR""> <VAR VAR=""VAR"" VAR=""VAR-6 VAR-4 VAR-VAR VAR-VAR-900 VAR-VAR VAR:VAR-VAR"" > {VAR.VAR} </VAR> <VAR VAR=""VAR-6 VAR-4""> <VAR VAR={VAR.VAR.VAR(VAR.VAR)} VAR=""VAR"" VAR=""VAR-VAR-500"" > {VAR.VAR} </VAR> </VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR?.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4"">{VAR.VAR}</VAR> <VAR VAR=""VAR-6 VAR-4 VAR VAR-VAR VAR-VAR-6""> <VAR VAR={() => VAR ?.VAR(VAR(VAR)) ?.VAR() } VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR VAR </VAR> <VAR VAR={VAR} VAR=""VAR-VAR VAR-VAR-600 VAR:VAR-VAR-300 VAR-2 VAR-1 VAR-VAR VAR:VAR-VAR-50 VAR:VAR:VAR-VAR-800 VAR:VAR:VAR-VAR-20"" > VAR </VAR> </VAR> </VAR> <VAR VAR={VAR} VAR={VAR} /> </> ); } ",9,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,server/models/workspace.js,"const slugify = require(""slugify"");
const { Document } = require(""./documents"");
const { checkForMigrations } = require(""../utils/database"");
const { WorkspaceUser } = require(""./workspaceUsers"");
const { escape } = require(""sqlstring-sqlite"");

const Workspace = {
  tablename: ""workspaces"",
  writable: [
    // Used for generic updates so we can validate keys in request body
    ""name"",
    ""slug"",
    ""vectorTag"",
    ""openAiTemp"",
    ""openAiHistory"",
    ""lastUpdatedAt"",
    ""openAiPrompt"",
  ],
  colsInit: `
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  slug TEXT NOT NULL UNIQUE,
  vectorTag TEXT DEFAULT NULL,
  createdAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiTemp REAL DEFAULT NULL,
  openAiHistory INTEGER DEFAULT 20,
  lastUpdatedAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiPrompt TEXT DEFAULT NULL
  `,
  migrateTable: async function () {
    console.log(`\x1b[34m[MIGRATING]\x1b[0m Checking for Workspace migrations`);
    const db = await this.db(false);
    await checkForMigrations(this, db);
  },
  migrations: function () {
    return [
      {
        colName: ""openAiTemp"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiTemp REAL DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""openAiPrompt"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiPrompt TEXT DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""id"",
        execCmd: `CREATE TRIGGER IF NOT EXISTS Trg_LastUpdated AFTER UPDATE ON ${this.tablename}
                                 FOR EACH ROW
                                 BEGIN
                                  UPDATE ${this.tablename} SET lastUpdatedAt = CURRENT_TIMESTAMP WHERE id = old.id;
                                 END`,
        doif: true,
      },
      {
        colName: ""openAiHistory"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiHistory INTEGER DEFAULT 20`,
        doif: false,
      },
    ];
  },
  db: async function (tracing = true) {
    const sqlite3 = require(""sqlite3"").verbose();
    const { open } = require(""sqlite"");

    const db = await open({
      filename: `${
        !!process.env.STORAGE_DIR ? `${process.env.STORAGE_DIR}/` : ""storage/""
      }anythingllm.db`,
      driver: sqlite3.Database,
    });

    await db.exec(
      `PRAGMA foreign_keys = ON;CREATE TABLE IF NOT EXISTS ${this.tablename} (${this.colsInit})`
    );

    if (tracing) db.on(""trace"", (sql) => console.log(sql));
    return db;
  },
  new: async function (name = null, creatorId = null) {
    if (!name) return { result: null, message: ""name cannot be null"" };
    var slug = slugify(name, { lower: true });

    const existingBySlug = await this.get(`slug = ${escape(slug)}`);
    if (existingBySlug !== null) {
      const slugSeed = Math.floor(10000000 + Math.random() * 90000000);
      slug = slugify(`${name}-${slugSeed}`, { lower: true });
    }

    const db = await this.db();
    const { id, success, message } = await db
      .run(`INSERT INTO ${this.tablename} (name, slug) VALUES (?, ?)`, [
        name,
        slug,
      ])
      .then((res) => {
        return { id: res.lastID, success: true, message: null };
      })
      .catch((error) => {
        return { id: null, success: false, message: error.message };
      });

    if (!success) {
      db.close();
      return { workspace: null, message };
    }

    const workspace = await db.get(
      `SELECT * FROM ${this.tablename} WHERE id = ${id}`
    );
    db.close();

    // If created with a user then we need to create the relationship as well.
    // If creating with an admin User it wont change anything because admins can
    // view all workspaces anyway.
    if (!!creatorId) await WorkspaceUser.create(creatorId, workspace.id);
    return { workspace, message: null };
  },
  update: async function (id = null, data = {}) {
    if (!id) throw new Error(""No workspace id provided for update"");

    const validKeys = Object.keys(data).filter((key) =>
      this.writable.includes(key)
    );
    const values = Object.values(data);
    if (validKeys.length === 0 || validKeys.length !== values.length)
      return { workspace: { id }, message: ""No valid fields to update!"" };

    const template = `UPDATE ${this.tablename} SET ${validKeys.map((key) => {
      return `${key}=?`;
    })} WHERE id = ?`;
    const db = await this.db();
    const { success, message } = await db
      .run(template, [...values, id])
      .then(() => {
        return { success: true, message: null };
      })
      .catch((error) => {
        return { success: false, message: error.message };
      });

    db.close();
    if (!success) {
      return { workspace: null, message };
    }

    const updatedWorkspace = await this.get(`id = ${id}`);
    return { workspace: updatedWorkspace, message: null };
  },
  getWithUser: async function (user = null, clause = """") {
    if (user.role === ""admin"") return this.get(clause);

    const db = await this.db();
    const result = await db
      .get(
        `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user?.id} AND ${clause}`
      )
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const workspace = { ...result, id: result.workspace_id };
    const documents = await Document.forWorkspace(workspace.id);
    return { ...workspace, documents };
  },
  get: async function (clause = """") {
    const db = await this.db();
    const result = await db
      .get(`SELECT * FROM ${this.tablename} WHERE ${clause}`)
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const documents = await Document.forWorkspace(result.id);
    return { ...result, documents };
  },
  delete: async function (clause = """") {
    const db = await this.db();
    await db.get(`DELETE FROM ${this.tablename} WHERE ${clause}`);
    db.close();

    return true;
  },
  where: async function (clause = """", limit = null, orderBy = null) {
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} ${clause ? `WHERE ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();

    return results;
  },
  whereWithUser: async function (
    user,
    clause = null,
    limit = null,
    orderBy = null
  ) {
    if (user.role === ""admin"") return await this.where(clause, limit);
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user.id} ${clause ? `AND ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();
    const workspaces = results.map((ws) => {
      return { ...ws, id: ws.workspace_id };
    });

    return workspaces;
  },
  whereWithUsers: async function (clause = """", limit = null, orderBy = null) {
    const workspaces = await this.where(clause, limit, orderBy);
    for (const workspace of workspaces) {
      const userIds = (
        await WorkspaceUser.where(`workspace_id = ${workspace.id}`)
      ).map((rel) => rel.user_id);
      workspace.userIds = userIds;
    }
    return workspaces;
  },
  updateUsers: async function (workspaceId, userIds = []) {
    await WorkspaceUser.delete(`workspace_id = ${workspaceId}`);
    await WorkspaceUser.createManyUsers(userIds, workspaceId);
    return { success: true, error: null };
  },
};

module.exports = { Workspace };",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = VAR(""VAR""); VAR { VAR } = VAR(""./VAR""); VAR { VAR } = VAR(""../VAR/VAR""); VAR { VAR } = VAR(""./VAR""); VAR { VAR } = VAR(""VAR-VAR""); VAR VAR = { VAR: ""VAR"", VAR: [  ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ], VAR: ` VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR 20, VAR VAR VAR VAR, VAR VAR VAR VAR `, VAR: VAR VAR () { VAR.VAR(`\VAR[34m[VAR]\VAR[0m VAR VAR VAR VAR`); VAR VAR = VAR VAR.VAR(VAR); VAR VAR(VAR, VAR); }, VAR: VAR () { VAR [ { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR = VAR VAR VAR = VAR.VAR; VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR 20`, VAR: VAR, }, ]; }, VAR: VAR VAR (VAR = VAR) { VAR VAR = VAR(""VAR"").VAR(); VAR { VAR } = VAR(""VAR""); VAR VAR = VAR VAR({ VAR: `${ !!VAR.VAR.VAR ? `${VAR.VAR.VAR}/` : ""VAR/"" }VAR.VAR`, VAR: VAR.VAR, }); VAR VAR.VAR( `VAR VAR = VAR;VAR VAR VAR VAR VAR ${VAR.VAR} (${VAR.VAR})` ); VAR (VAR) VAR.VAR(""VAR"", (VAR) => VAR.VAR(VAR)); VAR VAR; }, VAR: VAR VAR (VAR = VAR, VAR = VAR) { VAR (!VAR) VAR { VAR: VAR, VAR: ""VAR VAR VAR VAR"" }; VAR VAR = VAR(VAR, { VAR: VAR }); VAR VAR = VAR VAR.VAR(`VAR = ${VAR(VAR)}`); VAR (VAR !== VAR) { VAR VAR = VAR.VAR(10000000 + VAR.VAR() * 90000000); VAR = VAR(`${VAR}-${VAR}`, { VAR: VAR }); } VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR, VAR } = VAR VAR .VAR(`VAR VAR ${VAR.VAR} (VAR, VAR) VAR (?, ?)`, [ VAR, VAR, ]) .VAR((VAR) => { VAR { VAR: VAR.VAR, VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR, VAR: VAR.VAR }; }); VAR (!VAR) { VAR.VAR(); VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR = ${VAR}` ); VAR.VAR();    VAR (!!VAR) VAR VAR.VAR(VAR, VAR.VAR); VAR { VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = {}) { VAR (!VAR) VAR VAR VAR(""VAR VAR VAR VAR VAR VAR""); VAR VAR = VAR.VAR(VAR).VAR((VAR) => VAR.VAR.VAR(VAR) ); VAR VAR = VAR.VAR(VAR); VAR (VAR.VAR === 0 || VAR.VAR !== VAR.VAR) VAR { VAR: { VAR }, VAR: ""VAR VAR VAR VAR VAR!"" }; VAR VAR = `VAR ${VAR.VAR} VAR ${VAR.VAR((VAR) => { VAR `${VAR}=?`; })} VAR VAR = ?`; VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR } = VAR VAR .VAR(VAR, [...VAR, VAR]) .VAR(() => { VAR { VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR.VAR }; }); VAR.VAR(); VAR (!VAR) { VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR(`VAR = ${VAR}`); VAR { VAR: VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = """") { VAR (VAR.VAR === ""VAR"") VAR VAR.VAR(VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR?.VAR} VAR ${VAR}` ) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = { ...VAR, VAR: VAR.VAR }; VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR(`VAR * VAR ${VAR.VAR} VAR ${VAR}`) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR.VAR(`VAR VAR ${VAR.VAR} VAR ${VAR}`); VAR.VAR(); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR; }, VAR: VAR VAR ( VAR, VAR = VAR, VAR = VAR, VAR = VAR ) { VAR (VAR.VAR === ""VAR"") VAR VAR VAR.VAR(VAR, VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR = VAR.VAR((VAR) => { VAR { ...VAR, VAR: VAR.VAR }; }); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(VAR, VAR, VAR); VAR (VAR VAR VAR VAR) { VAR VAR = ( VAR VAR.VAR(`VAR = ${VAR.VAR}`) ).VAR((VAR) => VAR.VAR); VAR.VAR = VAR; } VAR VAR; }, VAR: VAR VAR (VAR, VAR = []) { VAR VAR.VAR(`VAR = ${VAR}`); VAR VAR.VAR(VAR, VAR); VAR { VAR: VAR, VAR: VAR }; }, }; VAR.VAR = { VAR }; ",7,3
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,server/models/workspace.js,"const slugify = require(""slugify"");
const { Document } = require(""./documents"");
const { checkForMigrations } = require(""../utils/database"");
const { WorkspaceUser } = require(""./workspaceUsers"");
const { escape } = require(""sqlstring-sqlite"");

const Workspace = {
  tablename: ""workspaces"",
  writable: [
    // Used for generic updates so we can validate keys in request body
    ""name"",
    ""slug"",
    ""vectorTag"",
    ""openAiTemp"",
    ""openAiHistory"",
    ""lastUpdatedAt"",
    ""openAiPrompt"",
  ],
  colsInit: `
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  slug TEXT NOT NULL UNIQUE,
  vectorTag TEXT DEFAULT NULL,
  createdAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiTemp REAL DEFAULT NULL,
  openAiHistory INTEGER DEFAULT 20,
  lastUpdatedAt TEXT DEFAULT CURRENT_TIMESTAMP,
  openAiPrompt TEXT DEFAULT NULL
  `,
  migrateTable: async function () {
    console.log(`\x1b[34m[MIGRATING]\x1b[0m Checking for Workspace migrations`);
    const db = await this.db(false);
    await checkForMigrations(this, db);
  },
  migrations: function () {
    return [
      {
        colName: ""openAiTemp"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiTemp REAL DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""openAiPrompt"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiPrompt TEXT DEFAULT NULL`,
        doif: false,
      },
      {
        colName: ""id"",
        execCmd: `CREATE TRIGGER IF NOT EXISTS Trg_LastUpdated AFTER UPDATE ON ${this.tablename}
                                 FOR EACH ROW
                                 BEGIN
                                  UPDATE ${this.tablename} SET lastUpdatedAt = CURRENT_TIMESTAMP WHERE id = old.id;
                                 END`,
        doif: true,
      },
      {
        colName: ""openAiHistory"",
        execCmd: `ALTER TABLE ${this.tablename} ADD COLUMN openAiHistory INTEGER DEFAULT 20`,
        doif: false,
      },
    ];
  },
  db: async function (tracing = true) {
    const sqlite3 = require(""sqlite3"").verbose();
    const { open } = require(""sqlite"");

    const db = await open({
      filename: `${
        !!process.env.STORAGE_DIR ? `${process.env.STORAGE_DIR}/` : ""storage/""
      }anythingllm.db`,
      driver: sqlite3.Database,
    });

    await db.exec(
      `PRAGMA foreign_keys = ON;CREATE TABLE IF NOT EXISTS ${this.tablename} (${this.colsInit})`
    );

    if (tracing) db.on(""trace"", (sql) => console.log(sql));
    return db;
  },
  new: async function (name = null, creatorId = null) {
    if (!name) return { result: null, message: ""name cannot be null"" };
    var slug = slugify(name, { lower: true });

    const existingBySlug = await this.get(`slug = ${escape(slug)}`);
    if (existingBySlug !== null) {
      const slugSeed = Math.floor(10000000 + Math.random() * 90000000);
      slug = slugify(`${name}-${slugSeed}`, { lower: true });
    }

    const db = await this.db();
    const { id, success, message } = await db
      .run(`INSERT INTO ${this.tablename} (name, slug) VALUES (?, ?)`, [
        name,
        slug,
      ])
      .then((res) => {
        return { id: res.lastID, success: true, message: null };
      })
      .catch((error) => {
        return { id: null, success: false, message: error.message };
      });

    if (!success) {
      db.close();
      return { workspace: null, message };
    }

    const workspace = await db.get(
      `SELECT * FROM ${this.tablename} WHERE id = ${id}`
    );
    db.close();

    // If created with a user then we need to create the relationship as well.
    // If creating with an admin User it wont change anything because admins can
    // view all workspaces anyway.
    if (!!creatorId) await WorkspaceUser.create(creatorId, workspace.id);
    return { workspace, message: null };
  },
  update: async function (id = null, data = {}) {
    if (!id) throw new Error(""No workspace id provided for update"");

    const validKeys = Object.keys(data).filter((key) =>
      this.writable.includes(key)
    );
    const values = Object.values(data);
    if (validKeys.length === 0 || validKeys.length !== values.length)
      return { workspace: { id }, message: ""No valid fields to update!"" };

    const template = `UPDATE ${this.tablename} SET ${validKeys.map((key) => {
      return `${key}=?`;
    })} WHERE id = ?`;
    const db = await this.db();
    const { success, message } = await db
      .run(template, [...values, id])
      .then(() => {
        return { success: true, message: null };
      })
      .catch((error) => {
        return { success: false, message: error.message };
      });

    db.close();
    if (!success) {
      return { workspace: null, message };
    }

    const updatedWorkspace = await this.get(`id = ${id}`);
    return { workspace: updatedWorkspace, message: null };
  },
  getWithUser: async function (user = null, clause = """") {
    if (user.role === ""admin"") return this.get(clause);

    const db = await this.db();
    const result = await db
      .get(
        `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user?.id} AND ${clause}`
      )
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const workspace = { ...result, id: result.workspace_id };
    const documents = await Document.forWorkspace(workspace.id);
    return { ...workspace, documents };
  },
  get: async function (clause = """") {
    const db = await this.db();
    const result = await db
      .get(`SELECT * FROM ${this.tablename} WHERE ${clause}`)
      .then((res) => res || null);
    if (!result) return null;
    db.close();

    const documents = await Document.forWorkspace(result.id);
    return { ...result, documents };
  },
  delete: async function (clause = """") {
    const db = await this.db();
    await db.get(`DELETE FROM ${this.tablename} WHERE ${clause}`);
    db.close();

    return true;
  },
  where: async function (clause = """", limit = null, orderBy = null) {
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} ${clause ? `WHERE ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();

    return results;
  },
  whereWithUser: async function (
    user,
    clause = null,
    limit = null,
    orderBy = null
  ) {
    if (user.role === ""admin"") return await this.where(clause, limit);
    const db = await this.db();
    const results = await db.all(
      `SELECT * FROM ${this.tablename} as workspace
      LEFT JOIN workspace_users as ws_users
      ON ws_users.workspace_id = workspace.id
      WHERE ws_users.user_id = ${user.id} ${clause ? `AND ${clause}` : """"} ${
        !!limit ? `LIMIT ${limit}` : """"
      } ${!!orderBy ? orderBy : """"}`
    );
    db.close();
    const workspaces = results.map((ws) => {
      return { ...ws, id: ws.workspace_id };
    });

    return workspaces;
  },
  whereWithUsers: async function (clause = """", limit = null, orderBy = null) {
    const workspaces = await this.where(clause, limit, orderBy);
    for (const workspace of workspaces) {
      const userIds = (
        await WorkspaceUser.where(`workspace_id = ${workspace.id}`)
      ).map((rel) => rel.user_id);
      workspace.userIds = userIds;
    }
    return workspaces;
  },
  updateUsers: async function (workspaceId, userIds = []) {
    await WorkspaceUser.delete(`workspace_id = ${workspaceId}`);
    await WorkspaceUser.createManyUsers(userIds, workspaceId);
    return { success: true, error: null };
  },
};

module.exports = { Workspace };",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = VAR(""VAR""); VAR { VAR } = VAR(""./VAR""); VAR { VAR } = VAR(""../VAR/VAR""); VAR { VAR } = VAR(""./VAR""); VAR { VAR } = VAR(""VAR-VAR""); VAR VAR = { VAR: ""VAR"", VAR: [  ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"", ], VAR: ` VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR VAR, VAR VAR VAR 20, VAR VAR VAR VAR, VAR VAR VAR VAR `, VAR: VAR VAR () { VAR.VAR(`\VAR[34m[VAR]\VAR[0m VAR VAR VAR VAR`); VAR VAR = VAR VAR.VAR(VAR); VAR VAR(VAR, VAR); }, VAR: VAR () { VAR [ { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR VAR VAR VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR ${VAR.VAR} VAR VAR = VAR VAR VAR = VAR.VAR; VAR`, VAR: VAR, }, { VAR: ""VAR"", VAR: `VAR VAR ${VAR.VAR} VAR VAR VAR VAR VAR 20`, VAR: VAR, }, ]; }, VAR: VAR VAR (VAR = VAR) { VAR VAR = VAR(""VAR"").VAR(); VAR { VAR } = VAR(""VAR""); VAR VAR = VAR VAR({ VAR: `${ !!VAR.VAR.VAR ? `${VAR.VAR.VAR}/` : ""VAR/"" }VAR.VAR`, VAR: VAR.VAR, }); VAR VAR.VAR( `VAR VAR = VAR;VAR VAR VAR VAR VAR ${VAR.VAR} (${VAR.VAR})` ); VAR (VAR) VAR.VAR(""VAR"", (VAR) => VAR.VAR(VAR)); VAR VAR; }, VAR: VAR VAR (VAR = VAR, VAR = VAR) { VAR (!VAR) VAR { VAR: VAR, VAR: ""VAR VAR VAR VAR"" }; VAR VAR = VAR(VAR, { VAR: VAR }); VAR VAR = VAR VAR.VAR(`VAR = ${VAR(VAR)}`); VAR (VAR !== VAR) { VAR VAR = VAR.VAR(10000000 + VAR.VAR() * 90000000); VAR = VAR(`${VAR}-${VAR}`, { VAR: VAR }); } VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR, VAR } = VAR VAR .VAR(`VAR VAR ${VAR.VAR} (VAR, VAR) VAR (?, ?)`, [ VAR, VAR, ]) .VAR((VAR) => { VAR { VAR: VAR.VAR, VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR, VAR: VAR.VAR }; }); VAR (!VAR) { VAR.VAR(); VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR = ${VAR}` ); VAR.VAR();    VAR (!!VAR) VAR VAR.VAR(VAR, VAR.VAR); VAR { VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = {}) { VAR (!VAR) VAR VAR VAR(""VAR VAR VAR VAR VAR VAR""); VAR VAR = VAR.VAR(VAR).VAR((VAR) => VAR.VAR.VAR(VAR) ); VAR VAR = VAR.VAR(VAR); VAR (VAR.VAR === 0 || VAR.VAR !== VAR.VAR) VAR { VAR: { VAR }, VAR: ""VAR VAR VAR VAR VAR!"" }; VAR VAR = `VAR ${VAR.VAR} VAR ${VAR.VAR((VAR) => { VAR `${VAR}=?`; })} VAR VAR = ?`; VAR VAR = VAR VAR.VAR(); VAR { VAR, VAR } = VAR VAR .VAR(VAR, [...VAR, VAR]) .VAR(() => { VAR { VAR: VAR, VAR: VAR }; }) .VAR((VAR) => { VAR { VAR: VAR, VAR: VAR.VAR }; }); VAR.VAR(); VAR (!VAR) { VAR { VAR: VAR, VAR }; } VAR VAR = VAR VAR.VAR(`VAR = ${VAR}`); VAR { VAR: VAR, VAR: VAR }; }, VAR: VAR VAR (VAR = VAR, VAR = """") { VAR (VAR.VAR === ""VAR"") VAR VAR.VAR(VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR?.VAR} VAR ${VAR}` ) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = { ...VAR, VAR: VAR.VAR }; VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR .VAR(`VAR * VAR ${VAR.VAR} VAR ${VAR}`) .VAR((VAR) => VAR || VAR); VAR (!VAR) VAR VAR; VAR.VAR(); VAR VAR = VAR VAR.VAR(VAR.VAR); VAR { ...VAR, VAR }; }, VAR: VAR VAR (VAR = """") { VAR VAR = VAR VAR.VAR(); VAR VAR.VAR(`VAR VAR ${VAR.VAR} VAR ${VAR}`); VAR.VAR(); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR; }, VAR: VAR VAR ( VAR, VAR = VAR, VAR = VAR, VAR = VAR ) { VAR (VAR.VAR === ""VAR"") VAR VAR VAR.VAR(VAR, VAR); VAR VAR = VAR VAR.VAR(); VAR VAR = VAR VAR.VAR( `VAR * VAR ${VAR.VAR} VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR = VAR.VAR VAR VAR.VAR = ${VAR.VAR} ${VAR ? `VAR ${VAR}` : """"} ${ !!VAR ? `VAR ${VAR}` : """" } ${!!VAR ? VAR : """"}` ); VAR.VAR(); VAR VAR = VAR.VAR((VAR) => { VAR { ...VAR, VAR: VAR.VAR }; }); VAR VAR; }, VAR: VAR VAR (VAR = """", VAR = VAR, VAR = VAR) { VAR VAR = VAR VAR.VAR(VAR, VAR, VAR); VAR (VAR VAR VAR VAR) { VAR VAR = ( VAR VAR.VAR(`VAR = ${VAR.VAR}`) ).VAR((VAR) => VAR.VAR); VAR.VAR = VAR; } VAR VAR; }, VAR: VAR VAR (VAR, VAR = []) { VAR VAR.VAR(`VAR = ${VAR}`); VAR VAR.VAR(VAR, VAR); VAR { VAR: VAR, VAR: VAR }; }, }; VAR.VAR = { VAR }; ",7,3
discourse_3c5fb871c0f54af47679ae71ad449666b01d8216,libookmark_query.rb,"
  def unread_notifications(limit: 20)
    reminder_notifications =
      Notification
        .for_user_menu(@user.id, limit: [limit, 100].min)
        .unread
        .where(notification_type: Notification.types[:bookmark_reminder])

    # We preload associations like we do above for the list to avoid
    # N1s in the can_see? guardian calls for each bookmark.
    bookmarks =
      Bookmark.where(
        id: reminder_notifications.map { |n| n.data_hash[:bookmark_id] }.compact,
        user: @user,
      )
    BookmarkQuery.preload(bookmarks, self)

    reminder_notifications.select do |n|
      bookmark = bookmarks.find { |bm| bm.id == n.data_hash[:bookmark_id] }
      next if bookmark.blank?
      bookmarkable = Bookmark.registered_bookmarkable_from_type(bookmark.bookmarkable_type)
      bookmarkable.can_see?(@guardian, bookmark)
    end
  end",,3c5fb871c0f54af47679ae71ad449666b01d8216,CVE-2023-45816,3c5fb871c0f54af47679ae71ad449666b01d8216,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR(VAR: 20) VAR = VAR .VAR(@VAR.VAR, VAR: [VAR, 100].VAR) .VAR .VAR(VAR: VAR.VAR[:VAR])   VAR = VAR.VAR( VAR: VAR.VAR { |VAR| VAR.VAR[:VAR] }.VAR, VAR: @VAR, ) VAR.VAR(VAR, VAR) VAR.VAR VAR |VAR| VAR = VAR.VAR { |VAR| VAR.VAR == VAR.VAR[:VAR] } VAR VAR VAR.VAR? VAR = VAR.VAR(VAR.VAR) VAR.VAR?(@VAR, VAR) VAR VAR ",7,3
discourse_52b003d915761f1581ae2d105f3cbe76df7bf1ff,config/site_settings.yml,"  max_sidebar_section_links:
    default: 50
    hidden: true",,52b003d915761f1581ae2d105f3cbe76df7bf1ff,CVE-2023-36818,52b003d915761f1581ae2d105f3cbe76df7bf1ff,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR: VAR: 50 VAR: VAR ,0,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/admin/api_controller.rb,"  INDEX_LIMIT = 50

    limit = fetch_limit_from_params(default: INDEX_LIMIT, max: INDEX_LIMIT)","    limit = (params[:limit] || 50).to_i.clamp(1, 50)",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR = VAR(VAR: VAR, VAR: VAR) VAR = (VAR[:VAR] || 50).VAR.VAR(1, 50)",0,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/admin/reports_controller.rb,"  REPORTS_LIMIT = 50

    limit = fetch_limit_from_params(params: report_params, default: nil, max: REPORTS_LIMIT)","    limit = nil
    if report_params.has_key?(:limit) && report_params[:limit].to_i > 0
      limit = report_params[:limit].to_i
    end",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR = VAR(VAR: VAR, VAR: VAR, VAR: VAR) VAR = VAR VAR VAR.VAR?(:VAR) && VAR[:VAR].VAR > 0 VAR = VAR[:VAR].VAR VAR",0,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/drafts_controller.rb,"  INDEX_LIMIT = 50

    stream =
      Draft.stream(
        user: current_user,
        offset: params[:offset],
        limit: fetch_limit_from_params(default: nil, max: INDEX_LIMIT),
      )","    params.permit(:limit)
    stream = Draft.stream(user: current_user, offset: params[:offset], limit: params[:limit])",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR = VAR.VAR( VAR: VAR, VAR: VAR[:VAR], VAR: VAR(VAR: VAR, VAR: VAR), ) VAR.VAR(:VAR) VAR = VAR.VAR(VAR: VAR, VAR: VAR[:VAR], VAR: VAR[:VAR])",0,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/groups_controller.rb,"  MEMBERS_LIMIT = 1_000

    limit = fetch_limit_from_params(default: 50, max: MEMBERS_LIMIT)","    limit = (params[:limit] || 50).to_i
    raise Discourse::InvalidParameters.new(:limit) if limit < 0 || limit > 1000",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 1_000 VAR = VAR(VAR: 50, VAR: VAR) VAR = (VAR[:VAR] || 50).VAR VAR VAR::VAR.VAR(:VAR) VAR VAR < 0 || VAR > 1000",0,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/notifications_controller.rb,"  INDEX_LIMIT = 50

      limit = fetch_limit_from_params(default: 15, max: INDEX_LIMIT)","      limit = (params[:limit] || 15).to_i
      limit = 50 if limit > 50",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR = VAR(VAR: 15, VAR: VAR) VAR = (VAR[:VAR] || 15).VAR VAR = 50 VAR VAR > 50",12,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,app/controllers/users_controller.rb,"  SEARCH_USERS_LIMIT = 50


    if limit = fetch_limit_from_params(default: nil, max: SEARCH_USERS_LIMIT)
      options[:limit] = limit

  BOOKMARKS_LIMIT = 20

        bookmark_list =
          UserBookmarkList.new(
            user: user,
            guardian: guardian,
            search_term: params[:q],
            page: params[:page],
            per_page: fetch_limit_from_params(default: nil, max: BOOKMARKS_LIMIT),
          )

          per_page: USER_MENU_LIST_LIMIT - reminder_notifications.size,
","    if params[:limit].present?
      options[:limit] = params[:limit].to_i
      raise Discourse::InvalidParameters.new(:limit) if options[:limit] <= 0
        bookmark_list = UserBookmarkList.new(user: user, guardian: guardian, params: params)
          params: {
            per_page: USER_MENU_LIST_LIMIT - reminder_notifications.size,
          },",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR VAR = VAR(VAR: VAR, VAR: VAR) VAR[:VAR] = VAR VAR = 20 VAR = VAR.VAR( VAR: VAR, VAR: VAR, VAR: VAR[:VAR], VAR: VAR[:VAR], VAR: VAR(VAR: VAR, VAR: VAR), ) VAR: VAR - VAR.VAR, VAR VAR[:VAR].VAR? VAR[:VAR] = VAR[:VAR].VAR VAR VAR::VAR.VAR(:VAR) VAR VAR[:VAR] <= 0 VAR = VAR.VAR(VAR: VAR, VAR: VAR, VAR: VAR) VAR: { VAR: VAR - VAR.VAR, },",7,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,libookmark_query.rb,"  def initialize(user:, guardian: nil, search_term: nil, page: nil, per_page: nil)
    @search_term = search_term
    @page = page ? page.to_i : 0
    @per_page = per_page ? per_page.to_i : 20
    ts_query = @search_term.present? ? Search.ts_query(term: @search_term) : nil
    search_term_wildcard = @search_term.present? ? ""%#{@search_term}%"" : nil
          if @search_term.present?
    results = results.offset(@page * @per_page) if @page.positive?
    results = results.limit(@per_page).to_a
","  def initialize(user:, guardian: nil, params: {})
    @params = params
    @page = @params[:page].to_i
    @limit = @params[:limit].present? ? @params[:limit].to_i : @params[:per_page]
    search_term = @params[:q]
    ts_query = search_term.present? ? Search.ts_query(term: search_term) : nil
    search_term_wildcard = search_term.present? ? ""%#{search_term}%"" : nil
          if search_term.present?
    results = results.offset(@page * @params[:per_page]) if @page.positive?
    results = results.limit(@limit).to_a",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR(VAR:, VAR: VAR, VAR: VAR, VAR: VAR, VAR: VAR) @VAR = VAR @VAR = VAR ? VAR.VAR : 0 @VAR = VAR ? VAR.VAR : 20 VAR = @VAR.VAR? ? VAR.VAR(VAR: @VAR) : VAR VAR = @VAR.VAR? ? ""% VAR @VAR.VAR? VAR = VAR.VAR(@VAR * @VAR) VAR @VAR.VAR? VAR = VAR.VAR(@VAR).VAR VAR VAR(VAR:, VAR: VAR, VAR: {}) @VAR = VAR @VAR = @VAR[:VAR].VAR @VAR = @VAR[:VAR].VAR? ? @VAR[:VAR].VAR : @VAR[:VAR] VAR = @VAR[:VAR] VAR = VAR.VAR? ? VAR.VAR(VAR: VAR) : VAR VAR = VAR.VAR? ? ""% VAR VAR.VAR? VAR = VAR.VAR(@VAR * @VAR[:VAR]) VAR @VAR.VAR? VAR = VAR.VAR(@VAR).VAR",7,3
discourse_bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,plugins/chat/app/controllers/chat/api/channels_memberships_controller.rb,"  INDEX_LIMIT = 50

    limit = fetch_limit_from_params(default: INDEX_LIMIT, max: INDEX_LIMIT)","    limit = (params[:limit] || 50).to_i.clamp(1, 50)",bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,CVE-2023-38684,bfc3132bb22bd5b7e86f428746b89c4d3d7f5a70,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = 50 VAR = VAR(VAR: VAR, VAR: VAR) VAR = (VAR[:VAR] || 50).VAR.VAR(1, 50)",0,3
discourse_d78357917c6a917a8a27af68756228e89c69321c,spec/lionebox/engine/github_issue_onebox_spec.rb,"# frozen_string_literal: true

RSpec.describe Onebox::Engine::GithubIssueOnebox do
  before do
    @link = ""https://github.com/discourse/discourse/issues/1""

    stub_request(:get, ""https://api.github.com/repos/discourse/discourse/issues/1"").to_return(
      status: 200,
      body: onebox_response(""github_issue_onebox""),
    )
  end

  include_context ""with engines""
  it_behaves_like ""an engine""

  describe ""#to_html"" do
    it ""sanitizes the input and transform the emoji into an img tag"" do
      sanitized_label =
        'Test <img src=""/images/emoji/twitter/+1.png?v=12"" title=""+1"" class=""emoji"" alt=""+1"" loading=""lazy"" width=""20"" height=""20""> &lt;style&gt;body {display: none}&lt;/style&gt;'

      expect(html).to include(sanitized_label)
    end
  end
end",,d78357917c6a917a8a27af68756228e89c69321c,CVE-2023-47119,d78357917c6a917a8a27af68756228e89c69321c,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR.VAR VAR::VAR::VAR VAR VAR VAR @VAR = ""VAR: VAR(:VAR, ""VAR: VAR: 200, VAR: VAR(""VAR""), ) VAR VAR ""VAR VAR"" VAR ""VAR VAR"" VAR "" VAR ""VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR = 'VAR <VAR VAR=""/VAR/VAR/VAR/+1.VAR?VAR=12"" VAR=""+1"" VAR=""VAR"" VAR=""+1"" VAR=""VAR"" VAR=""20"" VAR=""20""> &VAR;VAR&VAR;VAR {VAR: VAR}&VAR;/VAR&VAR;' VAR(VAR).VAR VAR(VAR) VAR VAR VAR ",7,3
django_cca0d98118cccf9ae0c6dcf2d6c57fc50469fbf0,docs/releases/2.2.20.txt,"===========================
Django 2.2.20 release notes
===========================

*April 6, 2021*

Django 2.2.20 fixes a security issue with severity ""low"" in 2.2.19.

CVE-2021-28658: Potential directory-traversal via uploaded files
================================================================

``MultiPartParser`` allowed directory-traversal via uploaded files with
suitably crafted file names.

Built-in upload handlers were not affected by this vulnerability.",,cca0d98118cccf9ae0c6dcf2d6c57fc50469fbf0,CVE-2021-28658,cca0d98118cccf9ae0c6dcf2d6c57fc50469fbf0,https://github.com/django/django,GHSD_REGISTRY,88,COMPLETED,"=========================== VAR 2.2.20 VAR VAR =========================== *VAR 6, 2021* VAR 2.2.20 VAR VAR VAR VAR VAR VAR ""VAR"" VAR 2.2.19. VAR-2021-28658: VAR VAR-VAR VAR VAR VAR ================================================================ ``VAR`` VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. ",7,3
django_d4d800ca1addc4141e03c5440a849bb64d1582cd,docs/releases/2.2.20.txt,"===========================
Django 2.2.20 release notes
===========================

*April 6, 2021*

Django 2.2.20 fixes a security issue with severity ""low"" in 2.2.19.

CVE-2021-28658: Potential directory-traversal via uploaded files
================================================================

``MultiPartParser`` allowed directory-traversal via uploaded files with
suitably crafted file names.

Built-in upload handlers were not affected by this vulnerability.",,d4d800ca1addc4141e03c5440a849bb64d1582cd,CVE-2021-28658,d4d800ca1addc4141e03c5440a849bb64d1582cd,https://github.com/django/django,GHSD_REGISTRY,152,COMPLETED,"=========================== VAR 2.2.20 VAR VAR =========================== *VAR 6, 2021* VAR 2.2.20 VAR VAR VAR VAR VAR VAR ""VAR"" VAR 2.2.19. VAR-2021-28658: VAR VAR-VAR VAR VAR VAR ================================================================ ``VAR`` VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. ",7,3
django_e7fba62248f604c76da4f23dcf1db4a57b0808ea,docs/releases/2.2.20.txt,"===========================
Django 2.2.20 release notes
===========================

*April 6, 2021*

Django 2.2.20 fixes a security issue with severity ""low"" in 2.2.19.

CVE-2021-28658: Potential directory-traversal via uploaded files
================================================================

``MultiPartParser`` allowed directory-traversal via uploaded files with
suitably crafted file names.

Built-in upload handlers were not affected by this vulnerability.",,e7fba62248f604c76da4f23dcf1db4a57b0808ea,CVE-2021-28658,e7fba62248f604c76da4f23dcf1db4a57b0808ea,https://github.com/django/django,GHSD_REGISTRY,88,COMPLETED,"=========================== VAR 2.2.20 VAR VAR =========================== *VAR 6, 2021* VAR 2.2.20 VAR VAR VAR VAR VAR VAR ""VAR"" VAR 2.2.19. VAR-2021-28658: VAR VAR-VAR VAR VAR VAR ================================================================ ``VAR`` VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. ",7,3
go_0d719823af1343f9921ee0293596f09e36ced0e4,doc/godebug.md,"
Go 1.21 made it an error for html/template actions to appear inside of an ECMAScript 6
template literal, controlled by the
[`jstmpllitinterp` setting](/pkg/html/template#hdr-Security_Model).
This behavior was backported to Go 1.19.8+ and Go 1.20.3+.

Go 1.21 introduced a limit on the maximum number of MIME headers and multipart
forms, controlled by the
[`multipartmaxheaders` and `multipartmaxparts` settings](/pkg/mime/multipart#hdr-Limits)
respectively.
This behavior was backported to Go 1.19.8+ and Go 1.20.3+.

There is no plan to remove any of these settings.",There is no plan to remove this setting.,0d719823af1343f9921ee0293596f09e36ced0e4,CVE-2023-24538,0d719823af1343f9921ee0293596f09e36ced0e4,https://github.com/golang/go,CPE_GIT_REPOBASED,70,COMPLETED,"VAR 1.21 VAR VAR VAR VAR VAR VAR/VAR VAR VAR VAR VAR VAR VAR VAR 6 VAR VAR, VAR VAR VAR [`VAR` VAR](/VAR/VAR/VAR VAR VAR VAR VAR VAR VAR 1.19.8+ VAR VAR 1.20.3+. VAR 1.21 VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR [`VAR` VAR `VAR` VAR](/VAR/VAR/VAR VAR. VAR VAR VAR VAR VAR VAR 1.19.8+ VAR VAR 1.20.3+. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR.",7,3
go_6446af942e2e2b161c4ec1b60d9703a2b55dc4dd,src/net/http/internal/chunked_test.go,"
func TestChunkReaderTooMuchOverhead(t *testing.T) {
	// If the sender is sending 100x as many chunk header bytes as chunk data,
	// we should reject the stream at some point.
	chunk := []byte(""1;"")
	for i := 0; i < 100; i++ {
		chunk = append(chunk, 'a') // chunk extension
	}
	chunk = append(chunk, ""\r\nX\r\n""...)
	const bodylen = 1 << 20
	r := NewChunkedReader(&funcReader{f: func(i int) ([]byte, error) {
		if i < bodylen {
			return chunk, nil
		}
		return []byte(""0\r\n""), nil
	}})
	_, err := io.ReadAll(r)
	if err == nil {
		t.Fatalf(""successfully read body with excessive overhead; want error"")
	}
}

func TestChunkReaderByteAtATime(t *testing.T) {
	// Sending one byte per chunk should not trip the excess-overhead detection.
	const bodylen = 1 << 20
	r := NewChunkedReader(&funcReader{f: func(i int) ([]byte, error) {
		if i < bodylen {
			return []byte(""1\r\nX\r\n""), nil
		}
		return []byte(""0\r\n""), nil
	}})
	got, err := io.ReadAll(r)
	if err != nil {
		t.Errorf(""unexpected error: %v"", err)
	}
	if len(got) != bodylen {
		t.Errorf(""read %v bytes, want %v"", len(got), bodylen)
	}
}

type funcReader struct {
	f   func(iteration int) ([]byte, error)
	i   int
	b   []byte
	err error
}

func (r *funcReader) Read(p []byte) (n int, err error) {
	if len(r.b) == 0 && r.err == nil {
		r.b, r.err = r.f(r.i)
		r.i++
	}
	n = copy(p, r.b)
	r.b = r.b[n:]
	if len(r.b) > 0 {
		return n, nil
	}
	return n, r.err
}",,6446af942e2e2b161c4ec1b60d9703a2b55dc4dd,CVE-2023-39326,6446af942e2e2b161c4ec1b60d9703a2b55dc4dd,https://github.com/golang/go,CPE_GIT_REPOBASED,150,COMPLETED,"VAR VAR(VAR *VAR.VAR) {   VAR := []VAR(""1;"") VAR VAR := 0; VAR < 100; VAR++ { VAR = VAR(VAR, 'VAR')  } VAR = VAR(VAR, ""\VAR\VAR\VAR\VAR""...) VAR VAR = 1 << 20 VAR := VAR(&VAR{VAR: VAR(VAR VAR) ([]VAR, VAR) { VAR VAR < VAR { VAR VAR, VAR } VAR []VAR(""0\VAR\VAR""), VAR }}) VAR, VAR := VAR.VAR(VAR) VAR VAR == VAR { VAR.VAR(""VAR VAR VAR VAR VAR VAR; VAR VAR"") } } VAR VAR(VAR *VAR.VAR) {  VAR VAR = 1 << 20 VAR := VAR(&VAR{VAR: VAR(VAR VAR) ([]VAR, VAR) { VAR VAR < VAR { VAR []VAR(""1\VAR\VAR\VAR\VAR""), VAR } VAR []VAR(""0\VAR\VAR""), VAR }}) VAR, VAR := VAR.VAR(VAR) VAR VAR != VAR { VAR.VAR(""VAR VAR: %VAR"", VAR) } VAR VAR(VAR) != VAR { VAR.VAR(""VAR %VAR VAR, VAR %VAR"", VAR(VAR), VAR) } } VAR VAR VAR { VAR VAR(VAR VAR) ([]VAR, VAR) VAR VAR VAR []VAR VAR VAR } VAR (VAR *VAR) VAR(VAR []VAR) (VAR VAR, VAR VAR) { VAR VAR(VAR.VAR) == 0 && VAR.VAR == VAR { VAR.VAR, VAR.VAR = VAR.VAR(VAR.VAR) VAR.VAR++ } VAR = VAR(VAR, VAR.VAR) VAR.VAR = VAR.VAR[VAR:] VAR VAR(VAR.VAR) > 0 { VAR VAR, VAR } VAR VAR, VAR.VAR } ",7,3
go_ea6b5a64dd5bf68b33286436ffbe06f68a1fdbfd,src/mime/multipart/formdata_test.go,"
func BenchmarkReadForm(b *testing.B) {
	for _, test := range []struct {
		name string
		form func(fw *Writer, count int)
	}{{
		name: ""fields"",
		form: func(fw *Writer, count int) {
			for i := 0; i < count; i++ {
				w, _ := fw.CreateFormField(fmt.Sprintf(""field%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
		},
	}, {
		name: ""files"",
		form: func(fw *Writer, count int) {
			for i := 0; i < count; i++ {
				w, _ := fw.CreateFormFile(fmt.Sprintf(""field%v"", i), fmt.Sprintf(""file%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
		},
	}} {
		b.Run(test.name, func(b *testing.B) {
			for _, maxMemory := range []int64{
				0,
				1 << 20,
			} {
				var buf bytes.Buffer
				fw := NewWriter(&buf)
				test.form(fw, 10)
				if err := fw.Close(); err != nil {
					b.Fatal(err)
				}
				b.Run(fmt.Sprintf(""maxMemory=%v"", maxMemory), func(b *testing.B) {
					b.ReportAllocs()
					for i := 0; i < b.N; i++ {
						fr := NewReader(bytes.NewReader(buf.Bytes()), fw.Boundary())
						form, err := fr.ReadForm(maxMemory)
						if err != nil {
							b.Fatal(err)
						}
						form.RemoveAll()
					}

				})
			}
		})
	}
}",,ea6b5a64dd5bf68b33286436ffbe06f68a1fdbfd,CVE-2023-24536,ea6b5a64dd5bf68b33286436ffbe06f68a1fdbfd,https://github.com/golang/go,CPE_GIT_REPOBASED,226,COMPLETED,"VAR VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR { VAR VAR VAR VAR(VAR *VAR, VAR VAR) }{{ VAR: ""VAR"", VAR: VAR(VAR *VAR, VAR VAR) { VAR VAR := 0; VAR < VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } }, }, { VAR: ""VAR"", VAR: VAR(VAR *VAR, VAR VAR) { VAR VAR := 0; VAR < VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR), VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } }, }} { VAR.VAR(VAR.VAR, VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR{ 0, 1 << 20, } { VAR VAR VAR.VAR VAR := VAR(&VAR) VAR.VAR(VAR, 10) VAR VAR := VAR.VAR(); VAR != VAR { VAR.VAR(VAR) } VAR.VAR(VAR.VAR(""VAR=%VAR"", VAR), VAR(VAR *VAR.VAR) { VAR.VAR() VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR := VAR(VAR.VAR(VAR.VAR()), VAR.VAR()) VAR, VAR := VAR.VAR(VAR) VAR VAR != VAR { VAR.VAR(VAR) } VAR.VAR() } }) } }) } } ",7,3
go_ef41a4e2face45e580c5836eaebd51629fc23f15,src/mime/multipart/formdata_test.go,"
func BenchmarkReadForm(b *testing.B) {
	for _, test := range []struct {
		name string
		form func(fw *Writer, count int)
	}{{
		name: ""fields"",
		form: func(fw *Writer, count int) {
			for i := 0; i < count; i++ {
				w, _ := fw.CreateFormField(fmt.Sprintf(""field%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
		},
	}, {
		name: ""files"",
		form: func(fw *Writer, count int) {
			for i := 0; i < count; i++ {
				w, _ := fw.CreateFormFile(fmt.Sprintf(""field%v"", i), fmt.Sprintf(""file%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
		},
	}} {
		b.Run(test.name, func(b *testing.B) {
			for _, maxMemory := range []int64{
				0,
				1 << 20,
			} {
				var buf bytes.Buffer
				fw := NewWriter(&buf)
				test.form(fw, 10)
				if err := fw.Close(); err != nil {
					b.Fatal(err)
				}
				b.Run(fmt.Sprintf(""maxMemory=%v"", maxMemory), func(b *testing.B) {
					b.ReportAllocs()
					for i := 0; i < b.N; i++ {
						fr := NewReader(bytes.NewReader(buf.Bytes()), fw.Boundary())
						form, err := fr.ReadForm(maxMemory)
						if err != nil {
							b.Fatal(err)
						}
						form.RemoveAll()
					}

				})
			}
		})
	}
}",,ef41a4e2face45e580c5836eaebd51629fc23f15,CVE-2023-24536,ef41a4e2face45e580c5836eaebd51629fc23f15,https://github.com/golang/go,CPE_GIT_REPOBASED,162,COMPLETED,"VAR VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR { VAR VAR VAR VAR(VAR *VAR, VAR VAR) }{{ VAR: ""VAR"", VAR: VAR(VAR *VAR, VAR VAR) { VAR VAR := 0; VAR < VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } }, }, { VAR: ""VAR"", VAR: VAR(VAR *VAR, VAR VAR) { VAR VAR := 0; VAR < VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR), VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } }, }} { VAR.VAR(VAR.VAR, VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR{ 0, 1 << 20, } { VAR VAR VAR.VAR VAR := VAR(&VAR) VAR.VAR(VAR, 10) VAR VAR := VAR.VAR(); VAR != VAR { VAR.VAR(VAR) } VAR.VAR(VAR.VAR(""VAR=%VAR"", VAR), VAR(VAR *VAR.VAR) { VAR.VAR() VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR := VAR(VAR.VAR(VAR.VAR()), VAR.VAR()) VAR, VAR := VAR.VAR(VAR) VAR VAR != VAR { VAR.VAR(VAR) } VAR.VAR() } }) } }) } } ",7,3
gpac_289ffce3e0d224d314f5f92a744d5fe35999f20b,applications/mp4box/filedump.c,"		if (!av1c) {
			fprintf(stderr, ""\tCorrupted av1 config\n"");
		} else {
			fprintf(stderr, ""\tversion=%u, profile=%u, level_idx0=%u, tier=%u\n"", (u32)av1c->version, (u32)av1c->seq_profile, (u32)av1c->seq_level_idx_0, (u32)av1c->seq_tier_0);
			fprintf(stderr, ""\thigh_bitdepth=%u, twelve_bit=%u, monochrome=%u\n"", (u32)av1c->high_bitdepth, (u32)av1c->twelve_bit, (u32)av1c->monochrome);
			fprintf(stderr, ""\tchroma: subsampling_x=%u, subsampling_y=%u, sample_position=%u\n"", (u32)av1c->chroma_subsampling_x, (u32)av1c->chroma_subsampling_y, (u32)av1c->chroma_sample_position);
			if (av1c->initial_presentation_delay_present)
				fprintf(stderr, ""\tInitial presentation delay %u\n"", (u32) av1c->initial_presentation_delay_minus_one+1);
			count = gf_list_count(av1c->obu_array);
			for (i=0; i<count; i++) {
				u8 hash[20];
				GF_AV1_OBUArrayEntry *obu = gf_list_get(av1c->obu_array, i);
				gf_sha1_csum((u8*)obu->obu, (u32)obu->obu_length, hash);
				fprintf(stderr, ""\tOBU#%d %s hash: "", i+1, gf_av1_get_obu_name(obu->obu_type) );
				for (j=0; j<20; j++) fprintf(stderr, ""%02X"", hash[j]);
				fprintf(stderr, ""\n"");
			}
			gf_odf_av1_cfg_del(av1c);","		fprintf(stderr, ""\tversion=%u, profile=%u, level_idx0=%u, tier=%u\n"", (u32)av1c->version, (u32)av1c->seq_profile, (u32)av1c->seq_level_idx_0, (u32)av1c->seq_tier_0);
		fprintf(stderr, ""\thigh_bitdepth=%u, twelve_bit=%u, monochrome=%u\n"", (u32)av1c->high_bitdepth, (u32)av1c->twelve_bit, (u32)av1c->monochrome);
		fprintf(stderr, ""\tchroma: subsampling_x=%u, subsampling_y=%u, sample_position=%u\n"", (u32)av1c->chroma_subsampling_x, (u32)av1c->chroma_subsampling_y, (u32)av1c->chroma_sample_position);
		if (av1c->initial_presentation_delay_present)
			fprintf(stderr, ""\tInitial presentation delay %u\n"", (u32) av1c->initial_presentation_delay_minus_one+1);
		count = gf_list_count(av1c->obu_array);
		for (i=0; i<count; i++) {
			u8 hash[20];
			GF_AV1_OBUArrayEntry *obu = gf_list_get(av1c->obu_array, i);
			gf_sha1_csum((u8*)obu->obu, (u32)obu->obu_length, hash);
			fprintf(stderr, ""\tOBU#%d %s hash: "", i+1, gf_av1_get_obu_name(obu->obu_type) );
			for (j=0; j<20; j++) fprintf(stderr, ""%02X"", hash[j]);
			fprintf(stderr, ""\n"");
		gf_odf_av1_cfg_del(av1c);",289ffce3e0d224d314f5f92a744d5fe35999f20b,CVE-2021-32138,289ffce3e0d224d314f5f92a744d5fe35999f20b,https://github.com/gpac/gpac,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR (!VAR) { VAR(VAR, ""\VAR VAR VAR\VAR""); } VAR { VAR(VAR, ""\VAR=%VAR, VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR(VAR, ""\VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR(VAR, ""\VAR: VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR (VAR->VAR) VAR(VAR, ""\VAR VAR VAR %VAR\VAR"", (VAR) VAR->VAR+1); VAR = VAR(VAR->VAR); VAR (VAR=0; VAR<VAR; VAR++) { VAR VAR[20]; VAR *VAR = VAR(VAR->VAR, VAR); VAR((VAR*)VAR->VAR, (VAR)VAR->VAR, VAR); VAR(VAR, ""\VAR VAR (VAR=0; VAR<20; VAR++) VAR(VAR, ""%02X"", VAR[VAR]); VAR(VAR, ""\VAR""); } VAR(VAR); VAR(VAR, ""\VAR=%VAR, VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR(VAR, ""\VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR(VAR, ""\VAR: VAR=%VAR, VAR=%VAR, VAR=%VAR\VAR"", (VAR)VAR->VAR, (VAR)VAR->VAR, (VAR)VAR->VAR); VAR (VAR->VAR) VAR(VAR, ""\VAR VAR VAR %VAR\VAR"", (VAR) VAR->VAR+1); VAR = VAR(VAR->VAR); VAR (VAR=0; VAR<VAR; VAR++) { VAR VAR[20]; VAR *VAR = VAR(VAR->VAR, VAR); VAR((VAR*)VAR->VAR, (VAR)VAR->VAR, VAR); VAR(VAR, ""\VAR VAR (VAR=0; VAR<20; VAR++) VAR(VAR, ""%02X"", VAR[VAR]); VAR(VAR, ""\VAR""); VAR(VAR);",7,3
gpac_da37ec8582266983d0ec4b7550ec907401ec441e,src/filter_core/filter_session.c,"	u32 flen = 20 + (u32) strlen(file_name);

	char *apath = gf_malloc(sizeof(char) * (len+flen) );
	if (!apath) return GF_FALSE;
	strcpy(apath, path);

	strcat(apath, file_name);
	if (gf_file_exists(apath)) {
		gf_free(apath);
	}
		strcat(apath, "".js"");
		if (gf_file_exists(apath)) {
			gf_free(apath);
		}
	apath[len] = 0;
	strcat(apath, file_name);
	strcat(apath, ""/init.js"");
	if (gf_file_exists(apath)) {
		gf_free(apath);
	}
	gf_free(apath);","	strcat(path, file_name);
	if (gf_file_exists(path))
		strcat(path, "".js"");
		if (gf_file_exists(path))
	path[len] = 0;
	strcat(path, file_name);
	strcat(path, ""/init.js"");
	if (gf_file_exists(path))
",da37ec8582266983d0ec4b7550ec907401ec441e,CVE-2021-40942,da37ec8582266983d0ec4b7550ec907401ec441e,https://github.com/gpac/gpac,NVD_GIT_REPOBASED,118,COMPLETED,"VAR VAR = 20 + (VAR) VAR(VAR); VAR *VAR = VAR(VAR(VAR) * (VAR+VAR) ); VAR (!VAR) VAR VAR; VAR(VAR, VAR); VAR(VAR, VAR); VAR (VAR(VAR)) { VAR(VAR); } VAR(VAR, "".VAR""); VAR (VAR(VAR)) { VAR(VAR); } VAR[VAR] = 0; VAR(VAR, VAR); VAR(VAR, ""/VAR.VAR""); VAR (VAR(VAR)) { VAR(VAR); } VAR(VAR); VAR(VAR, VAR); VAR (VAR(VAR)) VAR(VAR, "".VAR""); VAR (VAR(VAR)) VAR[VAR] = 0; VAR(VAR, VAR); VAR(VAR, ""/VAR.VAR""); VAR (VAR(VAR))",7,3
libarchive_1e18cbb71515a22b2a6f1eb4aaadea461929b834,libarchive/test/test_read_format_mtree.c,"	assertEqualIntA(a, ARCHIVE_OK, archive_read_next_header(a, &ae));
	assertEqualString(archive_entry_pathname(ae), ""dir2/dir3b/filename\\with_esc\b\t\fapes"");
	assertEqualInt(archive_entry_filetype(ae), AE_IFREG);
	assertEqualInt(archive_entry_is_encrypted(ae), 0);
	assertEqualIntA(a, archive_read_has_encrypted_entries(a), ARCHIVE_READ_FORMAT_ENCRYPTION_UNSUPPORTED);

	assertEqualInt(20, archive_file_count(a));","	assertEqualInt(19, archive_file_count(a));",1e18cbb71515a22b2a6f1eb4aaadea461929b834,CVE-2015-8925,1e18cbb71515a22b2a6f1eb4aaadea461929b834,https://github.com/libarchive/libarchive,NVD_GIT_REPOBASED,80,COMPLETED,"VAR(VAR, VAR, VAR(VAR, &VAR)); VAR(VAR(VAR), ""VAR/VAR/VAR\\VAR\VAR\VAR\VAR""); VAR(VAR(VAR), VAR); VAR(VAR(VAR), 0); VAR(VAR, VAR(VAR), VAR); VAR(20, VAR(VAR)); VAR(19, VAR(VAR));",7,3
linux_50b5d6ad63821cea324a5a7a19854d4de1a0a819,net/sctp/input.c,"	if (sock_owned_by_user(sk)) {
		if (timer_pending(&t->proto_unreach_timer))
			return;
		else {
			if (!mod_timer(&t->proto_unreach_timer,
						jiffies + (HZ/20)))
				sctp_association_hold(asoc);
		}

	} else {
		if (timer_pending(&t->proto_unreach_timer) &&
		    del_timer(&t->proto_unreach_timer))
			sctp_association_put(asoc);
		sctp_do_sm(SCTP_EVENT_T_OTHER,
			   SCTP_ST_OTHER(SCTP_EVENT_ICMP_PROTO_UNREACH),
			   asoc->state, asoc->ep, asoc, t,
			   GFP_ATOMIC);
	}","	sctp_do_sm(SCTP_EVENT_T_OTHER,
		   SCTP_ST_OTHER(SCTP_EVENT_ICMP_PROTO_UNREACH),
		   asoc->state, asoc->ep, asoc, t,
		   GFP_ATOMIC);",50b5d6ad63821cea324a5a7a19854d4de1a0a819,CVE-2010-4526,50b5d6ad63821cea324a5a7a19854d4de1a0a819,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,98,COMPLETED,"VAR (VAR(VAR)) { VAR (VAR(&VAR->VAR)) VAR; VAR { VAR (!VAR(&VAR->VAR, VAR + (VAR/20))) VAR(VAR); } } VAR { VAR (VAR(&VAR->VAR) && VAR(&VAR->VAR)) VAR(VAR); VAR(VAR, VAR(VAR), VAR->VAR, VAR->VAR, VAR, VAR, VAR); } VAR(VAR, VAR(VAR), VAR->VAR, VAR->VAR, VAR, VAR, VAR);",7,3
linux_50b5d6ad63821cea324a5a7a19854d4de1a0a819,net/sctp/sm_sideeffect.c,"/* Handle the timeout of the ICMP protocol unreachable timer.  Trigger
 * the correct state machine transition that will close the association.
 */
void sctp_generate_proto_unreach_event(unsigned long data)
{
	struct sctp_transport *transport = (struct sctp_transport *) data;
	struct sctp_association *asoc = transport->asoc;

	sctp_bh_lock_sock(asoc->base.sk);
	if (sock_owned_by_user(asoc->base.sk)) {
		SCTP_DEBUG_PRINTK(""%s:Sock is busy.\n"", __func__);

		/* Try again later.  */
		if (!mod_timer(&transport->proto_unreach_timer,
				jiffies + (HZ/20)))
			sctp_association_hold(asoc);
		goto out_unlock;
	}

	/* Is this structure just waiting around for us to actually
	 * get destroyed?
	 */
	if (asoc->base.dead)
		goto out_unlock;

	sctp_do_sm(SCTP_EVENT_T_OTHER,
		   SCTP_ST_OTHER(SCTP_EVENT_ICMP_PROTO_UNREACH),
		   asoc->state, asoc->ep, asoc, transport, GFP_ATOMIC);

out_unlock:
	sctp_bh_unlock_sock(asoc->base.sk);
	sctp_association_put(asoc);
}

",,50b5d6ad63821cea324a5a7a19854d4de1a0a819,CVE-2010-4526,50b5d6ad63821cea324a5a7a19854d4de1a0a819,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,98,COMPLETED,"/* VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. */ VAR VAR(VAR VAR VAR) { VAR VAR *VAR = (VAR VAR *) VAR; VAR VAR *VAR = VAR->VAR; VAR(VAR->VAR.VAR); VAR (VAR(VAR->VAR.VAR)) { VAR(""%VAR:VAR VAR VAR.\VAR"", VAR);  VAR (!VAR(&VAR->VAR, VAR + (VAR/20))) VAR(VAR); VAR VAR; } /* VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR VAR? */ VAR (VAR->VAR.VAR) VAR VAR; VAR(VAR, VAR(VAR), VAR->VAR, VAR->VAR, VAR, VAR, VAR); VAR: VAR(VAR->VAR.VAR); VAR(VAR); } ",7,3
linux_5f2f97656ada8d811d3c1bef503ced266fcd53a0,net/rxrpc/key.c,"	unsigned int toklen = *_toklen, n_parts, loop, tmp, paddedlen;
		paddedlen = (tmp + 3) & ~3;
		if (paddedlen > toklen)
		toklen -= paddedlen;
		xdr += paddedlen >> 2;
	paddedlen = (tmp + 3) & ~3;
	if (paddedlen > toklen)
	toklen -= paddedlen;
	xdr += paddedlen >> 2;
	unsigned int toklen = *_toklen, len, paddedlen;
	paddedlen = (len + 3) & ~3;
	if (paddedlen > toklen)
		return -EINVAL;
		toklen -= paddedlen;
		xdr += paddedlen >> 2;
	unsigned int toklen = *_toklen, len, paddedlen;
	paddedlen = (len + 3) & ~3;
	if (paddedlen > toklen)
		return -EINVAL;
		toklen -= paddedlen;
		xdr += paddedlen >> 2;
	unsigned int len, paddedlen, loop, ntoken, toklen, sec_ix;
	paddedlen = (len + 3) & ~3;
	if (paddedlen > datalen)
	for (; loop < paddedlen; loop++)
		if (cp[loop])
			goto not_xdr;
	       len, paddedlen, len, len, (const char *) xdr);
	datalen -= paddedlen;
	xdr += paddedlen >> 2;
		paddedlen = (toklen + 3) & ~3;
		if (toklen < 20 || toklen > datalen || paddedlen > datalen)
		datalen -= paddedlen;
		xdr += paddedlen >> 2;","	unsigned int toklen = *_toklen, n_parts, loop, tmp;
		if (tmp > toklen)
		tmp = (tmp + 3) & ~3;
		toklen -= tmp;
		xdr += tmp >> 2;
	if (tmp > toklen)
	tmp = (tmp + 3) & ~3;
	toklen -= tmp;
	xdr += tmp >> 2;
	unsigned int toklen = *_toklen, len;
		len = (len + 3) & ~3;
		toklen -= len;
		xdr += len >> 2;
	unsigned int toklen = *_toklen, len;
		len = (len + 3) & ~3;
		toklen -= len;
		xdr += len >> 2;
	unsigned int len, tmp, loop, ntoken, toklen, sec_ix;
	tmp = (len + 3) & ~3;
	if (tmp > datalen)
	if (len < tmp)
		for (; loop < tmp; loop++)
			if (cp[loop])
				goto not_xdr;
	       len, tmp, len, len, (const char *) xdr);
	datalen -= tmp;
	xdr += tmp >> 2;
		if (toklen < 20 || toklen > datalen)
		datalen -= (toklen + 3) & ~3;
		xdr += (toklen + 3) >> 2;",5f2f97656ada8d811d3c1bef503ced266fcd53a0,CVE-2017-7482,5f2f97656ada8d811d3c1bef503ced266fcd53a0,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,152,COMPLETED,"VAR VAR VAR = *VAR, VAR, VAR, VAR, VAR; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR -= VAR; VAR += VAR >> 2; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR = *VAR, VAR, VAR; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR -VAR; VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR = *VAR, VAR, VAR; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR -VAR; VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR, VAR, VAR, VAR, VAR, VAR; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR (; VAR < VAR; VAR++) VAR (VAR[VAR]) VAR VAR; VAR, VAR, VAR, VAR, (VAR VAR *) VAR); VAR -= VAR; VAR += VAR >> 2; VAR = (VAR + 3) & ~3; VAR (VAR < 20 || VAR > VAR || VAR > VAR) VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR = *VAR, VAR, VAR, VAR; VAR (VAR > VAR) VAR = (VAR + 3) & ~3; VAR -= VAR; VAR += VAR >> 2; VAR (VAR > VAR) VAR = (VAR + 3) & ~3; VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR = *VAR, VAR; VAR = (VAR + 3) & ~3; VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR = *VAR, VAR; VAR = (VAR + 3) & ~3; VAR -= VAR; VAR += VAR >> 2; VAR VAR VAR, VAR, VAR, VAR, VAR, VAR; VAR = (VAR + 3) & ~3; VAR (VAR > VAR) VAR (VAR < VAR) VAR (; VAR < VAR; VAR++) VAR (VAR[VAR]) VAR VAR; VAR, VAR, VAR, VAR, (VAR VAR *) VAR); VAR -= VAR; VAR += VAR >> 2; VAR (VAR < 20 || VAR > VAR) VAR -= (VAR + 3) & ~3; VAR += (VAR + 3) >> 2;",7,3
linux_67de956ff5dc1d4f321e16cfbd63f5be3b691b43,net/nfc/nci/ntf.c,"	nfca_poll->nfcid1_len = min_t(__u8, *data++, NFC_NFCID1_MAXSIZE);
	nfcb_poll->sensb_res_len = min_t(__u8, *data++, NFC_SENSB_RES_MAXSIZE);
	nfcf_poll->sensf_res_len = min_t(__u8, *data++, NFC_SENSF_RES_MAXSIZE);
		nfca_poll->rats_res_len = min_t(__u8, *data++, 20);
		nfcb_poll->attrib_res_len = min_t(__u8, *data++, 50);","	nfca_poll->nfcid1_len = *data++;
	nfcb_poll->sensb_res_len = *data++;
	nfcf_poll->sensf_res_len = *data++;
		nfca_poll->rats_res_len = *data++;
		nfcb_poll->attrib_res_len = *data++;",67de956ff5dc1d4f321e16cfbd63f5be3b691b43,CVE-2012-3364,67de956ff5dc1d4f321e16cfbd63f5be3b691b43,https://github.com/torvalds/linux,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR->VAR = VAR(VAR, *VAR++, VAR); VAR->VAR = VAR(VAR, *VAR++, VAR); VAR->VAR = VAR(VAR, *VAR++, VAR); VAR->VAR = VAR(VAR, *VAR++, 20); VAR->VAR = VAR(VAR, *VAR++, 50); VAR->VAR = *VAR++; VAR->VAR = *VAR++; VAR->VAR = *VAR++; VAR->VAR = *VAR++; VAR->VAR = *VAR++;",7,3
linux_7d63fb3af87aa67aa7d24466e792f9d7c57d8e79,kernel/dma/swiotlb.c,"#define pr_fmt(fmt) ""software IO TLB: "" fmt

		pr_warn(""No low mem\n"");
	pr_info(""mapped [mem %#010llx-%#010llx] (%luMB)\n"",
	       bytes >> 20);
	pr_warn(""Cannot allocate buffer"");
		pr_warn(""only able to allocate %ld MB\n"",
			(PAGE_SIZE << order) >> 20);","	unsigned char *vstart, *vend;
		pr_warn(""software IO TLB: No low mem\n"");
	vstart = phys_to_virt(io_tlb_start);
	vend = phys_to_virt(io_tlb_end);

	printk(KERN_INFO ""software IO TLB [mem %#010llx-%#010llx] (%luMB) mapped at [%p-%p]\n"",
	       bytes >> 20, vstart, vend - 1);
	pr_warn(""Cannot allocate SWIOTLB buffer"");
		printk(KERN_WARNING ""Warning: only able to allocate %ld MB ""
		       ""for software IO TLB\n"", (PAGE_SIZE << order) >> 20);",7d63fb3af87aa67aa7d24466e792f9d7c57d8e79,CVE-2018-5953,7d63fb3af87aa67aa7d24466e792f9d7c57d8e79,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,88,COMPLETED," VAR(""VAR VAR VAR\VAR""); VAR(""VAR [VAR % VAR >> 20); VAR(""VAR VAR VAR""); VAR(""VAR VAR VAR VAR %VAR VAR\VAR"", (VAR << VAR) >> 20); VAR VAR *VAR, *VAR; VAR(""VAR VAR VAR: VAR VAR VAR\VAR""); VAR = VAR(VAR); VAR = VAR(VAR); VAR(VAR ""VAR VAR VAR [VAR % VAR >> 20, VAR, VAR - 1); VAR(""VAR VAR VAR VAR""); VAR(VAR ""VAR: VAR VAR VAR VAR %VAR VAR "" ""VAR VAR VAR VAR\VAR"", (VAR << VAR) >> 20);",7,3
linux_9f260e0efa4766e56d0ac14f1aeea6ee5eb8fe83,net/can/bcm.c,"	char procname [32]; /* inode number in decimal with \0 */
		sprintf(bo->procname, ""%lu"", sock_i_ino(sk));","	char procname [20]; /* pointer printed in ASCII with \0 */
		sprintf(bo->procname, ""%p"", sock);",9f260e0efa4766e56d0ac14f1aeea6ee5eb8fe83,CVE-2010-4565,9f260e0efa4766e56d0ac14f1aeea6ee5eb8fe83,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,140,COMPLETED,"VAR VAR [32];  VAR(VAR->VAR, ""%VAR"", VAR(VAR)); VAR VAR [20];  VAR(VAR->VAR, ""%VAR"", VAR);",7,3
linux_be20250c13f88375345ad99950190685eda51eb8,net/rose/rose_subr.c,"					if (pt[6] & AX25_HBIT) {
						if (facilities->dest_ndigis >= ROSE_MAX_DIGIS)
							return -1;
					} else {
						if (facilities->source_ndigis >= ROSE_MAX_DIGIS)
							return -1;
					}

			/* Prevent overflows*/
			if (l < 10 || l > 20)
				return -1;

				if (len < 0)
					return 0;
				if (len < 0)
					return 0;","					if (pt[6] & AX25_HBIT)
					else",be20250c13f88375345ad99950190685eda51eb8,CVE-2011-4913,be20250c13f88375345ad99950190685eda51eb8,https://github.com/torvalds/linux,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR (VAR[6] & VAR) { VAR (VAR->VAR >= VAR) VAR -1; } VAR { VAR (VAR->VAR >= VAR) VAR -1; }  VAR (VAR < 10 || VAR > 20) VAR -1; VAR (VAR < 0) VAR 0; VAR (VAR < 0) VAR 0; VAR (VAR[6] & VAR) VAR,7,3
linux_be20250c13f88375345ad99950190685eda51eb8,net/rose/rose_subr.c,"					if (pt[6] & AX25_HBIT) {
						if (facilities->dest_ndigis >= ROSE_MAX_DIGIS)
							return -1;
					} else {
						if (facilities->source_ndigis >= ROSE_MAX_DIGIS)
							return -1;
					}

			/* Prevent overflows*/
			if (l < 10 || l > 20)
				return -1;

				if (len < 0)
					return 0;
				if (len < 0)
					return 0;","					if (pt[6] & AX25_HBIT)
					else",be20250c13f88375345ad99950190685eda51eb8,CVE-2011-1493,be20250c13f88375345ad99950190685eda51eb8,https://github.com/torvalds/linux,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR (VAR[6] & VAR) { VAR (VAR->VAR >= VAR) VAR -1; } VAR { VAR (VAR->VAR >= VAR) VAR -1; }  VAR (VAR < 10 || VAR > 20) VAR -1; VAR (VAR < 0) VAR 0; VAR (VAR < 0) VAR 0; VAR (VAR[6] & VAR) VAR,7,3
linux_bfeffd155283772bbe78c6a05dec7c0128ee500c,Makefile,"VERSION = 5
PATCHLEVEL = 0
EXTRAVERSION = -rc1","VERSION = 4
PATCHLEVEL = 20
EXTRAVERSION =",bfeffd155283772bbe78c6a05dec7c0128ee500c,CVE-2019-15927,bfeffd155283772bbe78c6a05dec7c0128ee500c,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,68,COMPLETED,VAR = 5 VAR = 0 VAR = -VAR VAR = 4 VAR = 20 VAR =,7,3
linux_f1e255d60ae66a9f672ff9a207ee6cd8e33d2679,drivers/usmisc/yurex.c,"	int len = 0;
		mutex_unlock(&dev->io_mutex);
		return -ENODEV;
	len = snprintf(in_buffer, 20, ""%lld\n"", dev->bbu);

	return simple_read_from_buffer(buffer, count, ppos, in_buffer, len);","	int retval = 0;
	int bytes_read = 0;
		retval = -ENODEV;
		goto exit;
	bytes_read = snprintf(in_buffer, 20, ""%lld\n"", dev->bbu);

	if (*ppos < bytes_read) {
		if (copy_to_user(buffer, in_buffer + *ppos, bytes_read - *ppos))
			retval = -EFAULT;
		else {
			retval = bytes_read - *ppos;
			*ppos += bytes_read;
		}
	}

exit:
	return retval;",f1e255d60ae66a9f672ff9a207ee6cd8e33d2679,CVE-2018-16276,f1e255d60ae66a9f672ff9a207ee6cd8e33d2679,https://github.com/torvalds/linux,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = 0; VAR(&VAR->VAR); VAR -VAR; VAR = VAR(VAR, 20, ""%VAR\VAR"", VAR->VAR); VAR VAR(VAR, VAR, VAR, VAR, VAR); VAR VAR = 0; VAR VAR = 0; VAR = -VAR; VAR VAR; VAR = VAR(VAR, 20, ""%VAR\VAR"", VAR->VAR); VAR (*VAR < VAR) { VAR (VAR(VAR, VAR + *VAR, VAR - *VAR)) VAR = -VAR; VAR { VAR = VAR - *VAR; *VAR += VAR; } } VAR: VAR VAR;",7,3
MISP_62f15433e42fb92e45bd57dd6fc0c0bf53deb6fc,app/webroot/js/misp.js,"    popupHtml = '<it class=""fa fa-spin fa-spinner"" style=""font-size: xx-large; color: white; position: fixed; left: 50%; top: 50%;""></it>';
    url = $('<div>').text(url).html();
    title = $('<div>').text(title).html();","    popupHtml = '<it class=""fa fa-spin fa-spinner"" style=""font-size: xx-large; color: white; position: fixed; left: 50%; top: 50%;""></it>'",62f15433e42fb92e45bd57dd6fc0c0bf53deb6fc,CVE-2019-11814,62f15433e42fb92e45bd57dd6fc0c0bf53deb6fc,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = '<VAR VAR=""VAR VAR-VAR VAR-VAR"" VAR=""VAR-VAR: VAR-VAR; VAR: VAR; VAR: VAR; VAR: 50%; VAR: 50%;""></VAR>'; VAR = $('<VAR>').VAR(VAR).VAR(); VAR = $('<VAR>').VAR(VAR).VAR(); VAR = '<VAR VAR=""VAR VAR-VAR VAR-VAR"" VAR=""VAR-VAR: VAR-VAR; VAR: VAR; VAR: VAR; VAR: 50%; VAR: 50%;""></VAR>'",0,3
MISP_6f6fb678ca07c80cb7d2bdfe5cb0313bb71bd487,app/View/Elements/Events/View/value_field.ctp,"    $sigDisplay = $object['value'];
    if ('attachment' == $object['type'] || 'malware-sample' == $object['type'] ) {
        if ($object['type'] == 'attachment' && isset($object['image'])) {
            if (extension_loaded('gd')) {
                $img = '<it class=""fa fa-spin fa-spinner"" style=""font-size: large; left: 50%; top: 50%;""></it>';
                $img .= '<img class=""screenshot screenshot-collapsed useCursorPointer img-rounded hidden"" src=""' . $baseurl . '/attributes/viewPicture/' . h($object['id']) . '/1' . '"" title=""' . h($object['value']) . '"" onload=""$(this).show(200); $(this).parent().find(\'.fa-spinner\').remove();""/>';
                echo $img;
            } else {
                $extension = explode('.', $object['value']);
                $extension = end($extension);
                $uri = 'data:image/' . strtolower(h($extension)) . ';base64,' . h($object['image']);
                echo '<img class=""screenshot screenshot-collapsed useCursorPointer"" src=""' . $uri . '"" title=""' . h($object['value']) . '"" />';
            }
            $filenameHash = explode('|', h($object['value']));
            if (strrpos($filenameHash[0], '\\')) {
                $filepath = substr($filenameHash[0], 0, strrpos($filenameHash[0], '\\'));
                $filename = substr($filenameHash[0], strrpos($filenameHash[0], '\\'));
                echo h($filepath);
                echo '<a href=""' . $baseurl . '/attributes/download/' . h($object['id']) . '"" class=""' . $linkClass . '"">' . h($filename) . '</a>';
            } else {
                echo '<a href=""' . $baseurl . '/attributes/download/' . h($object['id']) . '"" class=""' . $linkClass . '"">' . h($filenameHash[0]) . '</a>';
            }
            if (isset($filenameHash[1])) echo '<br />' . $filenameHash[1];
    } else if (strpos($object['type'], '|') !== false) {
        $separator = in_array($object['type'], array('ip-dst|port', 'ip-src|port')) ? ':' : '<br />';
        $value_pieces = explode('|', $object['value']);
        foreach ($value_pieces as $k => $v) {
            $value_pieces[$k] = h($v);
        }
        $object['value'] = implode($separator, $value_pieces);
        echo ($object['value']);
    } else if ('vulnerability' == $object['type']) {
        $cveUrl = (is_null(Configure::read('MISP.cveurl'))) ? ""http://www.google.com/search?q="" : Configure::read('MISP.cveurl');
        echo $this->Html->link($sigDisplay, $cveUrl . $sigDisplay, array('target' => '_blank', 'class' => $linkClass));
    } else if ('link' == $object['type'] && (substr($object['value'], 0, 7) === 'http://' || substr($object['value'], 0, 8) === 'https://')) {
        echo $this->Html->link($sigDisplay, $sigDisplay, array('class' => $linkClass));
    } else if ('cortex' == $object['type']) {
        echo '<div class=""cortex-json"" data-cortex-json=""' . h($object['value']) . '"">Cortex object</div>';
    } else if ('text' == $object['type']) {
        if (($object['category'] == 'Internal reference' || $object['category'] == 'External analysis') && preg_match('/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/i', $object['value'])) {
            echo '<a href=""' . $baseurl . '/events/view/' . h($object['value']) . '"" class=""' . $linkClass . '"">' . h($object['value']) . '</a>';
        } else {
            $sigDisplay = str_replace(""\r"", '', h($sigDisplay));
            $sigDisplay = str_replace("" "", '&nbsp;', $sigDisplay);
            echo $sigDisplay;
        }
    } else if ('hex' == $object['type']) {
        $sigDisplay = str_replace(""\r"", '', $sigDisplay);
        echo '<span class=""hex-value"" title=""' . __('Hexadecimal representation') . '"">' . h($sigDisplay) . '</span>&nbsp;<span role=""button"" tabindex=""0"" aria-label=""' . __('Switch to binary representation') . '"" class=""icon-repeat hex-value-convert useCursorPointer"" title=""' . __('Switch to binary representation') . '""></span>';
        $sigDisplay = str_replace(""\r"", '', $sigDisplay);
        echo h($sigDisplay);
    if (isset($object['validationIssue'])) {
        echo ' <span class=""fa fa-exclamation-triangle"" title=""' . __('Warning, this doesn\'t seem to be a legitimate ') . strtoupper(h($object['type'])) . __(' value') . '"">&nbsp;</span>';","  $sigDisplay = $object['value'];
  if ('attachment' == $object['type'] || 'malware-sample' == $object['type'] ) {
    if ($object['type'] == 'attachment' && isset($object['image'])) {
        if (extension_loaded('gd')) {
            $img = '<it class=""fa fa-spin fa-spinner"" style=""font-size: large; left: 50%; top: 50%;""></it>';
            $img .= '<img class=""screenshot screenshot-collapsed useCursorPointer img-rounded hidden"" src=""' . $baseurl . '/attributes/viewPicture/' . h($object['id']) . '/1' . '"" title=""' . h($object['value']) . '"" onload=""$(this).show(200); $(this).parent().find(\'.fa-spinner\').remove();""/>';
            echo $img;
            $extension = explode('.', $object['value']);
            $extension = end($extension);
            $uri = 'data:image/' . strtolower(h($extension)) . ';base64,' . h($object['image']);
            echo '<img class=""screenshot screenshot-collapsed useCursorPointer"" src=""' . $uri . '"" title=""' . h($object['value']) . '"" />';
      $filenameHash = explode('|', h($object['value']));
      if (strrpos($filenameHash[0], '\\')) {
        $filepath = substr($filenameHash[0], 0, strrpos($filenameHash[0], '\\'));
        $filename = substr($filenameHash[0], strrpos($filenameHash[0], '\\'));
        echo h($filepath);
        echo '<a href=""' . $baseurl . '/attributes/download/' . h($object['id']) . '"" class=""' . $linkClass . '"">' . h($filename) . '</a>';
      } else {
        echo '<a href=""' . $baseurl . '/attributes/download/' . h($object['id']) . '"" class=""' . $linkClass . '"">' . h($filenameHash[0]) . '</a>';
      }
      if (isset($filenameHash[1])) echo '<br />' . $filenameHash[1];
  } else if (strpos($object['type'], '|') !== false) {
    $separator = in_array($object['type'], array('ip-dst|port', 'ip-src|port')) ? ':' : '<br />';
    $value_pieces = explode('|', $object['value']);
    foreach ($value_pieces as $k => $v) {
      $value_pieces[$k] = h($v);
    }
    $object['value'] = implode($separator, $value_pieces);
    echo ($object['value']);
  } else if ('vulnerability' == $object['type']) {
    $cveUrl = (is_null(Configure::read('MISP.cveurl'))) ? ""http://www.google.com/search?q="" : Configure::read('MISP.cveurl');
    echo $this->Html->link($sigDisplay, $cveUrl . $sigDisplay, array('target' => '_blank', 'class' => $linkClass));
  } else if ('link' == $object['type']) {
    echo $this->Html->link($sigDisplay, $sigDisplay, array('class' => $linkClass));
  } else if ('cortex' == $object['type']) {
    echo '<div class=""cortex-json"" data-cortex-json=""' . h($object['value']) . '"">Cortex object</div>';
  } else if ('text' == $object['type']) {
    if (($object['category'] == 'Internal reference' || $object['category'] == 'External analysis') && preg_match('/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/i', $object['value'])) {
      echo '<a href=""' . $baseurl . '/events/view/' . h($object['value']) . '"" class=""' . $linkClass . '"">' . h($object['value']) . '</a>';
    } else {
      $sigDisplay = str_replace(""\r"", '', h($sigDisplay));
      $sigDisplay = str_replace("" "", '&nbsp;', $sigDisplay);
      echo $sigDisplay;
  } else if ('hex' == $object['type']) {
    $sigDisplay = str_replace(""\r"", '', $sigDisplay);
    echo '<span class=""hex-value"" title=""' . __('Hexadecimal representation') . '"">' . h($sigDisplay) . '</span>&nbsp;<span role=""button"" tabindex=""0"" aria-label=""' . __('Switch to binary representation') . '"" class=""icon-repeat hex-value-convert useCursorPointer"" title=""' . __('Switch to binary representation') . '""></span>';
  } else {
    $sigDisplay = str_replace(""\r"", '', $sigDisplay);
    echo h($sigDisplay);
  }
  if (isset($object['validationIssue'])) echo ' <span class=""fa fa-exclamation-triangle"" title=""' . __('Warning, this doesn\'t seem to be a legitimate ') . strtoupper(h($object['type'])) . __(' value') . '"">&nbsp;</span>';",6f6fb678ca07c80cb7d2bdfe5cb0313bb71bd487,CVE-2019-11813,6f6fb678ca07c80cb7d2bdfe5cb0313bb71bd487,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"$VAR = $VAR['VAR']; VAR ('VAR' == $VAR['VAR'] || 'VAR-VAR' == $VAR['VAR'] ) { VAR ($VAR['VAR'] == 'VAR' && VAR($VAR['VAR'])) { VAR (VAR('VAR')) { $VAR = '<VAR VAR=""VAR VAR-VAR VAR-VAR"" VAR=""VAR-VAR: VAR; VAR: 50%; VAR: 50%;""></VAR>'; $VAR .= '<VAR VAR=""VAR VAR-VAR VAR VAR-VAR VAR"" VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '/1' . '"" VAR=""' . VAR($VAR['VAR']) . '"" VAR=""$(VAR).VAR(200); $(VAR).VAR().VAR(\'.VAR-VAR\').VAR();""/>'; VAR $VAR; } VAR { $VAR = VAR('.', $VAR['VAR']); $VAR = VAR($VAR); $VAR = 'VAR:VAR/' . VAR(VAR($VAR)) . ';VAR,' . VAR($VAR['VAR']); VAR '<VAR VAR=""VAR VAR-VAR VAR"" VAR=""' . $VAR . '"" VAR=""' . VAR($VAR['VAR']) . '"" />'; } $VAR = VAR('|', VAR($VAR['VAR'])); VAR (VAR($VAR[0], '\\')) { $VAR = VAR($VAR[0], 0, VAR($VAR[0], '\\')); $VAR = VAR($VAR[0], VAR($VAR[0], '\\')); VAR VAR($VAR); VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR) . '</VAR>'; } VAR { VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR[0]) . '</VAR>'; } VAR (VAR($VAR[1])) VAR '<VAR />' . $VAR[1]; } VAR VAR (VAR($VAR['VAR'], '|') !== VAR) { $VAR = VAR($VAR['VAR'], VAR('VAR-VAR|VAR', 'VAR-VAR|VAR')) ? ':' : '<VAR />'; $VAR = VAR('|', $VAR['VAR']); VAR ($VAR VAR $VAR => $VAR) { $VAR[$VAR] = VAR($VAR); } $VAR['VAR'] = VAR($VAR, $VAR); VAR ($VAR['VAR']); } VAR VAR ('VAR' == $VAR['VAR']) { $VAR = (VAR(VAR::VAR('VAR.VAR'))) ? ""VAR: VAR $VAR->VAR->VAR($VAR, $VAR . $VAR, VAR('VAR' => 'VAR', 'VAR' => $VAR)); } VAR VAR ('VAR' == $VAR['VAR'] && (VAR($VAR['VAR'], 0, 7) === 'VAR: VAR $VAR->VAR->VAR($VAR, $VAR, VAR('VAR' => $VAR)); } VAR VAR ('VAR' == $VAR['VAR']) { VAR '<VAR VAR=""VAR-VAR"" VAR-VAR-VAR=""' . VAR($VAR['VAR']) . '"">VAR VAR</VAR>'; } VAR VAR ('VAR' == $VAR['VAR']) { VAR (($VAR['VAR'] == 'VAR VAR' || $VAR['VAR'] == 'VAR VAR') && VAR('/[VAR-VAR-9]{8}-[VAR-VAR-9]{4}-[VAR-VAR-9]{4}-[VAR-VAR-9]{4}-[VAR-VAR-9]{12}/VAR', $VAR['VAR'])) { VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR['VAR']) . '</VAR>'; } VAR { $VAR = VAR(""\VAR"", '', VAR($VAR)); $VAR = VAR("" "", '&VAR;', $VAR); VAR $VAR; } } VAR VAR ('VAR' == $VAR['VAR']) { $VAR = VAR(""\VAR"", '', $VAR); VAR '<VAR VAR=""VAR-VAR"" VAR=""' . VAR('VAR VAR') . '"">' . VAR($VAR) . '</VAR>&VAR;<VAR VAR=""VAR"" VAR=""0"" VAR-VAR=""' . VAR('VAR VAR VAR VAR') . '"" VAR=""VAR-VAR VAR-VAR-VAR VAR"" VAR=""' . VAR('VAR VAR VAR VAR') . '""></VAR>'; $VAR = VAR(""\VAR"", '', $VAR); VAR VAR($VAR); VAR (VAR($VAR['VAR'])) { VAR ' <VAR VAR=""VAR VAR-VAR-VAR"" VAR=""' . VAR('VAR, VAR VAR\'VAR VAR VAR VAR VAR VAR ') . VAR(VAR($VAR['VAR'])) . VAR(' VAR') . '"">&VAR;</VAR>'; $VAR = $VAR['VAR']; VAR ('VAR' == $VAR['VAR'] || 'VAR-VAR' == $VAR['VAR'] ) { VAR ($VAR['VAR'] == 'VAR' && VAR($VAR['VAR'])) { VAR (VAR('VAR')) { $VAR = '<VAR VAR=""VAR VAR-VAR VAR-VAR"" VAR=""VAR-VAR: VAR; VAR: 50%; VAR: 50%;""></VAR>'; $VAR .= '<VAR VAR=""VAR VAR-VAR VAR VAR-VAR VAR"" VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '/1' . '"" VAR=""' . VAR($VAR['VAR']) . '"" VAR=""$(VAR).VAR(200); $(VAR).VAR().VAR(\'.VAR-VAR\').VAR();""/>'; VAR $VAR; $VAR = VAR('.', $VAR['VAR']); $VAR = VAR($VAR); $VAR = 'VAR:VAR/' . VAR(VAR($VAR)) . ';VAR,' . VAR($VAR['VAR']); VAR '<VAR VAR=""VAR VAR-VAR VAR"" VAR=""' . $VAR . '"" VAR=""' . VAR($VAR['VAR']) . '"" />'; $VAR = VAR('|', VAR($VAR['VAR'])); VAR (VAR($VAR[0], '\\')) { $VAR = VAR($VAR[0], 0, VAR($VAR[0], '\\')); $VAR = VAR($VAR[0], VAR($VAR[0], '\\')); VAR VAR($VAR); VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR) . '</VAR>'; } VAR { VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR[0]) . '</VAR>'; } VAR (VAR($VAR[1])) VAR '<VAR />' . $VAR[1]; } VAR VAR (VAR($VAR['VAR'], '|') !== VAR) { $VAR = VAR($VAR['VAR'], VAR('VAR-VAR|VAR', 'VAR-VAR|VAR')) ? ':' : '<VAR />'; $VAR = VAR('|', $VAR['VAR']); VAR ($VAR VAR $VAR => $VAR) { $VAR[$VAR] = VAR($VAR); } $VAR['VAR'] = VAR($VAR, $VAR); VAR ($VAR['VAR']); } VAR VAR ('VAR' == $VAR['VAR']) { $VAR = (VAR(VAR::VAR('VAR.VAR'))) ? ""VAR: VAR $VAR->VAR->VAR($VAR, $VAR . $VAR, VAR('VAR' => 'VAR', 'VAR' => $VAR)); } VAR VAR ('VAR' == $VAR['VAR']) { VAR $VAR->VAR->VAR($VAR, $VAR, VAR('VAR' => $VAR)); } VAR VAR ('VAR' == $VAR['VAR']) { VAR '<VAR VAR=""VAR-VAR"" VAR-VAR-VAR=""' . VAR($VAR['VAR']) . '"">VAR VAR</VAR>'; } VAR VAR ('VAR' == $VAR['VAR']) { VAR (($VAR['VAR'] == 'VAR VAR' || $VAR['VAR'] == 'VAR VAR') && VAR('/[VAR-VAR-9]{8}-[VAR-VAR-9]{4}-[VAR-VAR-9]{4}-[VAR-VAR-9]{4}-[VAR-VAR-9]{12}/VAR', $VAR['VAR'])) { VAR '<VAR VAR=""' . $VAR . '/VAR/VAR/' . VAR($VAR['VAR']) . '"" VAR=""' . $VAR . '"">' . VAR($VAR['VAR']) . '</VAR>'; } VAR { $VAR = VAR(""\VAR"", '', VAR($VAR)); $VAR = VAR("" "", '&VAR;', $VAR); VAR $VAR; } VAR VAR ('VAR' == $VAR['VAR']) { $VAR = VAR(""\VAR"", '', $VAR); VAR '<VAR VAR=""VAR-VAR"" VAR=""' . VAR('VAR VAR') . '"">' . VAR($VAR) . '</VAR>&VAR;<VAR VAR=""VAR"" VAR=""0"" VAR-VAR=""' . VAR('VAR VAR VAR VAR') . '"" VAR=""VAR-VAR VAR-VAR-VAR VAR"" VAR=""' . VAR('VAR VAR VAR VAR') . '""></VAR>'; } VAR { $VAR = VAR(""\VAR"", '', $VAR); VAR VAR($VAR); } VAR (VAR($VAR['VAR'])) VAR ' <VAR VAR=""VAR VAR-VAR-VAR"" VAR=""' . VAR('VAR, VAR VAR\'VAR VAR VAR VAR VAR VAR ') . VAR(VAR($VAR['VAR'])) . VAR(' VAR') . '"">&VAR;</VAR>';",8,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Controller/UsersController.php,"                    $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
            if ($this->request->is('post') || $this->request->is('put')) {",            if ($this->request->is('post')) {,934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8891,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; VAR ($VAR->VAR->VAR('VAR') || $VAR->VAR->VAR('VAR')) { VAR ($VAR->VAR->VAR('VAR')) {,0,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Controller/UsersController.php,"                    $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
            if ($this->request->is('post') || $this->request->is('put')) {",            if ($this->request->is('post')) {,934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8892,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; VAR ($VAR->VAR->VAR('VAR') || $VAR->VAR->VAR('VAR')) { VAR ($VAR->VAR->VAR('VAR')) {,0,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Controller/UsersController.php,"                    $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
            if ($this->request->is('post') || $this->request->is('put')) {",            if ($this->request->is('post')) {,934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8890,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; VAR ($VAR->VAR->VAR('VAR') || $VAR->VAR->VAR('VAR')) { VAR ($VAR->VAR->VAR('VAR')) {,0,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Model/Bruteforce.php,"        $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
        $amount = Configure::check('SecureAuth.amount') ? Configure::read('SecureAuth.amount') : 5;
        $expire = time() + $expire;
            'username' => trim(strtolower($username)),
            $title .= 'This has tripped the bruteforce protection after  ' . $amount . ' failed attempts. The user is now blacklisted for ' . $expire . ' seconds.';
        $expire = date('Y-m-d H:i:s', time());
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= ""' . $expire . '"";';
            $sql = 'DELETE FROM bruteforces WHERE expire <= ""' . $expire . '"";';","        $expire = time() + Configure::read('SecureAuth.expire');
            'username' => $username,
            $title .= 'This has tripped the bruteforce protection after  ' . Configure::read('SecureAuth.amount') . ' failed attempts. The user is now blacklisted for ' . Configure::read('SecureAuth.expire') . ' seconds.';
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= NOW();';
            $sql = 'DELETE FROM bruteforces WHERE expire <= NOW();';",934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8891,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; $VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 5; $VAR = VAR() + $VAR; 'VAR' => VAR(VAR($VAR)), $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR.'; $VAR = VAR('VAR-VAR-VAR VAR:VAR:VAR', VAR()); $VAR = 'VAR VAR VAR VAR `VAR` <= ""' . $VAR . '"";'; $VAR = 'VAR VAR VAR VAR VAR <= ""' . $VAR . '"";'; $VAR = VAR() + VAR::VAR('VAR.VAR'); 'VAR' => $VAR, $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR.'; $VAR = 'VAR VAR VAR VAR `VAR` <= VAR();'; $VAR = 'VAR VAR VAR VAR VAR <= VAR();';",0,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Model/Bruteforce.php,"        $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
        $amount = Configure::check('SecureAuth.amount') ? Configure::read('SecureAuth.amount') : 5;
        $expire = time() + $expire;
            'username' => trim(strtolower($username)),
            $title .= 'This has tripped the bruteforce protection after  ' . $amount . ' failed attempts. The user is now blacklisted for ' . $expire . ' seconds.';
        $expire = date('Y-m-d H:i:s', time());
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= ""' . $expire . '"";';
            $sql = 'DELETE FROM bruteforces WHERE expire <= ""' . $expire . '"";';","        $expire = time() + Configure::read('SecureAuth.expire');
            'username' => $username,
            $title .= 'This has tripped the bruteforce protection after  ' . Configure::read('SecureAuth.amount') . ' failed attempts. The user is now blacklisted for ' . Configure::read('SecureAuth.expire') . ' seconds.';
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= NOW();';
            $sql = 'DELETE FROM bruteforces WHERE expire <= NOW();';",934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8892,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; $VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 5; $VAR = VAR() + $VAR; 'VAR' => VAR(VAR($VAR)), $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR.'; $VAR = VAR('VAR-VAR-VAR VAR:VAR:VAR', VAR()); $VAR = 'VAR VAR VAR VAR `VAR` <= ""' . $VAR . '"";'; $VAR = 'VAR VAR VAR VAR VAR <= ""' . $VAR . '"";'; $VAR = VAR() + VAR::VAR('VAR.VAR'); 'VAR' => $VAR, $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR.'; $VAR = 'VAR VAR VAR VAR `VAR` <= VAR();'; $VAR = 'VAR VAR VAR VAR VAR <= VAR();';",0,3
MISP_934c82819237b4edf1da64587b72a87bec5dd520,app/Model/Bruteforce.php,"        $expire = Configure::check('SecureAuth.expire') ? Configure::read('SecureAuth.expire') : 300;
        $amount = Configure::check('SecureAuth.amount') ? Configure::read('SecureAuth.amount') : 5;
        $expire = time() + $expire;
            'username' => trim(strtolower($username)),
            $title .= 'This has tripped the bruteforce protection after  ' . $amount . ' failed attempts. The user is now blacklisted for ' . $expire . ' seconds.';
        $expire = date('Y-m-d H:i:s', time());
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= ""' . $expire . '"";';
            $sql = 'DELETE FROM bruteforces WHERE expire <= ""' . $expire . '"";';","        $expire = time() + Configure::read('SecureAuth.expire');
            'username' => $username,
            $title .= 'This has tripped the bruteforce protection after  ' . Configure::read('SecureAuth.amount') . ' failed attempts. The user is now blacklisted for ' . Configure::read('SecureAuth.expire') . ' seconds.';
            $sql = 'DELETE FROM bruteforces WHERE `expire` <= NOW();';
            $sql = 'DELETE FROM bruteforces WHERE expire <= NOW();';",934c82819237b4edf1da64587b72a87bec5dd520,CVE-2020-8890,934c82819237b4edf1da64587b72a87bec5dd520,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"$VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 300; $VAR = VAR::VAR('VAR.VAR') ? VAR::VAR('VAR.VAR') : 5; $VAR = VAR() + $VAR; 'VAR' => VAR(VAR($VAR)), $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . $VAR . ' VAR.'; $VAR = VAR('VAR-VAR-VAR VAR:VAR:VAR', VAR()); $VAR = 'VAR VAR VAR VAR `VAR` <= ""' . $VAR . '"";'; $VAR = 'VAR VAR VAR VAR VAR <= ""' . $VAR . '"";'; $VAR = VAR() + VAR::VAR('VAR.VAR'); 'VAR' => $VAR, $VAR .= 'VAR VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR VAR. VAR VAR VAR VAR VAR VAR ' . VAR::VAR('VAR.VAR') . ' VAR.'; $VAR = 'VAR VAR VAR VAR `VAR` <= VAR();'; $VAR = 'VAR VAR VAR VAR VAR <= VAR();';",0,3
moodle_ea106d2a1dbc633a22f12a119763b2af5f33542b,admin/tool/monitor/tests/subscription_test.php,"<?php
// This file is part of Moodle - http://moodle.org/
//
// Moodle is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Moodle is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
defined('MOODLE_INTERNAL') || exit();

/**
 * Unit tests for the subscription class.
 * @since 3.2.0
 *
 * @package    tool_monitor
 * @category   test
 * @copyright  2016 Jake Dallimore <jrhdallimore@gmail.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
class tool_monitor_subscription_testcase extends advanced_testcase {

    /**
     * @var \tool_monitor\subscription $subscription object.
     */
    private $subscription;

    /**
     * Test set up.
     */
    public function setUp() {
        $this->resetAfterTest(true);

        // Create the mock subscription.
        $sub = new stdClass();
        $sub->id = 100;
        $sub->name = 'My test rule';
        $sub->courseid = 20;
        $this->subscription = $this->getMock('\tool_monitor\subscription',null, array($sub));
    }

    /**
     * Test for the magic __isset method.
     */
    public function test_magic_isset() {
        $this->assertEquals(true, isset($this->subscription->name));
        $this->assertEquals(true, isset($this->subscription->courseid));
        $this->assertEquals(false, isset($this->subscription->ruleid));
    }

    /**
     * Test for the magic __get method.
     */
    public function test_magic_get() {
        $this->assertEquals(20, $this->subscription->courseid);
        $this->setExpectedException('coding_exception');
        $this->subscription->ruleid;
    }
}",,ea106d2a1dbc633a22f12a119763b2af5f33542b,CVE-2016-5014,ea106d2a1dbc633a22f12a119763b2af5f33542b,https://github.com/moodle/moodle,GHSD_DIRECT_COMMIT,1337,COMPLETED,"<?VAR               VAR('VAR') || VAR(); /** * VAR VAR VAR VAR VAR VAR. * @VAR 3.2.0 * * @VAR VAR * @VAR VAR * @VAR 2016 VAR VAR <VAR@VAR.VAR> * @VAR VAR: */ VAR VAR VAR VAR { /** * @VAR \VAR\VAR $VAR VAR. */ VAR $VAR; /** * VAR VAR VAR. */ VAR VAR VAR() { $VAR->VAR(VAR);  $VAR = VAR VAR(); $VAR->VAR = 100; $VAR->VAR = 'VAR VAR VAR'; $VAR->VAR = 20; $VAR->VAR = $VAR->VAR('\VAR\VAR',VAR, VAR($VAR)); } /** * VAR VAR VAR VAR VAR VAR. */ VAR VAR VAR() { $VAR->VAR(VAR, VAR($VAR->VAR->VAR)); $VAR->VAR(VAR, VAR($VAR->VAR->VAR)); $VAR->VAR(VAR, VAR($VAR->VAR->VAR)); } /** * VAR VAR VAR VAR VAR VAR. */ VAR VAR VAR() { $VAR->VAR(20, $VAR->VAR->VAR); $VAR->VAR('VAR'); $VAR->VAR->VAR; } } ",7,3
nautobot_54abe23331b6c3d0d82bf1b028c679b1d200920d,nautobot/core/views/utils.py,"from django.utils.html import format_html, format_html_join
                    field_info[""format""] = mark_safe(""<code>true</code> or <code>false</code>"")  # noqa: S308
                    field_info[""format""] = mark_safe(""<code>YYYY-MM-DD</code>"")  # noqa: S308
                    field_info[""format""] = mark_safe('<code>""value,value""</code>')  # noqa: S308
            field_info[""format""] = mark_safe(""<code>true</code> or <code>false</code>"")  # noqa: S308
            field_info[""format""] = mark_safe(""<code>YYYY-MM-DD</code>"")  # noqa: S308
            field_info[""format""] = mark_safe(  # noqa: S308
                field_info[""format""] = mark_safe('<code>""name,name""</code> or <code>""UUID,UUID""</code>')  # noqa: S308
                field_info[""format""] = mark_safe('<code>""app_label.model,app_label.model""</code>')  # noqa: S308
                field_info[""format""] = mark_safe('<code>""UUID,UUID""</code>')  # noqa: S308
                field_info[""format""] = mark_safe(""<code>app_label.model</code>"")  # noqa: S308
                field_info[""format""] = mark_safe(""<code>UUID</code>"")  # noqa: S308
            field_info[""format""] = mark_safe('<code>""value,value""</code>')  # noqa: S308
    err_message = format_html(
        ""Unable to delete <strong>{}</strong>. {} dependent objects were found: "",
        "", "".join(str(obj) for obj in obj_list),
        protected_count,
    err_message += format_html_join(
        "", "",
        '<a href=""{}"">{}</a>',
        ((dependent.get_absolute_url(), dependent) for dependent in protected_objects[:50]),
    )
    messages.error(request, err_message)","from django.utils.html import escape
                    field_info[""format""] = mark_safe(""<code>true</code> or <code>false</code>"")
                    field_info[""format""] = mark_safe(""<code>YYYY-MM-DD</code>"")
                    field_info[""format""] = mark_safe('<code>""value,value""</code>')
            field_info[""format""] = mark_safe(""<code>true</code> or <code>false</code>"")
            field_info[""format""] = mark_safe(""<code>YYYY-MM-DD</code>"")
            field_info[""format""] = mark_safe(
                field_info[""format""] = mark_safe('<code>""name,name""</code> or <code>""UUID,UUID""</code>')
                field_info[""format""] = mark_safe('<code>""app_label.model,app_label.model""</code>')
                field_info[""format""] = mark_safe('<code>""UUID,UUID""</code>')
                field_info[""format""] = mark_safe(""<code>app_label.model</code>"")
                field_info[""format""] = mark_safe(""<code>UUID</code>"")
            field_info[""format""] = mark_safe('<code>""value,value""</code>')
    err_message = (
        f""Unable to delete <strong>{', '.join(str(obj) for obj in obj_list)}</strong>. ""
        f""{protected_count} dependent objects were found: ""
    dependent_objects = []
    for dependent in protected_objects[:50]:
        if hasattr(dependent, ""get_absolute_url""):
            dependent_objects.append(f'<a href=""{dependent.get_absolute_url()}"">{escape(dependent)}</a>')
        else:
            dependent_objects.append(str(dependent))
    err_message += "", "".join(dependent_objects)
    messages.error(request, mark_safe(err_message))",54abe23331b6c3d0d82bf1b028c679b1d200920d,CVE-2023-48705,54abe23331b6c3d0d82bf1b028c679b1d200920d,https://github.com/nautobot/nautobot,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR.VAR.VAR VAR VAR, VAR VAR[""VAR""] = VAR(""<VAR>VAR</VAR> VAR <VAR>VAR</VAR>"")  VAR[""VAR""] = VAR(""<VAR>VAR-VAR-VAR</VAR>"")  VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>')  VAR[""VAR""] = VAR(""<VAR>VAR</VAR> VAR <VAR>VAR</VAR>"")  VAR[""VAR""] = VAR(""<VAR>VAR-VAR-VAR</VAR>"")  VAR[""VAR""] = VAR(  VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR> VAR <VAR>""VAR,VAR""</VAR>')  VAR[""VAR""] = VAR('<VAR>""VAR.VAR,VAR.VAR""</VAR>')  VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>')  VAR[""VAR""] = VAR(""<VAR>VAR.VAR</VAR>"")  VAR[""VAR""] = VAR(""<VAR>VAR</VAR>"")  VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>')  VAR = VAR( ""VAR VAR VAR <VAR>{}</VAR>. {} VAR VAR VAR VAR: "", "", "".VAR(VAR(VAR) VAR VAR VAR VAR), VAR, VAR += VAR( "", "", '<VAR VAR=""{}"">{}</VAR>', ((VAR.VAR(), VAR) VAR VAR VAR VAR[:50]), ) VAR.VAR(VAR, VAR) VAR VAR.VAR.VAR VAR VAR VAR[""VAR""] = VAR(""<VAR>VAR</VAR> VAR <VAR>VAR</VAR>"") VAR[""VAR""] = VAR(""<VAR>VAR-VAR-VAR</VAR>"") VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>') VAR[""VAR""] = VAR(""<VAR>VAR</VAR> VAR <VAR>VAR</VAR>"") VAR[""VAR""] = VAR(""<VAR>VAR-VAR-VAR</VAR>"") VAR[""VAR""] = VAR( VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR> VAR <VAR>""VAR,VAR""</VAR>') VAR[""VAR""] = VAR('<VAR>""VAR.VAR,VAR.VAR""</VAR>') VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>') VAR[""VAR""] = VAR(""<VAR>VAR.VAR</VAR>"") VAR[""VAR""] = VAR(""<VAR>VAR</VAR>"") VAR[""VAR""] = VAR('<VAR>""VAR,VAR""</VAR>') VAR = ( VAR""VAR VAR VAR <VAR>{', '.VAR(VAR(VAR) VAR VAR VAR VAR)}</VAR>. "" VAR""{VAR} VAR VAR VAR VAR: "" VAR = [] VAR VAR VAR VAR[:50]: VAR VAR(VAR, ""VAR""): VAR.VAR(VAR'<VAR VAR=""{VAR.VAR()}"">{VAR(VAR)}</VAR>') VAR: VAR.VAR(VAR(VAR)) VAR += "", "".VAR(VAR) VAR.VAR(VAR, VAR(VAR))",0,3
openssl_a0af4a3c8b18c435a5a4afb28b3ad1a2730e6ea8,test/punycode_test.c,"/*
 * Copyright 2022 The OpenSSL Project Authors. All Rights Reserved.
 *
 * Licensed under the Apache License 2.0 (the ""License"").  You may not use
 * this file except in compliance with the License.  You can obtain a copy
 * in the file LICENSE in the source distribution or at
 * https://www.openssl.org/source/license.html
 */

#include <openssl/crypto.h>
#include <string.h>

#include ""crypto/punycode.h""
#include ""internal/nelem.h""
#include ""testutil.h""


static const struct puny_test {
    unsigned int raw[50];
    const char *encoded;
} puny_cases[] = {
    /* Test cases from RFC 3492 */
    {   /* Arabic (Egyptian) */
        { 0x0644, 0x064A, 0x0647, 0x0645, 0x0627, 0x0628, 0x062A, 0x0643, 0x0644,
          0x0645, 0x0648, 0x0634, 0x0639, 0x0631, 0x0628, 0x064A, 0x061F
        },
        ""egbpdaj6bu4bxfgehfvwxn""
    },
    {   /* Chinese (simplified) */
        { 0x4ED6, 0x4EEC, 0x4E3A, 0x4EC0, 0x4E48, 0x4E0D, 0x8BF4, 0x4E2D, 0x6587
        },
        ""ihqwcrb4cv8a8dqg056pqjye""
    },
    {   /* Chinese (traditional) */
        { 0x4ED6, 0x5011, 0x7232, 0x4EC0, 0x9EBD, 0x4E0D, 0x8AAA, 0x4E2D, 0x6587
        },
        ""ihqwctvzc91f659drss3x8bo0yb""
    },
    {    /* Czech: Pro<ccaron>prost<ecaron>nemluv<iacute><ccaron>esky */
        { 0x0050, 0x0072, 0x006F, 0x010D, 0x0070, 0x0072, 0x006F, 0x0073, 0x0074,
          0x011B, 0x006E, 0x0065, 0x006D, 0x006C, 0x0075, 0x0076, 0x00ED, 0x010D,
          0x0065, 0x0073, 0x006B, 0x0079
       },
        ""Proprostnemluvesky-uyb24dma41a""
    },
    {   /* Hebrew */
        { 0x05DC, 0x05DE, 0x05D4, 0x05D4, 0x05DD, 0x05E4, 0x05E9, 0x05D5, 0x05D8,
          0x05DC, 0x05D0, 0x05DE, 0x05D3, 0x05D1, 0x05E8, 0x05D9, 0x05DD, 0x05E2,
          0x05D1, 0x05E8, 0x05D9, 0x05EA
        },
        ""4dbcagdahymbxekheh6e0a7fei0b""
    },
    {   /* Hindi (Devanagari) */
        { 0x092F, 0x0939, 0x0932, 0x094B, 0x0917, 0x0939, 0x093F, 0x0928, 0x094D,
          0x0926, 0x0940, 0x0915, 0x094D, 0x092F, 0x094B, 0x0902, 0x0928, 0x0939,
          0x0940, 0x0902, 0x092C, 0x094B, 0x0932, 0x0938, 0x0915, 0x0924, 0x0947,
          0x0939, 0x0948, 0x0902
        },
        ""i1baa7eci9glrd9b2ae1bj0hfcgg6iyaf8o0a1dig0cd""
    },
    {   /* Japanese (kanji and hiragana) */
        { 0x306A, 0x305C, 0x307F, 0x3093, 0x306A, 0x65E5, 0x672C, 0x8A9E, 0x3092,
          0x8A71, 0x3057, 0x3066, 0x304F, 0x308C, 0x306A, 0x3044, 0x306E, 0x304B
        },
        ""n8jok5ay5dzabd5bym9f0cm5685rrjetr6pdxa""
    },
    {   /* Korean (Hangul syllables) */
        { 0xC138, 0xACC4, 0xC758, 0xBAA8, 0xB4E0, 0xC0AC, 0xB78C, 0xB4E4, 0xC774,
          0xD55C, 0xAD6D, 0xC5B4, 0xB97C, 0xC774, 0xD574, 0xD55C, 0xB2E4, 0xBA74,
          0xC5BC, 0xB9C8, 0xB098, 0xC88B, 0xC744, 0xAE4C
        },
        ""989aomsvi5e83db1d2a355cv1e0vak1dwrv93d5xbh15a0dt30a5jpsd879ccm6fea98c""
    },
    {   /* Russian (Cyrillic) */
        { 0x043F, 0x043E, 0x0447, 0x0435, 0x043C, 0x0443, 0x0436, 0x0435, 0x043E,
          0x043D, 0x0438, 0x043D, 0x0435, 0x0433, 0x043E, 0x0432, 0x043E, 0x0440,
          0x044F, 0x0442, 0x043F, 0x043E, 0x0440, 0x0443, 0x0441, 0x0441, 0x043A,
          0x0438
        },
        ""b1abfaaepdrnnbgefbaDotcwatmq2g4l""
    },
    {   /* Spanish */
        { 0x0050, 0x006F, 0x0072, 0x0071, 0x0075, 0x00E9, 0x006E, 0x006F, 0x0070,
          0x0075, 0x0065, 0x0064, 0x0065, 0x006E, 0x0073, 0x0069, 0x006D, 0x0070,
          0x006C, 0x0065, 0x006D, 0x0065, 0x006E, 0x0074, 0x0065, 0x0068, 0x0061,
          0x0062, 0x006C, 0x0061, 0x0072, 0x0065, 0x006E, 0x0045, 0x0073, 0x0070,
          0x0061, 0x00F1, 0x006F, 0x006C
        },
        ""PorqunopuedensimplementehablarenEspaol-fmd56a""
    },
    {   /* Vietnamese */
        { 0x0054, 0x1EA1, 0x0069, 0x0073, 0x0061, 0x006F, 0x0068, 0x1ECD, 0x006B,
          0x0068, 0x00F4, 0x006E, 0x0067, 0x0074, 0x0068, 0x1EC3, 0x0063, 0x0068,
          0x1EC9, 0x006E, 0x00F3, 0x0069, 0x0074, 0x0069, 0x1EBF, 0x006E, 0x0067,
          0x0056, 0x0069, 0x1EC7, 0x0074
        },
        ""TisaohkhngthchnitingVit-kjcr8268qyxafd2f1b9g""
    },
    {   /* Japanese: 3<nen>B<gumi><kinpachi><sensei> */
        { 0x0033, 0x5E74, 0x0042, 0x7D44, 0x91D1, 0x516B, 0x5148, 0x751F
        },
        ""3B-ww4c5e180e575a65lsy2b""
    },
    {   /* Japanese: <amuro><namie>-with-SUPER-MONKEYS */
        { 0x5B89, 0x5BA4, 0x5948, 0x7F8E, 0x6075, 0x002D, 0x0077, 0x0069, 0x0074,
          0x0068, 0x002D, 0x0053, 0x0055, 0x0050, 0x0045, 0x0052, 0x002D, 0x004D,
          0x004F, 0x004E, 0x004B, 0x0045, 0x0059, 0x0053
        },
        ""-with-SUPER-MONKEYS-pc58ag80a8qai00g7n9n""
    },
    {   /* Japanese: Hello-Another-Way-<sorezore><no><basho> */
        { 0x0048, 0x0065, 0x006C, 0x006C, 0x006F, 0x002D, 0x0041, 0x006E, 0x006F,
          0x0074, 0x0068, 0x0065, 0x0072, 0x002D, 0x0057, 0x0061, 0x0079, 0x002D,
          0x305D, 0x308C, 0x305E, 0x308C, 0x306E, 0x5834, 0x6240
        },
        ""Hello-Another-Way--fc4qua05auwb3674vfr0b""
    },
    {   /* Japanese: <hitotsu><yane><no><shita>2 */
        { 0x3072, 0x3068, 0x3064, 0x5C4B, 0x6839, 0x306E, 0x4E0B, 0x0032
        },
        ""2-u9tlzr9756bt3uc0v""
    },
    {   /* Japanese: Maji<de>Koi<suru>5<byou><mae> */
        { 0x004D, 0x0061, 0x006A, 0x0069, 0x3067, 0x004B, 0x006F, 0x0069, 0x3059,
          0x308B, 0x0035, 0x79D2, 0x524D
        },
        ""MajiKoi5-783gue6qz075azm5e""
    },
    {   /* Japanese: <pafii>de<runba> */
        { 0x30D1, 0x30D5, 0x30A3, 0x30FC, 0x0064, 0x0065, 0x30EB, 0x30F3, 0x30D0
        },
        ""de-jg4avhby1noc0d""
    },
    {   /* Japanese: <sono><supiido><de> */
        { 0x305D, 0x306E, 0x30B9, 0x30D4, 0x30FC, 0x30C9, 0x3067
        },
        ""d9juau41awczczp""
    },
    {   /* -> $1.00 <- */
        { 0x002D, 0x003E, 0x0020, 0x0024, 0x0031, 0x002E, 0x0030, 0x0030, 0x0020,
          0x003C, 0x002D
        },
        ""-> $1.00 <--""
    }
};

static int test_punycode(int n)
{
    const struct puny_test *tc = puny_cases + n;
    unsigned int buffer[50];
    unsigned int bsize = OSSL_NELEM(buffer);
    size_t i;

    if (!TEST_true(ossl_punycode_decode(tc->encoded, strlen(tc->encoded),
                                        buffer, &bsize)))
        return 0;
    for (i = 0; i < sizeof(tc->raw); i++)
        if (tc->raw[i] == 0)
            break;
    if (!TEST_mem_eq(buffer, bsize * sizeof(*buffer),
                     tc->raw, i * sizeof(*tc->raw)))
        return 0;
    return 1;
}

static int test_a2ulabel(void)
{
    char out[50];
    size_t outlen;

    /*
     * Test that no buffer correctly returns the true length.
     * The punycode being passed in and parsed is malformed but we're not
     * verifying that behaviour here.
     */
    if (!TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", NULL, &outlen), 0)
            || !TEST_size_t_eq(outlen, 7)
            || !TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", out, &outlen), 1))
        return 0;
    /* Test that a short input length returns the true length */
    outlen = 1;
    if (!TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", out, &outlen), 0)
            || !TEST_size_t_eq(outlen, 7)
            || !TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", out, &outlen), 1)
            || !TEST_str_eq(out,""\xc2\x80.b.c""))
        return 0;
    /* Test for an off by one on the buffer size works */
    outlen = 6;
    if (!TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", out, &outlen), 0)
            || !TEST_size_t_eq(outlen, 7)
            || !TEST_int_eq(ossl_a2ulabel(""xn--a.b.c"", out, &outlen), 1)
            || !TEST_str_eq(out,""\xc2\x80.b.c""))
        return 0;
    return 1;
}

static int test_puny_overrun(void)
{
    static const unsigned int out[] = {
        0x0033, 0x5E74, 0x0042, 0x7D44, 0x91D1, 0x516B, 0x5148, 0x751F
    };
    static const char *in = ""3B-ww4c5e180e575a65lsy2b"";
    unsigned int buf[OSSL_NELEM(out)];
    unsigned int bsize = OSSL_NELEM(buf) - 1;

    if (!TEST_false(ossl_punycode_decode(in, strlen(in), buf, &bsize))) {
        if (TEST_mem_eq(buf, bsize * sizeof(*buf), out, sizeof(out)))
            TEST_error(""CRITICAL: buffer overrun detected!"");
        return 0;
    }
    return 1;
}

int setup_tests(void)
{
    ADD_ALL_TESTS(test_punycode, OSSL_NELEM(puny_cases));
    ADD_TEST(test_a2ulabel);
    ADD_TEST(test_puny_overrun);
    return 1;
}",,a0af4a3c8b18c435a5a4afb28b3ad1a2730e6ea8,CVE-2022-3602,a0af4a3c8b18c435a5a4afb28b3ad1a2730e6ea8,https://github.com/openssl/openssl,CPE_GIT_REPOBASED,82,COMPLETED,"/* * VAR 2022 VAR VAR VAR VAR. VAR VAR VAR. * * VAR VAR VAR VAR VAR 2.0 (VAR ""VAR""). VAR VAR VAR VAR * VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR: */      VAR VAR VAR VAR { VAR VAR VAR[50]; VAR VAR *VAR; } VAR[] = {  {  { 0x0644, 0x064A, 0x0647, 0x0645, 0x0627, 0x0628, 0x062A, 0x0643, 0x0644, 0x0645, 0x0648, 0x0634, 0x0639, 0x0631, 0x0628, 0x064A, 0x061F }, ""VAR"" }, {  { 0x4ED6, 0x4EEC, 0x4E3A, 0x4EC0, 0x4E48, 0x4E0D, 0x8BF4, 0x4E2D, 0x6587 }, ""VAR"" }, {  { 0x4ED6, 0x5011, 0x7232, 0x4EC0, 0x9EBD, 0x4E0D, 0x8AAA, 0x4E2D, 0x6587 }, ""VAR"" }, {  { 0x0050, 0x0072, 0x006F, 0x010D, 0x0070, 0x0072, 0x006F, 0x0073, 0x0074, 0x011B, 0x006E, 0x0065, 0x006D, 0x006C, 0x0075, 0x0076, 0x00ED, 0x010D, 0x0065, 0x0073, 0x006B, 0x0079 }, ""VAR-VAR"" }, {  { 0x05DC, 0x05DE, 0x05D4, 0x05D4, 0x05DD, 0x05E4, 0x05E9, 0x05D5, 0x05D8, 0x05DC, 0x05D0, 0x05DE, 0x05D3, 0x05D1, 0x05E8, 0x05D9, 0x05DD, 0x05E2, 0x05D1, 0x05E8, 0x05D9, 0x05EA }, ""4dbcagdahymbxekheh6e0a7fei0b"" }, {  { 0x092F, 0x0939, 0x0932, 0x094B, 0x0917, 0x0939, 0x093F, 0x0928, 0x094D, 0x0926, 0x0940, 0x0915, 0x094D, 0x092F, 0x094B, 0x0902, 0x0928, 0x0939, 0x0940, 0x0902, 0x092C, 0x094B, 0x0932, 0x0938, 0x0915, 0x0924, 0x0947, 0x0939, 0x0948, 0x0902 }, ""VAR"" }, {  { 0x306A, 0x305C, 0x307F, 0x3093, 0x306A, 0x65E5, 0x672C, 0x8A9E, 0x3092, 0x8A71, 0x3057, 0x3066, 0x304F, 0x308C, 0x306A, 0x3044, 0x306E, 0x304B }, ""VAR"" }, {  { 0xC138, 0xACC4, 0xC758, 0xBAA8, 0xB4E0, 0xC0AC, 0xB78C, 0xB4E4, 0xC774, 0xD55C, 0xAD6D, 0xC5B4, 0xB97C, 0xC774, 0xD574, 0xD55C, 0xB2E4, 0xBA74, 0xC5BC, 0xB9C8, 0xB098, 0xC88B, 0xC744, 0xAE4C }, ""989aomsvi5e83db1d2a355cv1e0vak1dwrv93d5xbh15a0dt30a5jpsd879ccm6fea98c"" }, {  { 0x043F, 0x043E, 0x0447, 0x0435, 0x043C, 0x0443, 0x0436, 0x0435, 0x043E, 0x043D, 0x0438, 0x043D, 0x0435, 0x0433, 0x043E, 0x0432, 0x043E, 0x0440, 0x044F, 0x0442, 0x043F, 0x043E, 0x0440, 0x0443, 0x0441, 0x0441, 0x043A, 0x0438 }, ""VAR"" }, {  { 0x0050, 0x006F, 0x0072, 0x0071, 0x0075, 0x00E9, 0x006E, 0x006F, 0x0070, 0x0075, 0x0065, 0x0064, 0x0065, 0x006E, 0x0073, 0x0069, 0x006D, 0x0070, 0x006C, 0x0065, 0x006D, 0x0065, 0x006E, 0x0074, 0x0065, 0x0068, 0x0061, 0x0062, 0x006C, 0x0061, 0x0072, 0x0065, 0x006E, 0x0045, 0x0073, 0x0070, 0x0061, 0x00F1, 0x006F, 0x006C }, ""VAR-VAR"" }, {  { 0x0054, 0x1EA1, 0x0069, 0x0073, 0x0061, 0x006F, 0x0068, 0x1ECD, 0x006B, 0x0068, 0x00F4, 0x006E, 0x0067, 0x0074, 0x0068, 0x1EC3, 0x0063, 0x0068, 0x1EC9, 0x006E, 0x00F3, 0x0069, 0x0074, 0x0069, 0x1EBF, 0x006E, 0x0067, 0x0056, 0x0069, 0x1EC7, 0x0074 }, ""VAR-VAR"" }, {  { 0x0033, 0x5E74, 0x0042, 0x7D44, 0x91D1, 0x516B, 0x5148, 0x751F }, ""3B-VAR"" }, {  { 0x5B89, 0x5BA4, 0x5948, 0x7F8E, 0x6075, 0x002D, 0x0077, 0x0069, 0x0074, 0x0068, 0x002D, 0x0053, 0x0055, 0x0050, 0x0045, 0x0052, 0x002D, 0x004D, 0x004F, 0x004E, 0x004B, 0x0045, 0x0059, 0x0053 }, ""-VAR-VAR-VAR-VAR"" }, {  { 0x0048, 0x0065, 0x006C, 0x006C, 0x006F, 0x002D, 0x0041, 0x006E, 0x006F, 0x0074, 0x0068, 0x0065, 0x0072, 0x002D, 0x0057, 0x0061, 0x0079, 0x002D, 0x305D, 0x308C, 0x305E, 0x308C, 0x306E, 0x5834, 0x6240 }, ""VAR-VAR-VAR--VAR"" }, {  { 0x3072, 0x3068, 0x3064, 0x5C4B, 0x6839, 0x306E, 0x4E0B, 0x0032 }, ""2-VAR"" }, {  { 0x004D, 0x0061, 0x006A, 0x0069, 0x3067, 0x004B, 0x006F, 0x0069, 0x3059, 0x308B, 0x0035, 0x79D2, 0x524D }, ""VAR-783gue6qz075azm5e"" }, {  { 0x30D1, 0x30D5, 0x30A3, 0x30FC, 0x0064, 0x0065, 0x30EB, 0x30F3, 0x30D0 }, ""VAR-VAR"" }, {  { 0x305D, 0x306E, 0x30B9, 0x30D4, 0x30FC, 0x30C9, 0x3067 }, ""VAR"" }, {  { 0x002D, 0x003E, 0x0020, 0x0024, 0x0031, 0x002E, 0x0030, 0x0030, 0x0020, 0x003C, 0x002D }, ""-> $1.00 <--"" } }; VAR VAR VAR(VAR VAR) { VAR VAR VAR *VAR = VAR + VAR; VAR VAR VAR[50]; VAR VAR VAR = VAR(VAR); VAR VAR; VAR (!VAR(VAR(VAR->VAR, VAR(VAR->VAR), VAR, &VAR))) VAR 0; VAR (VAR = 0; VAR < VAR(VAR->VAR); VAR++) VAR (VAR->VAR[VAR] == 0) VAR; VAR (!VAR(VAR, VAR * VAR(*VAR), VAR->VAR, VAR * VAR(*VAR->VAR))) VAR 0; VAR 1; } VAR VAR VAR(VAR) { VAR VAR[50]; VAR VAR; /* * VAR VAR VAR VAR VAR VAR VAR VAR VAR. * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR * VAR VAR VAR VAR. */ VAR (!VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 0) || !VAR(VAR, 7) || !VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 1)) VAR 0;  VAR = 1; VAR (!VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 0) || !VAR(VAR, 7) || !VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 1) || !VAR(VAR,""\VAR\VAR.VAR.VAR"")) VAR 0;  VAR = 6; VAR (!VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 0) || !VAR(VAR, 7) || !VAR(VAR(""VAR--VAR.VAR.VAR"", VAR, &VAR), 1) || !VAR(VAR,""\VAR\VAR.VAR.VAR"")) VAR 0; VAR 1; } VAR VAR VAR(VAR) { VAR VAR VAR VAR VAR[] = { 0x0033, 0x5E74, 0x0042, 0x7D44, 0x91D1, 0x516B, 0x5148, 0x751F }; VAR VAR VAR *VAR = ""3B-VAR""; VAR VAR VAR[VAR(VAR)]; VAR VAR VAR = VAR(VAR) - 1; VAR (!VAR(VAR(VAR, VAR(VAR), VAR, &VAR))) { VAR (VAR(VAR, VAR * VAR(*VAR), VAR, VAR(VAR))) VAR(""VAR: VAR VAR VAR!""); VAR 0; } VAR 1; } VAR VAR(VAR) { VAR(VAR, VAR(VAR)); VAR(VAR); VAR(VAR); VAR 1; } ",0,3
roundcubemail_a71bf2e8d4a64ff2c83fdabc1e8cb0c045a41ef4,tests/Framework/Washtml.php,"     * Test cases for SVG tests
    function data_wash_svg_tests()
        $svg1 = ""<svg id='x' width='100' height='100'><a xlink:href='javascript:alert(1)'><rect x='0' y='0' width='100' height='100' /></a></svg>"";

        return [
            [
                '<head xmlns=""&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;""><svg></svg></head>',
                '<!-- html ignored --><!-- head ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<head xmlns=""&quot; onload=&quot;alert(document.domain)"">Hello victim!<svg></svg></head>',
                '<!-- html ignored --><!-- head ignored -->Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>',
                '<p>Hello victim!<svg /></p>'
            ],
            [
                '<html><p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>',
                '<!-- html ignored --><!-- body ignored --><p>Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg></p>'
            ],
            [
                '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />',
                '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />'
            ],
            [
                '<html><svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<svg><a xlink:href=""javascript:alert(1)""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><a x-washed=""xlink:href""><text x=""20"" y=""20"">XSS</text></a></svg>'
            ],
            [
                '<html><svg><a xlink:href=""javascript:alert(1)""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""><a x-washed=""xlink:href""><text x=""20"" y=""20"">XSS</text></a></svg>'
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributeName=""href"" values=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<html><svg><animate xlink:href=""#xss"" attributeName=""href"" values=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml"">'
                    . '<!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributeName=""href"" from=""javascript:alert(1)"" to=""1"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><set xlink:href=""#xss"" attributeName=""href"" from=""?"" to=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- set blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributename=""href"" dur=""5s"" repeatCount=""indefinite"" keytimes=""0;0;1"" values=""https://portswigger.net?;javascript:alert(1);0"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                ""<svg><use href=\""data:image/svg+xml,&lt;svg id='x' xmlns='http://www.w3.org/2000/svg' ""
                    . ""xmlns:xlink='http://www.w3.org/1999/xlink' width='100' height='100'&gt;&lt;a xlink:href='javascript:alert(1)'&gt;""
                    . ""&lt;rect x='0' y='0' width='100' height='100' /&gt;&lt;/a&gt;&lt;/svg&gt;\""></use></svg>"",
                ""<svg><use href=\""data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53""
                    . ""My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBpZD0ie""
                    . ""CIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdC""
                    . ""B4PSIwIiB5PSIwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgLz48L2E+PC9zdmc+\"" /></svg>""
            ],
            [
                ""<svg><use href=\""data:image/svg+xml;base64,"" . base64_encode($svg1) . ""\""></use></svg>"",
                ""<svg><use href=\""data:image/svg+xml;base64,PHN2ZyBpZD0ieCIgd2lkdGg9IjEwMCIgaGVpZ2h""
                    . ""0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0""
                    . ""iMTAwIiBoZWlnaHQ9IjEwMCIgLz48L2E+PC9zdmc+\"" /></svg>""
            ],
            [
                '<svg><script href=""data:text/javascript,alert(1)"" /><text x=""20"" y=""20"">XSS</text></svg>',
                '<svg><!-- script not allowed --><text x=""20"" y=""20"">XSS</text></svg>'
            ],
        ];
    }
    /**
     * Test SVG cleanup
     *
     * @dataProvider data_wash_svg_tests
     */
    function test_wash_svg_tests($input, $expected)
    {
        $washed = $washer->wash($input);
        $this->assertSame($expected, $washed, ""SVG content"");
    }
    /**
     * Test cases for various XSS issues
     */
    function data_wash_xss_tests()
    {
        return [
            [
                '<html><base href=""javascript:/a/-alert(1)///////""><a href=""../lol/safari.html"">test</a>',
                '<!-- html ignored --><body><!-- base ignored --><a x-washed=""href"">test</a></body>'
            ],
            [
                '<html><math><x href=""javascript:alert(1)"">blah</x>',
                '<!-- html ignored --><body><math><!-- x ignored -->blah</math></body>'
            ],
            [
                '<html><a href=""j&#x61vascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><a href=""&#x6a avascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><a href=""&#x6a avascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><body background=""javascript:alert(1)"">',
                '<!-- html ignored --><body x-washed=""background""></body>'
            ],
            [
                '<html><math href=""javascript:alert(location);""><mi>clickme</mi></math>',
                '<!-- html ignored --><body><math x-washed=""href""><mi>clickme</mi></math></body>',
            ],
            [
                '<html><math><mstyle href=""javascript:alert(location);""><mi>clickme</mi></mstyle></math>',
                '<!-- html ignored --><body><math><mstyle x-washed=""href""><mi>clickme</mi></mstyle></math></body>',
            ],
            [
                '<html><math><msubsup href=""javascript:alert(location);""><mi>clickme</mi></msubsup></math>',
                '<!-- html ignored --><body><math><msubsup x-washed=""href""><mi>clickme</mi></msubsup></math></body>',
            ],
            [
                '<html><math><ms HREF=""javascript:alert(location);"">clickme</ms></math>',
                '<!-- html ignored --><body><math><ms x-washed=""href"">clickme</ms></math></body>',
            ],
        ];
    }
    /**
     * Test various XSS issues
     *
     * @dataProvider data_wash_xss_tests
     */
    function test_wash_xss_tests($input, $expected)
    {
        $washer = new rcube_washtml(['allow_remote' => true, 'html_elements' => ['body']]);
        $washed = $washer->wash($input);
        $this->assertSame($expected, $washed, ""XSS issues"");","     * Test SVG cleanup
    function test_wash_svg2()
        $svg = '<head xmlns=""&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;""><svg></svg></head>';
        $exp = '<!-- html ignored --><!-- head ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>';

        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);

        $this->assertSame($washed, $exp, ""SVG content"");

        $svg = '<head xmlns=""&quot; onload=&quot;alert(document.domain)"">Hello victim!<svg></svg></head>';
        $exp = '<!-- html ignored --><!-- head ignored -->Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg>';

        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);

        $this->assertSame($washed, $exp, ""SVG content"");

        $svg = '<p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>';
        $exp = '<p>Hello victim!<svg /></p>';
        $washed = $washer->wash($svg);
        $this->assertSame($washed, $exp, ""SVG content"");
        $svg = '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />';
        $exp = '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />';
        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);
        $this->assertSame($washed, $exp, ""SVG content"");",a71bf2e8d4a64ff2c83fdabc1e8cb0c045a41ef4,CVE-2020-16145,a71bf2e8d4a64ff2c83fdabc1e8cb0c045a41ef4,https://github.com/roundcube/roundcubemail,NVD_DIRECT_COMMIT,1337,COMPLETED,"* VAR VAR VAR VAR VAR VAR VAR() $VAR = ""<VAR VAR='VAR' VAR='100' VAR='100'><VAR VAR:VAR='VAR:VAR(1)'><VAR VAR='0' VAR='0' VAR='100' VAR='100' /></VAR></VAR>""; VAR [ [ '<VAR VAR=""&VAR;&VAR;&VAR;VAR&VAR;VAR(VAR.VAR)&VAR;/VAR&VAR;""><VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"">VAR VAR!<VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR -->VAR VAR!<VAR VAR=""VAR: ], [ '<VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>', '<VAR>VAR VAR!<VAR /></VAR>' ], [ '<VAR><VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR>VAR VAR!<VAR VAR=""VAR: ], [ '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />', '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />' ], [ '<VAR><VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR><VAR VAR:VAR=""VAR:VAR(1)""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><VAR VAR-VAR=""VAR:VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>' ], [ '<VAR><VAR><VAR VAR:VAR=""VAR:VAR(1)""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: . '<!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR,&VAR;VAR VAR='VAR' VAR='VAR: . ""VAR:VAR='VAR: . ""&VAR;VAR VAR='0' VAR='0' VAR='100' VAR='100' /&VAR;&VAR;/VAR&VAR;&VAR;/VAR&VAR;\""></VAR></VAR>"", ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,VAR"" . ""VAR"" . ""VAR"" . ""VAR+VAR+\"" /></VAR>"" ], [ ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,"" . VAR($VAR) . ""\""></VAR></VAR>"", ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,VAR"" . ""0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0"" . ""VAR+VAR+\"" /></VAR>"" ], [ '<VAR><VAR VAR=""VAR:VAR/VAR,VAR(1)"" /><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR>', '<VAR><!-- VAR VAR VAR --><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR>' ], ]; } /** * VAR VAR VAR * * @VAR VAR */ VAR VAR($VAR, $VAR) { $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); } /** * VAR VAR VAR VAR VAR VAR */ VAR VAR() { VAR [ [ '<VAR><VAR VAR=""VAR:/VAR/-VAR(1) '<!-- VAR VAR --><VAR><!-- VAR VAR --><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(1)"">VAR</VAR>', '<!-- VAR VAR --><VAR><VAR><!-- VAR VAR -->VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""VAR& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""VAR:VAR(1)"">', '<!-- VAR VAR --><VAR VAR-VAR=""VAR""></VAR>' ], [ '<VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR>', '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);"">VAR</VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR></VAR>', ], ]; } /** * VAR VAR VAR VAR * * @VAR VAR */ VAR VAR($VAR, $VAR) { $VAR = VAR VAR(['VAR' => VAR, 'VAR' => ['VAR']]); $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); * VAR VAR VAR VAR VAR() $VAR = '<VAR VAR=""&VAR;&VAR;&VAR;VAR&VAR;VAR(VAR.VAR)&VAR;/VAR&VAR;""><VAR></VAR></VAR>'; $VAR = '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"">VAR VAR!<VAR></VAR></VAR>'; $VAR = '<!-- VAR VAR --><!-- VAR VAR -->VAR VAR!<VAR VAR=""VAR: $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>'; $VAR = '<VAR>VAR VAR!<VAR /></VAR>'; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />'; $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />'; $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR"");",7,3
roundcubemail_d44ca2308a96576b88d6bf27528964d4fe1a6b8b,tests/Framework/Washtml.php,"     * Test cases for SVG tests
    function data_wash_svg_tests()
        $svg1 = ""<svg id='x' width='100' height='100'><a xlink:href='javascript:alert(1)'><rect x='0' y='0' width='100' height='100' /></a></svg>"";

        return [
            [
                '<head xmlns=""&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;""><svg></svg></head>',
                '<!-- html ignored --><!-- head ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<head xmlns=""&quot; onload=&quot;alert(document.domain)"">Hello victim!<svg></svg></head>',
                '<!-- html ignored --><!-- head ignored -->Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>',
                '<p>Hello victim!<svg /></p>'
            ],
            [
                '<html><p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>',
                '<!-- html ignored --><!-- body ignored --><p>Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg></p>'
            ],
            [
                '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />',
                '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />'
            ],
            [
                '<html><svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>'
            ],
            [
                '<svg><a xlink:href=""javascript:alert(1)""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><a x-washed=""xlink:href""><text x=""20"" y=""20"">XSS</text></a></svg>'
            ],
            [
                '<html><svg><a xlink:href=""javascript:alert(1)""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""><a x-washed=""xlink:href""><text x=""20"" y=""20"">XSS</text></a></svg>'
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributeName=""href"" values=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<html><svg><animate xlink:href=""#xss"" attributeName=""href"" values=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<!-- html ignored --><!-- body ignored --><svg xmlns=""http://www.w3.org/1999/xhtml"">'
                    . '<!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributeName=""href"" from=""javascript:alert(1)"" to=""1"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><set xlink:href=""#xss"" attributeName=""href"" from=""?"" to=""javascript:alert(1)"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- set blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                '<svg><animate xlink:href=""#xss"" attributename=""href"" dur=""5s"" repeatCount=""indefinite"" keytimes=""0;0;1"" values=""https://portswigger.net?;javascript:alert(1);0"" />'
                    . '<a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
                '<svg><!-- animate blocked --><a id=""xss""><text x=""20"" y=""20"">XSS</text></a></svg>',
            ],
            [
                ""<svg><use href=\""data:image/svg+xml,&lt;svg id='x' xmlns='http://www.w3.org/2000/svg' ""
                    . ""xmlns:xlink='http://www.w3.org/1999/xlink' width='100' height='100'&gt;&lt;a xlink:href='javascript:alert(1)'&gt;""
                    . ""&lt;rect x='0' y='0' width='100' height='100' /&gt;&lt;/a&gt;&lt;/svg&gt;\""></use></svg>"",
                ""<svg><use href=\""data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53""
                    . ""My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBpZD0ie""
                    . ""CIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdC""
                    . ""B4PSIwIiB5PSIwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgLz48L2E+PC9zdmc+\"" /></svg>""
            ],
            [
                ""<svg><use href=\""data:image/svg+xml;base64,"" . base64_encode($svg1) . ""\""></use></svg>"",
                ""<svg><use href=\""data:image/svg+xml;base64,PHN2ZyBpZD0ieCIgd2lkdGg9IjEwMCIgaGVpZ2h""
                    . ""0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0""
                    . ""iMTAwIiBoZWlnaHQ9IjEwMCIgLz48L2E+PC9zdmc+\"" /></svg>""
            ],
            [
                '<svg><script href=""data:text/javascript,alert(1)"" /><text x=""20"" y=""20"">XSS</text></svg>',
                '<svg><!-- script not allowed --><text x=""20"" y=""20"">XSS</text></svg>'
            ],
        ];
    }
    /**
     * Test SVG cleanup
     *
     * @dataProvider data_wash_svg_tests
     */
    function test_wash_svg_tests($input, $expected)
    {
        $washed = $washer->wash($input);
        $this->assertSame($expected, $washed, ""SVG content"");
    }
    /**
     * Test cases for various XSS issues
     */
    function data_wash_xss_tests()
    {
        return [
            [
                '<html><base href=""javascript:/a/-alert(1)///////""><a href=""../lol/safari.html"">test</a>',
                '<!-- html ignored --><body><!-- base ignored --><a x-washed=""href"">test</a></body>'
            ],
            [
                '<html><math><x href=""javascript:alert(1)"">blah</x>',
                '<!-- html ignored --><body><math><!-- x ignored -->blah</math></body>'
            ],
            [
                '<html><a href=""j&#x61vascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><a href=""&#x6a avascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><a href=""&#x6a avascript:alert(1)"">XSS</a>',
                '<!-- html ignored --><body><a x-washed=""href"">XSS</a></body>'
            ],
            [
                '<html><body background=""javascript:alert(1)"">',
                '<!-- html ignored --><body x-washed=""background""></body>'
            ],
            [
                '<html><math href=""javascript:alert(location);""><mi>clickme</mi></math>',
                '<!-- html ignored --><body><math x-washed=""href""><mi>clickme</mi></math></body>',
            ],
            [
                '<html><math><mstyle href=""javascript:alert(location);""><mi>clickme</mi></mstyle></math>',
                '<!-- html ignored --><body><math><mstyle x-washed=""href""><mi>clickme</mi></mstyle></math></body>',
            ],
            [
                '<html><math><msubsup href=""javascript:alert(location);""><mi>clickme</mi></msubsup></math>',
                '<!-- html ignored --><body><math><msubsup x-washed=""href""><mi>clickme</mi></msubsup></math></body>',
            ],
            [
                '<html><math><ms HREF=""javascript:alert(location);"">clickme</ms></math>',
                '<!-- html ignored --><body><math><ms x-washed=""href"">clickme</ms></math></body>',
            ],
        ];
    }
    /**
     * Test various XSS issues
     *
     * @dataProvider data_wash_xss_tests
     */
    function test_wash_xss_tests($input, $expected)
    {
        $washer = new rcube_washtml(['allow_remote' => true, 'html_elements' => ['body']]);
        $washed = $washer->wash($input);
        $this->assertSame($expected, $washed, ""XSS issues"");","     * Test SVG cleanup
    function test_wash_svg2()
        $svg = '<head xmlns=""&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;""><svg></svg></head>';
        $exp = '<!-- html ignored --><!-- head ignored --><svg xmlns=""http://www.w3.org/1999/xhtml""></svg>';

        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);

        $this->assertSame($washed, $exp, ""SVG content"");

        $svg = '<head xmlns=""&quot; onload=&quot;alert(document.domain)"">Hello victim!<svg></svg></head>';
        $exp = '<!-- html ignored --><!-- head ignored -->Hello victim!<svg xmlns=""http://www.w3.org/1999/xhtml""></svg>';

        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);

        $this->assertSame($washed, $exp, ""SVG content"");

        $svg = '<p>Hello victim!<svg xmlns=""&quot; onload=&quot;alert(document.domain)""></svg></p>';
        $exp = '<p>Hello victim!<svg /></p>';
        $washed = $washer->wash($svg);
        $this->assertSame($washed, $exp, ""SVG content"");
        $svg = '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />';
        $exp = '<svg xmlns=""&quot; onload=&quot;alert(document.domain)"" />';
        $washer = new rcube_washtml;
        $washed = $washer->wash($svg);
        $this->assertSame($washed, $exp, ""SVG content"");",d44ca2308a96576b88d6bf27528964d4fe1a6b8b,CVE-2020-16145,d44ca2308a96576b88d6bf27528964d4fe1a6b8b,https://github.com/roundcube/roundcubemail,NVD_DIRECT_COMMIT,1337,COMPLETED,"* VAR VAR VAR VAR VAR VAR VAR() $VAR = ""<VAR VAR='VAR' VAR='100' VAR='100'><VAR VAR:VAR='VAR:VAR(1)'><VAR VAR='0' VAR='0' VAR='100' VAR='100' /></VAR></VAR>""; VAR [ [ '<VAR VAR=""&VAR;&VAR;&VAR;VAR&VAR;VAR(VAR.VAR)&VAR;/VAR&VAR;""><VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"">VAR VAR!<VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR -->VAR VAR!<VAR VAR=""VAR: ], [ '<VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>', '<VAR>VAR VAR!<VAR /></VAR>' ], [ '<VAR><VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR>VAR VAR!<VAR VAR=""VAR: ], [ '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />', '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />' ], [ '<VAR><VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR><VAR VAR:VAR=""VAR:VAR(1)""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><VAR VAR-VAR=""VAR:VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>' ], [ '<VAR><VAR><VAR VAR:VAR=""VAR:VAR(1)""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: . '<!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR VAR:VAR="" . '<VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', '<VAR><!-- VAR VAR --><VAR VAR=""VAR""><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR></VAR>', ], [ ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR,&VAR;VAR VAR='VAR' VAR='VAR: . ""VAR:VAR='VAR: . ""&VAR;VAR VAR='0' VAR='0' VAR='100' VAR='100' /&VAR;&VAR;/VAR&VAR;&VAR;/VAR&VAR;\""></VAR></VAR>"", ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,VAR"" . ""VAR"" . ""VAR"" . ""VAR+VAR+\"" /></VAR>"" ], [ ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,"" . VAR($VAR) . ""\""></VAR></VAR>"", ""<VAR><VAR VAR=\""VAR:VAR/VAR+VAR;VAR,VAR"" . ""0PSIxMDAiPjxhIHgtd2FzaGVkPSJ4bGluazpocmVmIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0"" . ""VAR+VAR+\"" /></VAR>"" ], [ '<VAR><VAR VAR=""VAR:VAR/VAR,VAR(1)"" /><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR>', '<VAR><!-- VAR VAR VAR --><VAR VAR=""20"" VAR=""20"">VAR</VAR></VAR>' ], ]; } /** * VAR VAR VAR * * @VAR VAR */ VAR VAR($VAR, $VAR) { $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); } /** * VAR VAR VAR VAR VAR VAR */ VAR VAR() { VAR [ [ '<VAR><VAR VAR=""VAR:/VAR/-VAR(1) '<!-- VAR VAR --><VAR><!-- VAR VAR --><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(1)"">VAR</VAR>', '<!-- VAR VAR --><VAR><VAR><!-- VAR VAR -->VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""VAR& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""& '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR>' ], [ '<VAR><VAR VAR=""VAR:VAR(1)"">', '<!-- VAR VAR --><VAR VAR-VAR=""VAR""></VAR>' ], [ '<VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR>', '<!-- VAR VAR --><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);""><VAR>VAR</VAR></VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR""><VAR>VAR</VAR></VAR></VAR></VAR>', ], [ '<VAR><VAR><VAR VAR=""VAR:VAR(VAR);"">VAR</VAR></VAR>', '<!-- VAR VAR --><VAR><VAR><VAR VAR-VAR=""VAR"">VAR</VAR></VAR></VAR>', ], ]; } /** * VAR VAR VAR VAR * * @VAR VAR */ VAR VAR($VAR, $VAR) { $VAR = VAR VAR(['VAR' => VAR, 'VAR' => ['VAR']]); $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); * VAR VAR VAR VAR VAR() $VAR = '<VAR VAR=""&VAR;&VAR;&VAR;VAR&VAR;VAR(VAR.VAR)&VAR;/VAR&VAR;""><VAR></VAR></VAR>'; $VAR = '<!-- VAR VAR --><!-- VAR VAR --><VAR VAR=""VAR: $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"">VAR VAR!<VAR></VAR></VAR>'; $VAR = '<!-- VAR VAR --><!-- VAR VAR -->VAR VAR!<VAR VAR=""VAR: $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR>VAR VAR!<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)""></VAR></VAR>'; $VAR = '<VAR>VAR VAR!<VAR /></VAR>'; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR""); $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />'; $VAR = '<VAR VAR=""&VAR; VAR=&VAR;VAR(VAR.VAR)"" />'; $VAR = VAR VAR; $VAR = $VAR->VAR($VAR); $VAR->VAR($VAR, $VAR, ""VAR VAR"");",7,3
server_704eb3aa6cecc0a646f5cca4290b595f493f9ed3,core/Controller/LostController.php,"	 * @BruteForceProtection(action=passwordResetEmail)
	 * @AnonRateThrottle(limit=10, period=300)
				$response = new TemplateResponse(
				$response->throttle();
				return $response;",				return new TemplateResponse(,704eb3aa6cecc0a646f5cca4290b595f493f9ed3,CVE-2023-25818,704eb3aa6cecc0a646f5cca4290b595f493f9ed3,https://github.com/nextcloud/server,NVD_GIT_REPOBASED,70,COMPLETED,"* @VAR(VAR=VAR) * @VAR(VAR=10, VAR=300) $VAR = VAR VAR( $VAR->VAR(); VAR $VAR; VAR VAR VAR(",4,3
server_704eb3aa6cecc0a646f5cca4290b595f493f9ed3,core/Controller/LostController.php,"	 * @BruteForceProtection(action=passwordResetEmail)
	 * @AnonRateThrottle(limit=10, period=300)
				$response = new TemplateResponse(
				$response->throttle();
				return $response;",				return new TemplateResponse(,704eb3aa6cecc0a646f5cca4290b595f493f9ed3,CVE-2023-25820,704eb3aa6cecc0a646f5cca4290b595f493f9ed3,https://github.com/nextcloud/server,NVD_GIT_REPOBASED,78,COMPLETED,"* @VAR(VAR=VAR) * @VAR(VAR=10, VAR=300) $VAR = VAR VAR( $VAR->VAR(); VAR $VAR; VAR VAR VAR(",4,3
server_7ee81b65557c84c764a9014a0442c9915c82a9a8,core/Controller/LostController.php,"
	 * @BruteForceProtection(action=passwordResetEmail)
	 * @AnonRateThrottle(limit=10, period=300)
	public function setPassword(string $token, string $userId, string $password, bool $proceed): JSONResponse {
					return new JSONResponse($this->error('', ['encryption' => true]));
			$response = new JSONResponse($this->error($e->getHint()));
			$response->throttle();
			return $response;
			$response = new JSONResponse($this->error($e->getMessage()));
			$response->throttle();
			return $response;
		return new JSONResponse($this->success(['user' => $userId]));","
	public function setPassword(string $token, string $userId, string $password, bool $proceed): array {
					return $this->error('', ['encryption' => true]);
			return $this->error($e->getHint());
			return $this->error($e->getMessage());
		return $this->success(['user' => $userId]);",7ee81b65557c84c764a9014a0442c9915c82a9a8,CVE-2023-35172,7ee81b65557c84c764a9014a0442c9915c82a9a8,https://github.com/nextcloud/server,NVD_GIT_REPOBASED,70,COMPLETED,"* @VAR(VAR=VAR) * @VAR(VAR=10, VAR=300) VAR VAR VAR(VAR $VAR, VAR $VAR, VAR $VAR, VAR $VAR): VAR { VAR VAR VAR($VAR->VAR('', ['VAR' => VAR])); $VAR = VAR VAR($VAR->VAR($VAR->VAR())); $VAR->VAR(); VAR $VAR; $VAR = VAR VAR($VAR->VAR($VAR->VAR())); $VAR->VAR(); VAR $VAR; VAR VAR VAR($VAR->VAR(['VAR' => $VAR])); VAR VAR VAR(VAR $VAR, VAR $VAR, VAR $VAR, VAR $VAR): VAR { VAR $VAR->VAR('', ['VAR' => VAR]); VAR $VAR->VAR($VAR->VAR()); VAR $VAR->VAR($VAR->VAR()); VAR $VAR->VAR(['VAR' => $VAR]);",4,3
trafficserver_de7c8a78edd5b75e311561dfaa133e9d71ea8a5e,plugins/s3_auth/aws_auth_v4.cc,"    } else if (i == '+') {
      /* Only written in the example code, but a plus sign is treated as a space regardless of the position and it must be encoded
       * as ""%20"" instead of ""%2B"" */
      result << ""%20"";",,de7c8a78edd5b75e311561dfaa133e9d71ea8a5e,CVE-2023-41752,de7c8a78edd5b75e311561dfaa133e9d71ea8a5e,https://github.com/apache/trafficserver,CPE_GIT_REPOBASED,66,COMPLETED,"} VAR VAR (VAR == '+') { /* VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR ""%20"" VAR VAR ""%2B"" */ VAR << ""%20""; ",7,3
urllib3_0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,src/urllib3/util/timeout.py,"from __future__ import absolute_import
# The default socket timeout, used by httplib to indicate that no timeout was
# specified by the user
from socket import _GLOBAL_DEFAULT_TIMEOUT
import time

from ..exceptions import TimeoutStateError

# A sentinel value to indicate that no timeout was specified by the user in
# urllib3
_Default = object()


# Use time.monotonic if available.
current_time = getattr(time, ""monotonic"", time.time)


class Timeout(object):
    """""" Timeout configuration.

    Timeouts can be defined as a default for a pool::

        timeout = Timeout(connect=2.0, read=7.0)
        http = PoolManager(timeout=timeout)
        response = http.request('GET', 'http://example.com/')

    Or per-request (which overrides the default for the pool)::

        response = http.request('GET', 'http://example.com/', timeout=Timeout(10))

    Timeouts can be disabled by setting all the parameters to ``None``::

        no_timeout = Timeout(connect=None, read=None)
        response = http.request('GET', 'http://example.com/, timeout=no_timeout)


    :param total:
        This combines the connect and read timeouts into one; the read timeout
        will be set to the time leftover from the connect attempt. In the
        event that both a connect timeout and a total are specified, or a read
        timeout and a total are specified, the shorter timeout will be applied.

        Defaults to None.

    :type total: integer, float, or None

    :param connect:
        The maximum amount of time to wait for a connection attempt to a server
        to succeed. Omitting the parameter will default the connect timeout to
        the system default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout for connection attempts.

    :type connect: integer, float, or None

    :param read:
        The maximum amount of time to wait between consecutive
        read operations for a response from the server. Omitting
        the parameter will default the read timeout to the system
        default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout.

    :type read: integer, float, or None

    .. note::

        Many factors can affect the total amount of time for urllib3 to return
        an HTTP response.

        For example, Python's DNS resolver does not obey the timeout specified
        on the socket. Other factors that can affect total request time include
        high CPU load, high swap, the program running at a low priority level,
        or other behaviors.

        In addition, the read and total timeouts only measure the time between
        read operations on the socket connecting the client and the server,
        not the total amount of time for the request to return a complete
        response. For most requests, the timeout is raised because the server
        has not sent the first byte in the specified time. This is not always
        the case; if a server streams one byte every fifteen seconds, a timeout
        of 20 seconds will not trigger, even though the request will take
        several minutes to complete.

        If your goal is to cut off any request after a set amount of wall clock
        time, consider having a second ""watcher"" thread to cut off a slow
        request.
    """"""

    #: A sentinel object representing the default timeout value
    DEFAULT_TIMEOUT = _GLOBAL_DEFAULT_TIMEOUT

    def __init__(self, total=None, connect=_Default, read=_Default):
        self._connect = self._validate_timeout(connect, 'connect')
        self._read = self._validate_timeout(read, 'read')
        self.total = self._validate_timeout(total, 'total')
        self._start_connect = None

    def __str__(self):
        return '%s(connect=%r, read=%r, total=%r)' % (
            type(self).__name__, self._connect, self._read, self.total)

    @classmethod
    def _validate_timeout(cls, value, name):
        """""" Check that a timeout attribute is valid.

        :param value: The timeout value to validate
        :param name: The name of the timeout attribute to validate. This is
            used to specify in error messages.
        :return: The validated and casted version of the given value.
        :raises ValueError: If it is a numeric value less than or equal to
            zero, or the type is not an integer, float, or None.
        """"""
        if value is _Default:
            return cls.DEFAULT_TIMEOUT

        if value is None or value is cls.DEFAULT_TIMEOUT:
            return value

        if isinstance(value, bool):
            raise ValueError(""Timeout cannot be a boolean value. It must ""
                             ""be an int, float or None."")
        try:
            float(value)
        except (TypeError, ValueError):
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        try:
            if value <= 0:
                raise ValueError(""Attempted to set %s timeout to %s, but the ""
                                 ""timeout cannot be set to a value less ""
                                 ""than or equal to 0."" % (name, value))
        except TypeError:  # Python 3
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        return value

    @classmethod
    def from_float(cls, timeout):
        """""" Create a new Timeout from a legacy timeout value.

        The timeout value used by httplib.py sets the same timeout on the
        connect(), and recv() socket requests. This creates a :class:`Timeout`
        object that sets the individual timeouts to the ``timeout`` value
        passed to this function.

        :param timeout: The legacy timeout value.
        :type timeout: integer, float, sentinel default object, or None
        :return: Timeout object
        :rtype: :class:`Timeout`
        """"""
        return Timeout(read=timeout, connect=timeout)

    def clone(self):
        """""" Create a copy of the timeout object

        Timeout properties are stored per-pool but each request needs a fresh
        Timeout object to ensure each one has its own start/stop configured.

        :return: a copy of the timeout object
        :rtype: :class:`Timeout`
        """"""
        # We can't use copy.deepcopy because that will also create a new object
        # for _GLOBAL_DEFAULT_TIMEOUT, which socket.py uses as a sentinel to
        # detect the user default.
        return Timeout(connect=self._connect, read=self._read,
                       total=self.total)

    def start_connect(self):
        """""" Start the timeout clock, used during a connect() attempt

        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to start a timer that has been started already.
        """"""
        if self._start_connect is not None:
            raise TimeoutStateError(""Timeout timer has already been started."")
        self._start_connect = current_time()
        return self._start_connect

    def get_connect_duration(self):
        """""" Gets the time elapsed since the call to :meth:`start_connect`.

        :return: Elapsed time.
        :rtype: float
        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to get duration for a timer that hasn't been started.
        """"""
        if self._start_connect is None:
            raise TimeoutStateError(""Can't get connect duration for timer ""
                                    ""that has not started."")
        return current_time() - self._start_connect

    @property
    def connect_timeout(self):
        """""" Get the value to use when setting a connection timeout.

        This will be a positive float or integer, the value None
        (never timeout), or the default system timeout.

        :return: Connect timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        """"""
        if self.total is None:
            return self._connect

        if self._connect is None or self._connect is self.DEFAULT_TIMEOUT:
            return self.total

        return min(self._connect, self.total)

    @property
    def read_timeout(self):
        """""" Get the value for the read timeout.

        This assumes some time has elapsed in the connection timeout and
        computes the read timeout appropriately.

        If self.total is set, the read timeout is dependent on the amount of
        time taken by the connect timeout. If the connection time has not been
        established, a :exc:`~urllib3.exceptions.TimeoutStateError` will be
        raised.

        :return: Value to use for the read timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        :raises urllib3.exceptions.TimeoutStateError: If :meth:`start_connect`
            has not yet been called on this object.
        """"""
        if (self.total is not None and
                self.total is not self.DEFAULT_TIMEOUT and
                self._read is not None and
                self._read is not self.DEFAULT_TIMEOUT):
            # In case the connect timeout has not yet been established.
            if self._start_connect is None:
                return self._read
            return max(0, min(self.total - self.get_connect_duration(),
                              self._read))
        elif self.total is not None and self.total is not self.DEFAULT_TIMEOUT:
            return max(0, self.total - self.get_connect_duration())
        else:
            return self._read",,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,CVE-2019-11236,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,98,COMPLETED,"VAR VAR VAR VAR   VAR VAR VAR VAR VAR VAR VAR ..VAR VAR VAR   VAR = VAR()  VAR = VAR(VAR, ""VAR"", VAR.VAR) VAR VAR(VAR): """""" VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:: VAR = VAR(VAR=2.0, VAR=7.0) VAR = VAR(VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: VAR VAR-VAR (VAR VAR VAR VAR VAR VAR VAR):: VAR = VAR.VAR('VAR', 'VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR``:: VAR = VAR(VAR=VAR, VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR .. VAR:: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR 20 VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR. """"""  VAR = VAR VAR VAR(VAR, VAR=VAR, VAR=VAR, VAR=VAR): VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR VAR VAR(VAR): VAR '%VAR(VAR=%VAR, VAR=%VAR, VAR=%VAR)' % ( VAR(VAR).VAR, VAR.VAR, VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR, VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR. """""" VAR VAR VAR VAR: VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR: VAR VAR VAR VAR(VAR, VAR): VAR VAR(""VAR VAR VAR VAR VAR VAR. VAR VAR "" ""VAR VAR VAR, VAR VAR VAR."") VAR: VAR(VAR) VAR (VAR, VAR): VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR: VAR VAR <= 0: VAR VAR(""VAR VAR VAR %VAR VAR VAR %VAR, VAR VAR "" ""VAR VAR VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR 0."" % (VAR, VAR)) VAR VAR:  VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR VAR @VAR VAR VAR(VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR(), VAR VAR() VAR VAR. VAR VAR VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR ``VAR`` VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR VAR, VAR VAR :VAR: VAR VAR :VAR: :VAR:`VAR` """""" VAR VAR(VAR=VAR, VAR=VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR/VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR :VAR: :VAR:`VAR` """"""    VAR VAR(VAR=VAR.VAR, VAR=VAR.VAR, VAR=VAR.VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR, VAR VAR VAR VAR() VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR VAR.VAR VAR VAR VAR: VAR VAR(""VAR VAR VAR VAR VAR VAR."") VAR.VAR = VAR() VAR VAR.VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR :VAR:`VAR`. :VAR: VAR VAR. :VAR: VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. """""" VAR VAR.VAR VAR VAR: VAR VAR(""VAR'VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR."") VAR VAR() - VAR.VAR @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR (VAR VAR), VAR VAR VAR VAR VAR. :VAR: VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR """""" VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR.VAR VAR VAR.VAR: VAR VAR.VAR VAR VAR(VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR.VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR :VAR:`~VAR.VAR.VAR` VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR :VAR VAR.VAR.VAR: VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR (VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR):  VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR(0, VAR(VAR.VAR - VAR.VAR(), VAR.VAR)) VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR: VAR VAR(0, VAR.VAR - VAR.VAR()) VAR: VAR VAR.VAR ",7,3
urllib3_2d4a3fee6de2fa45eb82169361918f759269b4ec,src/urllib3/util/timeout.py,"from __future__ import absolute_import

import time

# The default socket timeout, used by httplib to indicate that no timeout was
# specified by the user
from socket import _GLOBAL_DEFAULT_TIMEOUT

from ..exceptions import TimeoutStateError

# A sentinel value to indicate that no timeout was specified by the user in
# urllib3
_Default = object()


# Use time.monotonic if available.
current_time = getattr(time, ""monotonic"", time.time)


class Timeout(object):
    """"""Timeout configuration.

    Timeouts can be defined as a default for a pool:

    .. code-block:: python

       timeout = Timeout(connect=2.0, read=7.0)
       http = PoolManager(timeout=timeout)
       response = http.request('GET', 'http://example.com/')

    Or per-request (which overrides the default for the pool):

    .. code-block:: python

       response = http.request('GET', 'http://example.com/', timeout=Timeout(10))

    Timeouts can be disabled by setting all the parameters to ``None``:

    .. code-block:: python

       no_timeout = Timeout(connect=None, read=None)
       response = http.request('GET', 'http://example.com/, timeout=no_timeout)


    :param total:
        This combines the connect and read timeouts into one; the read timeout
        will be set to the time leftover from the connect attempt. In the
        event that both a connect timeout and a total are specified, or a read
        timeout and a total are specified, the shorter timeout will be applied.

        Defaults to None.

    :type total: int, float, or None

    :param connect:
        The maximum amount of time (in seconds) to wait for a connection
        attempt to a server to succeed. Omitting the parameter will default the
        connect timeout to the system default, probably `the global default
        timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout for connection attempts.

    :type connect: int, float, or None

    :param read:
        The maximum amount of time (in seconds) to wait between consecutive
        read operations for a response from the server. Omitting the parameter
        will default the read timeout to the system default, probably `the
        global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout.

    :type read: int, float, or None

    .. note::

        Many factors can affect the total amount of time for urllib3 to return
        an HTTP response.

        For example, Python's DNS resolver does not obey the timeout specified
        on the socket. Other factors that can affect total request time include
        high CPU load, high swap, the program running at a low priority level,
        or other behaviors.

        In addition, the read and total timeouts only measure the time between
        read operations on the socket connecting the client and the server,
        not the total amount of time for the request to return a complete
        response. For most requests, the timeout is raised because the server
        has not sent the first byte in the specified time. This is not always
        the case; if a server streams one byte every fifteen seconds, a timeout
        of 20 seconds will not trigger, even though the request will take
        several minutes to complete.

        If your goal is to cut off any request after a set amount of wall clock
        time, consider having a second ""watcher"" thread to cut off a slow
        request.
    """"""

    #: A sentinel object representing the default timeout value
    DEFAULT_TIMEOUT = _GLOBAL_DEFAULT_TIMEOUT

    def __init__(self, total=None, connect=_Default, read=_Default):
        self._connect = self._validate_timeout(connect, ""connect"")
        self._read = self._validate_timeout(read, ""read"")
        self.total = self._validate_timeout(total, ""total"")
        self._start_connect = None

    def __repr__(self):
        return ""%s(connect=%r, read=%r, total=%r)"" % (
            type(self).__name__,
            self._connect,
            self._read,
            self.total,
        )

    # __str__ provided for backwards compatibility
    __str__ = __repr__

    @classmethod
    def _validate_timeout(cls, value, name):
        """"""Check that a timeout attribute is valid.

        :param value: The timeout value to validate
        :param name: The name of the timeout attribute to validate. This is
            used to specify in error messages.
        :return: The validated and casted version of the given value.
        :raises ValueError: If it is a numeric value less than or equal to
            zero, or the type is not an integer, float, or None.
        """"""
        if value is _Default:
            return cls.DEFAULT_TIMEOUT

        if value is None or value is cls.DEFAULT_TIMEOUT:
            return value

        if isinstance(value, bool):
            raise ValueError(
                ""Timeout cannot be a boolean value. It must ""
                ""be an int, float or None.""
            )
        try:
            float(value)
        except (TypeError, ValueError):
            raise ValueError(
                ""Timeout value %s was %s, but it must be an ""
                ""int, float or None."" % (name, value)
            )

        try:
            if value <= 0:
                raise ValueError(
                    ""Attempted to set %s timeout to %s, but the ""
                    ""timeout cannot be set to a value less ""
                    ""than or equal to 0."" % (name, value)
                )
        except TypeError:
            # Python 3
            raise ValueError(
                ""Timeout value %s was %s, but it must be an ""
                ""int, float or None."" % (name, value)
            )

        return value

    @classmethod
    def from_float(cls, timeout):
        """"""Create a new Timeout from a legacy timeout value.

        The timeout value used by httplib.py sets the same timeout on the
        connect(), and recv() socket requests. This creates a :class:`Timeout`
        object that sets the individual timeouts to the ``timeout`` value
        passed to this function.

        :param timeout: The legacy timeout value.
        :type timeout: integer, float, sentinel default object, or None
        :return: Timeout object
        :rtype: :class:`Timeout`
        """"""
        return Timeout(read=timeout, connect=timeout)

    def clone(self):
        """"""Create a copy of the timeout object

        Timeout properties are stored per-pool but each request needs a fresh
        Timeout object to ensure each one has its own start/stop configured.

        :return: a copy of the timeout object
        :rtype: :class:`Timeout`
        """"""
        # We can't use copy.deepcopy because that will also create a new object
        # for _GLOBAL_DEFAULT_TIMEOUT, which socket.py uses as a sentinel to
        # detect the user default.
        return Timeout(connect=self._connect, read=self._read, total=self.total)

    def start_connect(self):
        """"""Start the timeout clock, used during a connect() attempt

        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to start a timer that has been started already.
        """"""
        if self._start_connect is not None:
            raise TimeoutStateError(""Timeout timer has already been started."")
        self._start_connect = current_time()
        return self._start_connect

    def get_connect_duration(self):
        """"""Gets the time elapsed since the call to :meth:`start_connect`.

        :return: Elapsed time in seconds.
        :rtype: float
        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to get duration for a timer that hasn't been started.
        """"""
        if self._start_connect is None:
            raise TimeoutStateError(
                ""Can't get connect duration for timer that has not started.""
            )
        return current_time() - self._start_connect

    @property
    def connect_timeout(self):
        """"""Get the value to use when setting a connection timeout.

        This will be a positive float or integer, the value None
        (never timeout), or the default system timeout.

        :return: Connect timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        """"""
        if self.total is None:
            return self._connect

        if self._connect is None or self._connect is self.DEFAULT_TIMEOUT:
            return self.total

        return min(self._connect, self.total)

    @property
    def read_timeout(self):
        """"""Get the value for the read timeout.

        This assumes some time has elapsed in the connection timeout and
        computes the read timeout appropriately.

        If self.total is set, the read timeout is dependent on the amount of
        time taken by the connect timeout. If the connection time has not been
        established, a :exc:`~urllib3.exceptions.TimeoutStateError` will be
        raised.

        :return: Value to use for the read timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        :raises urllib3.exceptions.TimeoutStateError: If :meth:`start_connect`
            has not yet been called on this object.
        """"""
        if (
            self.total is not None
            and self.total is not self.DEFAULT_TIMEOUT
            and self._read is not None
            and self._read is not self.DEFAULT_TIMEOUT
        ):
            # In case the connect timeout has not yet been established.
            if self._start_connect is None:
                return self._read
            return max(0, min(self.total - self.get_connect_duration(), self._read))
        elif self.total is not None and self.total is not self.DEFAULT_TIMEOUT:
            return max(0, self.total - self.get_connect_duration())
        else:
            return self._read",,2d4a3fee6de2fa45eb82169361918f759269b4ec,CVE-2021-33503,2d4a3fee6de2fa45eb82169361918f759269b4ec,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR VAR VAR VAR   VAR VAR VAR VAR VAR ..VAR VAR VAR   VAR = VAR()  VAR = VAR(VAR, ""VAR"", VAR.VAR) VAR VAR(VAR): """"""VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: .. VAR-VAR:: VAR VAR = VAR(VAR=2.0, VAR=7.0) VAR = VAR(VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: VAR VAR-VAR (VAR VAR VAR VAR VAR VAR VAR): .. VAR-VAR:: VAR VAR = VAR.VAR('VAR', 'VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR``: .. VAR-VAR:: VAR VAR = VAR(VAR=VAR, VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR (VAR VAR) VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR (VAR VAR) VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR .. VAR:: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR 20 VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR. """"""  VAR = VAR VAR VAR(VAR, VAR=VAR, VAR=VAR, VAR=VAR): VAR.VAR = VAR.VAR(VAR, ""VAR"") VAR.VAR = VAR.VAR(VAR, ""VAR"") VAR.VAR = VAR.VAR(VAR, ""VAR"") VAR.VAR = VAR VAR VAR(VAR): VAR ""%VAR(VAR=%VAR, VAR=%VAR, VAR=%VAR)"" % ( VAR(VAR).VAR, VAR.VAR, VAR.VAR, VAR.VAR, )  VAR = VAR @VAR VAR VAR(VAR, VAR, VAR): """"""VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR. """""" VAR VAR VAR VAR: VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR: VAR VAR VAR VAR(VAR, VAR): VAR VAR( ""VAR VAR VAR VAR VAR VAR. VAR VAR "" ""VAR VAR VAR, VAR VAR VAR."" ) VAR: VAR(VAR) VAR (VAR, VAR): VAR VAR( ""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR) ) VAR: VAR VAR <= 0: VAR VAR( ""VAR VAR VAR %VAR VAR VAR %VAR, VAR VAR "" ""VAR VAR VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR 0."" % (VAR, VAR) ) VAR VAR:  VAR VAR( ""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR) ) VAR VAR @VAR VAR VAR(VAR, VAR): """"""VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR(), VAR VAR() VAR VAR. VAR VAR VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR ``VAR`` VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR VAR, VAR VAR :VAR: VAR VAR :VAR: :VAR:`VAR` """""" VAR VAR(VAR=VAR, VAR=VAR) VAR VAR(VAR): """"""VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR/VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR :VAR: :VAR:`VAR` """"""    VAR VAR(VAR=VAR.VAR, VAR=VAR.VAR, VAR=VAR.VAR) VAR VAR(VAR): """"""VAR VAR VAR VAR, VAR VAR VAR VAR() VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR VAR.VAR VAR VAR VAR: VAR VAR(""VAR VAR VAR VAR VAR VAR."") VAR.VAR = VAR() VAR VAR.VAR VAR VAR(VAR): """"""VAR VAR VAR VAR VAR VAR VAR VAR :VAR:`VAR`. :VAR: VAR VAR VAR VAR. :VAR: VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. """""" VAR VAR.VAR VAR VAR: VAR VAR( ""VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR."" ) VAR VAR() - VAR.VAR @VAR VAR VAR(VAR): """"""VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR (VAR VAR), VAR VAR VAR VAR VAR. :VAR: VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR """""" VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR.VAR VAR VAR.VAR: VAR VAR.VAR VAR VAR(VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR): """"""VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR.VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR :VAR:`~VAR.VAR.VAR` VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR :VAR VAR.VAR.VAR: VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR ( VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR ):  VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR(0, VAR(VAR.VAR - VAR.VAR(), VAR.VAR)) VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR: VAR VAR(0, VAR.VAR - VAR.VAR()) VAR: VAR VAR.VAR ",7,3
urllib3_9b76785331243689a9d52cef3db05ef7462cb02d,src/urllib3/util/timeout.py,"from __future__ import absolute_import
# The default socket timeout, used by httplib to indicate that no timeout was
# specified by the user
from socket import _GLOBAL_DEFAULT_TIMEOUT
import time

from ..exceptions import TimeoutStateError

# A sentinel value to indicate that no timeout was specified by the user in
# urllib3
_Default = object()


# Use time.monotonic if available.
current_time = getattr(time, ""monotonic"", time.time)


class Timeout(object):
    """""" Timeout configuration.

    Timeouts can be defined as a default for a pool::

        timeout = Timeout(connect=2.0, read=7.0)
        http = PoolManager(timeout=timeout)
        response = http.request('GET', 'http://example.com/')

    Or per-request (which overrides the default for the pool)::

        response = http.request('GET', 'http://example.com/', timeout=Timeout(10))

    Timeouts can be disabled by setting all the parameters to ``None``::

        no_timeout = Timeout(connect=None, read=None)
        response = http.request('GET', 'http://example.com/, timeout=no_timeout)


    :param total:
        This combines the connect and read timeouts into one; the read timeout
        will be set to the time leftover from the connect attempt. In the
        event that both a connect timeout and a total are specified, or a read
        timeout and a total are specified, the shorter timeout will be applied.

        Defaults to None.

    :type total: integer, float, or None

    :param connect:
        The maximum amount of time to wait for a connection attempt to a server
        to succeed. Omitting the parameter will default the connect timeout to
        the system default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout for connection attempts.

    :type connect: integer, float, or None

    :param read:
        The maximum amount of time to wait between consecutive
        read operations for a response from the server. Omitting
        the parameter will default the read timeout to the system
        default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout.

    :type read: integer, float, or None

    .. note::

        Many factors can affect the total amount of time for urllib3 to return
        an HTTP response.

        For example, Python's DNS resolver does not obey the timeout specified
        on the socket. Other factors that can affect total request time include
        high CPU load, high swap, the program running at a low priority level,
        or other behaviors.

        In addition, the read and total timeouts only measure the time between
        read operations on the socket connecting the client and the server,
        not the total amount of time for the request to return a complete
        response. For most requests, the timeout is raised because the server
        has not sent the first byte in the specified time. This is not always
        the case; if a server streams one byte every fifteen seconds, a timeout
        of 20 seconds will not trigger, even though the request will take
        several minutes to complete.

        If your goal is to cut off any request after a set amount of wall clock
        time, consider having a second ""watcher"" thread to cut off a slow
        request.
    """"""

    #: A sentinel object representing the default timeout value
    DEFAULT_TIMEOUT = _GLOBAL_DEFAULT_TIMEOUT

    def __init__(self, total=None, connect=_Default, read=_Default):
        self._connect = self._validate_timeout(connect, 'connect')
        self._read = self._validate_timeout(read, 'read')
        self.total = self._validate_timeout(total, 'total')
        self._start_connect = None

    def __str__(self):
        return '%s(connect=%r, read=%r, total=%r)' % (
            type(self).__name__, self._connect, self._read, self.total)

    @classmethod
    def _validate_timeout(cls, value, name):
        """""" Check that a timeout attribute is valid.

        :param value: The timeout value to validate
        :param name: The name of the timeout attribute to validate. This is
            used to specify in error messages.
        :return: The validated and casted version of the given value.
        :raises ValueError: If it is a numeric value less than or equal to
            zero, or the type is not an integer, float, or None.
        """"""
        if value is _Default:
            return cls.DEFAULT_TIMEOUT

        if value is None or value is cls.DEFAULT_TIMEOUT:
            return value

        if isinstance(value, bool):
            raise ValueError(""Timeout cannot be a boolean value. It must ""
                             ""be an int, float or None."")
        try:
            float(value)
        except (TypeError, ValueError):
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        try:
            if value <= 0:
                raise ValueError(""Attempted to set %s timeout to %s, but the ""
                                 ""timeout cannot be set to a value less ""
                                 ""than or equal to 0."" % (name, value))
        except TypeError:  # Python 3
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        return value

    @classmethod
    def from_float(cls, timeout):
        """""" Create a new Timeout from a legacy timeout value.

        The timeout value used by httplib.py sets the same timeout on the
        connect(), and recv() socket requests. This creates a :class:`Timeout`
        object that sets the individual timeouts to the ``timeout`` value
        passed to this function.

        :param timeout: The legacy timeout value.
        :type timeout: integer, float, sentinel default object, or None
        :return: Timeout object
        :rtype: :class:`Timeout`
        """"""
        return Timeout(read=timeout, connect=timeout)

    def clone(self):
        """""" Create a copy of the timeout object

        Timeout properties are stored per-pool but each request needs a fresh
        Timeout object to ensure each one has its own start/stop configured.

        :return: a copy of the timeout object
        :rtype: :class:`Timeout`
        """"""
        # We can't use copy.deepcopy because that will also create a new object
        # for _GLOBAL_DEFAULT_TIMEOUT, which socket.py uses as a sentinel to
        # detect the user default.
        return Timeout(connect=self._connect, read=self._read,
                       total=self.total)

    def start_connect(self):
        """""" Start the timeout clock, used during a connect() attempt

        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to start a timer that has been started already.
        """"""
        if self._start_connect is not None:
            raise TimeoutStateError(""Timeout timer has already been started."")
        self._start_connect = current_time()
        return self._start_connect

    def get_connect_duration(self):
        """""" Gets the time elapsed since the call to :meth:`start_connect`.

        :return: Elapsed time.
        :rtype: float
        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to get duration for a timer that hasn't been started.
        """"""
        if self._start_connect is None:
            raise TimeoutStateError(""Can't get connect duration for timer ""
                                    ""that has not started."")
        return current_time() - self._start_connect

    @property
    def connect_timeout(self):
        """""" Get the value to use when setting a connection timeout.

        This will be a positive float or integer, the value None
        (never timeout), or the default system timeout.

        :return: Connect timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        """"""
        if self.total is None:
            return self._connect

        if self._connect is None or self._connect is self.DEFAULT_TIMEOUT:
            return self.total

        return min(self._connect, self.total)

    @property
    def read_timeout(self):
        """""" Get the value for the read timeout.

        This assumes some time has elapsed in the connection timeout and
        computes the read timeout appropriately.

        If self.total is set, the read timeout is dependent on the amount of
        time taken by the connect timeout. If the connection time has not been
        established, a :exc:`~urllib3.exceptions.TimeoutStateError` will be
        raised.

        :return: Value to use for the read timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        :raises urllib3.exceptions.TimeoutStateError: If :meth:`start_connect`
            has not yet been called on this object.
        """"""
        if (self.total is not None and
                self.total is not self.DEFAULT_TIMEOUT and
                self._read is not None and
                self._read is not self.DEFAULT_TIMEOUT):
            # In case the connect timeout has not yet been established.
            if self._start_connect is None:
                return self._read
            return max(0, min(self.total - self.get_connect_duration(),
                              self._read))
        elif self.total is not None and self.total is not self.DEFAULT_TIMEOUT:
            return max(0, self.total - self.get_connect_duration())
        else:
            return self._read",,9b76785331243689a9d52cef3db05ef7462cb02d,CVE-2019-11236,9b76785331243689a9d52cef3db05ef7462cb02d,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,70,COMPLETED,"VAR VAR VAR VAR   VAR VAR VAR VAR VAR VAR VAR ..VAR VAR VAR   VAR = VAR()  VAR = VAR(VAR, ""VAR"", VAR.VAR) VAR VAR(VAR): """""" VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:: VAR = VAR(VAR=2.0, VAR=7.0) VAR = VAR(VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: VAR VAR-VAR (VAR VAR VAR VAR VAR VAR VAR):: VAR = VAR.VAR('VAR', 'VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR``:: VAR = VAR(VAR=VAR, VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR .. VAR:: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR 20 VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR. """"""  VAR = VAR VAR VAR(VAR, VAR=VAR, VAR=VAR, VAR=VAR): VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR VAR VAR(VAR): VAR '%VAR(VAR=%VAR, VAR=%VAR, VAR=%VAR)' % ( VAR(VAR).VAR, VAR.VAR, VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR, VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR. """""" VAR VAR VAR VAR: VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR: VAR VAR VAR VAR(VAR, VAR): VAR VAR(""VAR VAR VAR VAR VAR VAR. VAR VAR "" ""VAR VAR VAR, VAR VAR VAR."") VAR: VAR(VAR) VAR (VAR, VAR): VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR: VAR VAR <= 0: VAR VAR(""VAR VAR VAR %VAR VAR VAR %VAR, VAR VAR "" ""VAR VAR VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR 0."" % (VAR, VAR)) VAR VAR:  VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR VAR @VAR VAR VAR(VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR(), VAR VAR() VAR VAR. VAR VAR VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR ``VAR`` VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR VAR, VAR VAR :VAR: VAR VAR :VAR: :VAR:`VAR` """""" VAR VAR(VAR=VAR, VAR=VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR/VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR :VAR: :VAR:`VAR` """"""    VAR VAR(VAR=VAR.VAR, VAR=VAR.VAR, VAR=VAR.VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR, VAR VAR VAR VAR() VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR VAR.VAR VAR VAR VAR: VAR VAR(""VAR VAR VAR VAR VAR VAR."") VAR.VAR = VAR() VAR VAR.VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR :VAR:`VAR`. :VAR: VAR VAR. :VAR: VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. """""" VAR VAR.VAR VAR VAR: VAR VAR(""VAR'VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR."") VAR VAR() - VAR.VAR @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR (VAR VAR), VAR VAR VAR VAR VAR. :VAR: VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR """""" VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR.VAR VAR VAR.VAR: VAR VAR.VAR VAR VAR(VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR.VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR :VAR:`~VAR.VAR.VAR` VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR :VAR VAR.VAR.VAR: VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR (VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR):  VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR(0, VAR(VAR.VAR - VAR.VAR(), VAR.VAR)) VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR: VAR VAR(0, VAR.VAR - VAR.VAR()) VAR: VAR VAR.VAR ",7,3
urllib3_a74c9cfbaed9f811e7563cfc3dce894928e0221a,src/urllib3/util/timeout.py,"from __future__ import absolute_import
# The default socket timeout, used by httplib to indicate that no timeout was
# specified by the user
from socket import _GLOBAL_DEFAULT_TIMEOUT
import time

from ..exceptions import TimeoutStateError

# A sentinel value to indicate that no timeout was specified by the user in
# urllib3
_Default = object()


# Use time.monotonic if available.
current_time = getattr(time, ""monotonic"", time.time)


class Timeout(object):
    """""" Timeout configuration.

    Timeouts can be defined as a default for a pool::

        timeout = Timeout(connect=2.0, read=7.0)
        http = PoolManager(timeout=timeout)
        response = http.request('GET', 'http://example.com/')

    Or per-request (which overrides the default for the pool)::

        response = http.request('GET', 'http://example.com/', timeout=Timeout(10))

    Timeouts can be disabled by setting all the parameters to ``None``::

        no_timeout = Timeout(connect=None, read=None)
        response = http.request('GET', 'http://example.com/, timeout=no_timeout)


    :param total:
        This combines the connect and read timeouts into one; the read timeout
        will be set to the time leftover from the connect attempt. In the
        event that both a connect timeout and a total are specified, or a read
        timeout and a total are specified, the shorter timeout will be applied.

        Defaults to None.

    :type total: integer, float, or None

    :param connect:
        The maximum amount of time to wait for a connection attempt to a server
        to succeed. Omitting the parameter will default the connect timeout to
        the system default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout for connection attempts.

    :type connect: integer, float, or None

    :param read:
        The maximum amount of time to wait between consecutive
        read operations for a response from the server. Omitting
        the parameter will default the read timeout to the system
        default, probably `the global default timeout in socket.py
        <http://hg.python.org/cpython/file/603b4d593758/Lib/socket.py#l535>`_.
        None will set an infinite timeout.

    :type read: integer, float, or None

    .. note::

        Many factors can affect the total amount of time for urllib3 to return
        an HTTP response.

        For example, Python's DNS resolver does not obey the timeout specified
        on the socket. Other factors that can affect total request time include
        high CPU load, high swap, the program running at a low priority level,
        or other behaviors.

        In addition, the read and total timeouts only measure the time between
        read operations on the socket connecting the client and the server,
        not the total amount of time for the request to return a complete
        response. For most requests, the timeout is raised because the server
        has not sent the first byte in the specified time. This is not always
        the case; if a server streams one byte every fifteen seconds, a timeout
        of 20 seconds will not trigger, even though the request will take
        several minutes to complete.

        If your goal is to cut off any request after a set amount of wall clock
        time, consider having a second ""watcher"" thread to cut off a slow
        request.
    """"""

    #: A sentinel object representing the default timeout value
    DEFAULT_TIMEOUT = _GLOBAL_DEFAULT_TIMEOUT

    def __init__(self, total=None, connect=_Default, read=_Default):
        self._connect = self._validate_timeout(connect, 'connect')
        self._read = self._validate_timeout(read, 'read')
        self.total = self._validate_timeout(total, 'total')
        self._start_connect = None

    def __str__(self):
        return '%s(connect=%r, read=%r, total=%r)' % (
            type(self).__name__, self._connect, self._read, self.total)

    @classmethod
    def _validate_timeout(cls, value, name):
        """""" Check that a timeout attribute is valid.

        :param value: The timeout value to validate
        :param name: The name of the timeout attribute to validate. This is
            used to specify in error messages.
        :return: The validated and casted version of the given value.
        :raises ValueError: If it is a numeric value less than or equal to
            zero, or the type is not an integer, float, or None.
        """"""
        if value is _Default:
            return cls.DEFAULT_TIMEOUT

        if value is None or value is cls.DEFAULT_TIMEOUT:
            return value

        if isinstance(value, bool):
            raise ValueError(""Timeout cannot be a boolean value. It must ""
                             ""be an int, float or None."")
        try:
            float(value)
        except (TypeError, ValueError):
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        try:
            if value <= 0:
                raise ValueError(""Attempted to set %s timeout to %s, but the ""
                                 ""timeout cannot be set to a value less ""
                                 ""than or equal to 0."" % (name, value))
        except TypeError:
            # Python 3
            raise ValueError(""Timeout value %s was %s, but it must be an ""
                             ""int, float or None."" % (name, value))

        return value

    @classmethod
    def from_float(cls, timeout):
        """""" Create a new Timeout from a legacy timeout value.

        The timeout value used by httplib.py sets the same timeout on the
        connect(), and recv() socket requests. This creates a :class:`Timeout`
        object that sets the individual timeouts to the ``timeout`` value
        passed to this function.

        :param timeout: The legacy timeout value.
        :type timeout: integer, float, sentinel default object, or None
        :return: Timeout object
        :rtype: :class:`Timeout`
        """"""
        return Timeout(read=timeout, connect=timeout)

    def clone(self):
        """""" Create a copy of the timeout object

        Timeout properties are stored per-pool but each request needs a fresh
        Timeout object to ensure each one has its own start/stop configured.

        :return: a copy of the timeout object
        :rtype: :class:`Timeout`
        """"""
        # We can't use copy.deepcopy because that will also create a new object
        # for _GLOBAL_DEFAULT_TIMEOUT, which socket.py uses as a sentinel to
        # detect the user default.
        return Timeout(connect=self._connect, read=self._read,
                       total=self.total)

    def start_connect(self):
        """""" Start the timeout clock, used during a connect() attempt

        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to start a timer that has been started already.
        """"""
        if self._start_connect is not None:
            raise TimeoutStateError(""Timeout timer has already been started."")
        self._start_connect = current_time()
        return self._start_connect

    def get_connect_duration(self):
        """""" Gets the time elapsed since the call to :meth:`start_connect`.

        :return: Elapsed time.
        :rtype: float
        :raises urllib3.exceptions.TimeoutStateError: if you attempt
            to get duration for a timer that hasn't been started.
        """"""
        if self._start_connect is None:
            raise TimeoutStateError(""Can't get connect duration for timer ""
                                    ""that has not started."")
        return current_time() - self._start_connect

    @property
    def connect_timeout(self):
        """""" Get the value to use when setting a connection timeout.

        This will be a positive float or integer, the value None
        (never timeout), or the default system timeout.

        :return: Connect timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        """"""
        if self.total is None:
            return self._connect

        if self._connect is None or self._connect is self.DEFAULT_TIMEOUT:
            return self.total

        return min(self._connect, self.total)

    @property
    def read_timeout(self):
        """""" Get the value for the read timeout.

        This assumes some time has elapsed in the connection timeout and
        computes the read timeout appropriately.

        If self.total is set, the read timeout is dependent on the amount of
        time taken by the connect timeout. If the connection time has not been
        established, a :exc:`~urllib3.exceptions.TimeoutStateError` will be
        raised.

        :return: Value to use for the read timeout.
        :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
        :raises urllib3.exceptions.TimeoutStateError: If :meth:`start_connect`
            has not yet been called on this object.
        """"""
        if (self.total is not None and
                self.total is not self.DEFAULT_TIMEOUT and
                self._read is not None and
                self._read is not self.DEFAULT_TIMEOUT):
            # In case the connect timeout has not yet been established.
            if self._start_connect is None:
                return self._read
            return max(0, min(self.total - self.get_connect_duration(),
                              self._read))
        elif self.total is not None and self.total is not self.DEFAULT_TIMEOUT:
            return max(0, self.total - self.get_connect_duration())
        else:
            return self._read",,a74c9cfbaed9f811e7563cfc3dce894928e0221a,CVE-2020-7212,a74c9cfbaed9f811e7563cfc3dce894928e0221a,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR VAR   VAR VAR VAR VAR VAR VAR VAR ..VAR VAR VAR   VAR = VAR()  VAR = VAR(VAR, ""VAR"", VAR.VAR) VAR VAR(VAR): """""" VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:: VAR = VAR(VAR=2.0, VAR=7.0) VAR = VAR(VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: VAR VAR-VAR (VAR VAR VAR VAR VAR VAR VAR):: VAR = VAR.VAR('VAR', 'VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR``:: VAR = VAR(VAR=VAR, VAR=VAR) VAR = VAR.VAR('VAR', 'VAR: :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR `VAR VAR VAR VAR VAR VAR.VAR <VAR: VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR .. VAR:: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR 20 VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR. """"""  VAR = VAR VAR VAR(VAR, VAR=VAR, VAR=VAR, VAR=VAR): VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR.VAR(VAR, 'VAR') VAR.VAR = VAR VAR VAR(VAR): VAR '%VAR(VAR=%VAR, VAR=%VAR, VAR=%VAR)' % ( VAR(VAR).VAR, VAR.VAR, VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR, VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR. """""" VAR VAR VAR VAR: VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR VAR.VAR: VAR VAR VAR VAR(VAR, VAR): VAR VAR(""VAR VAR VAR VAR VAR VAR. VAR VAR "" ""VAR VAR VAR, VAR VAR VAR."") VAR: VAR(VAR) VAR (VAR, VAR): VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR: VAR VAR <= 0: VAR VAR(""VAR VAR VAR %VAR VAR VAR %VAR, VAR VAR "" ""VAR VAR VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR 0."" % (VAR, VAR)) VAR VAR:  VAR VAR(""VAR VAR %VAR VAR %VAR, VAR VAR VAR VAR VAR "" ""VAR, VAR VAR VAR."" % (VAR, VAR)) VAR VAR @VAR VAR VAR(VAR, VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR VAR VAR VAR VAR(), VAR VAR() VAR VAR. VAR VAR VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR ``VAR`` VAR VAR VAR VAR VAR. :VAR VAR: VAR VAR VAR VAR. :VAR VAR: VAR, VAR, VAR VAR VAR, VAR VAR :VAR: VAR VAR :VAR: :VAR:`VAR` """""" VAR VAR(VAR=VAR, VAR=VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR/VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR :VAR: :VAR:`VAR` """"""    VAR VAR(VAR=VAR.VAR, VAR=VAR.VAR, VAR=VAR.VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR, VAR VAR VAR VAR() VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR VAR.VAR VAR VAR VAR: VAR VAR(""VAR VAR VAR VAR VAR VAR."") VAR.VAR = VAR() VAR VAR.VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR :VAR:`VAR`. :VAR: VAR VAR. :VAR: VAR :VAR VAR.VAR.VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. """""" VAR VAR.VAR VAR VAR: VAR VAR(""VAR'VAR VAR VAR VAR VAR VAR "" ""VAR VAR VAR VAR."") VAR VAR() - VAR.VAR @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR (VAR VAR), VAR VAR VAR VAR VAR. :VAR: VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR """""" VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR.VAR VAR VAR.VAR: VAR VAR.VAR VAR VAR(VAR.VAR, VAR.VAR) @VAR VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR.VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR, VAR :VAR:`~VAR.VAR.VAR` VAR VAR VAR. :VAR: VAR VAR VAR VAR VAR VAR VAR. :VAR: VAR, VAR, :VAR:`VAR.VAR` VAR VAR :VAR VAR.VAR.VAR: VAR :VAR:`VAR` VAR VAR VAR VAR VAR VAR VAR VAR. """""" VAR (VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR):  VAR VAR.VAR VAR VAR: VAR VAR.VAR VAR VAR(0, VAR(VAR.VAR - VAR.VAR(), VAR.VAR)) VAR VAR.VAR VAR VAR VAR VAR VAR.VAR VAR VAR VAR.VAR: VAR VAR(0, VAR.VAR - VAR.VAR()) VAR: VAR VAR.VAR ",7,3
vim_0ff01835a40f549c5c4a550502f62a2ac9ac447c,src/testdir/test_ins_complete.vim,"  call TermWait(buf, 200)
func s:Tagfunc(t,f,o)
  bwipe!
  return []
endfunc

"" This was using freed memory, since 'complete' was in a wiped out buffer.
"" Also using a window that was closed.
func Test_tagfunc_wipes_out_buffer()
  new
  set complete=.,t,w,b,u,i
  se tagfunc=s:Tagfunc
  sil norm i

  bwipe!
endfunc

","  call TermWait(buf, 50)
  call TermWait(buf, 100)",0ff01835a40f549c5c4a550502f62a2ac9ac447c,CVE-2022-3297,0ff01835a40f549c5c4a550502f62a2ac9ac447c,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR(VAR, 200) VAR VAR:VAR(VAR,VAR,VAR) VAR! VAR [] VAR "" VAR VAR VAR VAR VAR, VAR 'VAR' VAR VAR VAR VAR VAR VAR. "" VAR VAR VAR VAR VAR VAR VAR. VAR VAR() VAR VAR VAR=.,VAR,VAR,VAR,VAR,VAR VAR VAR=VAR:VAR VAR VAR VAR VAR! VAR VAR VAR(VAR, 50) VAR VAR(VAR, 100)",8,3
vim_51f0bfb88a3554ca2dde777d78a59880d1ee37a8,src/ex_getln.c,"    static int	depth = 0;	    // call depth
    // one recursion level deeper
    ++depth;

    if (depth == 50)
    {
	// Somehow got into a loop recursively calling getcmdline(), bail out.
	emsg(_(e_command_too_recursive));
	goto theend;
    }

	--depth;",,51f0bfb88a3554ca2dde777d78a59880d1ee37a8,CVE-2022-1771,51f0bfb88a3554ca2dde777d78a59880d1ee37a8,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR VAR VAR = 0;   ++VAR; VAR (VAR == 50) {  VAR(VAR(VAR)); VAR VAR; } --VAR; ,0,3
vim_85b6747abc15a7a81086db31289cf1b8b17e6cb1,src/ex_getln.c,    alloc_cmdbuff(indent + 50);,    alloc_cmdbuff(exmode_active ? 250 : indent + 1);,85b6747abc15a7a81086db31289cf1b8b17e6cb1,CVE-2022-0359,85b6747abc15a7a81086db31289cf1b8b17e6cb1,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR(VAR + 50); VAR(VAR ? 250 : VAR + 1);,0,3
vim_91c7cbfe31bbef57d5fcf7d76989fc159f73ef15,src/eval.c,"/*
 * Initialize ""evalarg"" for use.
 */
    void
init_evalarg(evalarg_T *evalarg)
{
    CLEAR_POINTER(evalarg);
    ga_init2(&evalarg->eval_tofree_ga, sizeof(char_u *), 20);
}

/*
 * If ""evalarg->eval_tofree"" is not NULL free it later.
 * Caller is expected to overwrite ""evalarg->eval_tofree"" next.
 */
    static void
free_eval_tofree_later(evalarg_T *evalarg)
{
    if (evalarg->eval_tofree != NULL)
    {
	if (ga_grow(&evalarg->eval_tofree_ga, 1) == OK)
	    ((char_u **)evalarg->eval_tofree_ga.ga_data)
		[evalarg->eval_tofree_ga.ga_len++]
		= evalarg->eval_tofree;
	else
	    vim_free(evalarg->eval_tofree);
    }
}

/*
 * After using ""evalarg"" filled from ""eap"": free the memory.
 */
    void
clear_evalarg(evalarg_T *evalarg, exarg_T *eap)
{
    if (evalarg != NULL)
    {
	if (evalarg->eval_tofree != NULL)
	{
	    if (eap != NULL)
	    {
		// We may need to keep the original command line, e.g. for
		// "":let"" it has the variable names.  But we may also need the
		// new one, ""nextcmd"" points into it.  Keep both.
		vim_free(eap->cmdline_tofree);
		eap->cmdline_tofree = *eap->cmdlinep;
		*eap->cmdlinep = evalarg->eval_tofree;
	    }
	    else
		vim_free(evalarg->eval_tofree);
	    evalarg->eval_tofree = NULL;
	}

	ga_clear_strings(&evalarg->eval_tofree_ga);
	VIM_CLEAR(evalarg->eval_tofree_lambda);
    }
}

		// later.  Also free ""eval_tofree"" later if needed.
		free_eval_tofree_later(evalarg);
	free_eval_tofree_later(evalarg);","		// later.
		vim_free(evalarg->eval_tofree);
	vim_free(evalarg->eval_tofree);
/*
 * Initialize ""evalarg"" for use.
 */
    void
init_evalarg(evalarg_T *evalarg)
{
    CLEAR_POINTER(evalarg);
    ga_init2(&evalarg->eval_tofree_ga, sizeof(char_u *), 20);
}

/*
 * After using ""evalarg"" filled from ""eap"": free the memory.
 */
    void
clear_evalarg(evalarg_T *evalarg, exarg_T *eap)
{
    if (evalarg != NULL)
    {
	if (evalarg->eval_tofree != NULL)
	{
	    if (eap != NULL)
	    {
		// We may need to keep the original command line, e.g. for
		// "":let"" it has the variable names.  But we may also need the
		// new one, ""nextcmd"" points into it.  Keep both.
		vim_free(eap->cmdline_tofree);
		eap->cmdline_tofree = *eap->cmdlinep;
		*eap->cmdlinep = evalarg->eval_tofree;
	    }
	    else
		vim_free(evalarg->eval_tofree);
	    evalarg->eval_tofree = NULL;
	}

	ga_clear_strings(&evalarg->eval_tofree_ga);
	VIM_CLEAR(evalarg->eval_tofree_lambda);
    }
}
",91c7cbfe31bbef57d5fcf7d76989fc159f73ef15,CVE-2022-2889,91c7cbfe31bbef57d5fcf7d76989fc159f73ef15,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,"/* * VAR ""VAR"" VAR VAR. */ VAR VAR(VAR *VAR) { VAR(VAR); VAR(&VAR->VAR, VAR(VAR *), 20); } /* * VAR ""VAR->VAR"" VAR VAR VAR VAR VAR VAR. * VAR VAR VAR VAR VAR ""VAR->VAR"" VAR. */ VAR VAR VAR(VAR *VAR) { VAR (VAR->VAR != VAR) { VAR (VAR(&VAR->VAR, 1) == VAR) ((VAR **)VAR->VAR.VAR) [VAR->VAR.VAR++] = VAR->VAR; VAR VAR(VAR->VAR); } } /* * VAR VAR ""VAR"" VAR VAR ""VAR"": VAR VAR VAR. */ VAR VAR(VAR *VAR, VAR *VAR) { VAR (VAR != VAR) { VAR (VAR->VAR != VAR) { VAR (VAR != VAR) {    VAR(VAR->VAR); VAR->VAR = *VAR->VAR; *VAR->VAR = VAR->VAR; } VAR VAR(VAR->VAR); VAR->VAR = VAR; } VAR(&VAR->VAR); VAR(VAR->VAR); } }  VAR(VAR); VAR(VAR);  VAR(VAR->VAR); VAR(VAR->VAR); /* * VAR ""VAR"" VAR VAR. */ VAR VAR(VAR *VAR) { VAR(VAR); VAR(&VAR->VAR, VAR(VAR *), 20); } /* * VAR VAR ""VAR"" VAR VAR ""VAR"": VAR VAR VAR. */ VAR VAR(VAR *VAR, VAR *VAR) { VAR (VAR != VAR) { VAR (VAR->VAR != VAR) { VAR (VAR != VAR) {    VAR(VAR->VAR); VAR->VAR = *VAR->VAR; *VAR->VAR = VAR->VAR; } VAR VAR(VAR->VAR); VAR->VAR = VAR; } VAR(&VAR->VAR); VAR(VAR->VAR); } }",7,3
vim_fc68299d436cf87453e432daa77b6d545df4d7ed,src/testdir/test_crash.vim,"  if !executable('sh')
    throw 'Skipped: sh not executable!'
  endif
  let buf = RunVimInTerminal('sh', opts)
    \ '  && echo ""crash 1: [OK]"" > X_crash1_result.txt' .. ""\<cr>"")
  call TermWait(buf, 50)
  call TermWait(buf, 50)
  call TermWait(buf, 100)
  let file = 'crash/bt_quickfix_poc'
  let args = printf(cmn_args, vim, file)
  call term_sendkeys(buf, args ..
    \ '  && echo ""crash 4: [OK]"" >> X_crash1_result.txt' .. ""\<cr>"")
  "" clean up
  call delete('Xerr')

  "" This test takes a bit longer
  call TermWait(buf, 200)
  call delete('Xerr')

  let expected = [
      \ 'crash 1: [OK]',
      \ 'crash 2: [OK]',
      \ 'crash 3: [OK]',
      \ 'crash 4: [OK]',
      \ ]

  call assert_equal(expected, getline(1, '$'))","  "" let opts = #{wait_for_ruler: 0, rows: 20, cmd: 'sh'}
  let args = 'bash'
  let buf = RunVimInTerminal(args, opts)
    \ '  && echo ""crash 1: [OK]"" >> X_crash1_result.txt' .. ""\<cr>"")
  call TermWait(buf, 50)
  call assert_equal(['crash 1: [OK]', 'crash 2: [OK]', 'crash 3: [OK]'],
    \ getline(1, '$'))",fc68299d436cf87453e432daa77b6d545df4d7ed,CVE-2023-4750,fc68299d436cf87453e432daa77b6d545df4d7ed,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR !VAR('VAR') VAR 'VAR: VAR VAR VAR!' VAR VAR VAR = VAR('VAR', VAR) \ ' && VAR ""VAR 1: [VAR]"" > VAR.VAR' .. ""\<VAR>"") VAR VAR(VAR, 50) VAR VAR(VAR, 50) VAR VAR(VAR, 100) VAR VAR = 'VAR/VAR' VAR VAR = VAR(VAR, VAR, VAR) VAR VAR(VAR, VAR .. \ ' && VAR ""VAR 4: [VAR]"" >> VAR.VAR' .. ""\<VAR>"") "" VAR VAR VAR VAR('VAR') "" VAR VAR VAR VAR VAR VAR VAR VAR(VAR, 200) VAR VAR('VAR') VAR VAR = [ \ 'VAR 1: [VAR]', \ 'VAR 2: [VAR]', \ 'VAR 3: [VAR]', \ 'VAR 4: [VAR]', \ ] VAR VAR(VAR, VAR(1, '$')) "" VAR VAR =  VAR VAR = 'VAR' VAR VAR = VAR(VAR, VAR) \ ' && VAR ""VAR 1: [VAR]"" >> VAR.VAR' .. ""\<VAR>"") VAR VAR(VAR, 50) VAR VAR(['VAR 1: [VAR]', 'VAR 2: [VAR]', 'VAR 3: [VAR]'], \ VAR(1, '$'))",0,3
xwiki-platform_217e5bb7a657f2991b154a16ef4d5ae9c29ad39c,xwiki-platform-core/xwiki-platform-notifications/xwiki-platform-notifications-ui/src/main/resources/XWiki/Notifications/Code/NotificationRSSService.xml,"#set ($feedContent = $services.notification.notifiers.getFeed(20))
  #set ($characterEncoding = 'utf-8')
  #set ($discard = $response.setContentType('application/xml'))
  ## Make sure the Character Encoding response header matches the character encoding used to write the response and
  ## compute its length.
  #set ($discard = $response.setCharacterEncoding($characterEncoding))
  ## We write the output directly to the response to avoid the execution of the Rendering Transformations.
  #set ($discard = $response.writer.print($feedContent))
  ## The content length is measured in bytes and one character can use more than one byte.
  #set ($discard = $response.setContentLength($feedContent.getBytes($characterEncoding).size()))
  ## Make sure the entire content is send back to the client.
  #set ($discard = $response.flushBuffer())
  ## Make sure XWiki doesn't write any more content to the response.
  #set ($discard = $xcontext.setFinished(true))
  {{code language=""xml"" source=""script:feedContent"" /}}","  #set($discard = $response.setContentType('application/xml'))
  {{code language=""xml""}}
#end
$services.notification.notifiers.getFeed(20)
#if ($xcontext.action != 'get' || ""$request.outputSyntax"" != 'plain')
  {{/code}}",217e5bb7a657f2991b154a16ef4d5ae9c29ad39c,CVE-2023-36469,217e5bb7a657f2991b154a16ef4d5ae9c29ad39c,https://github.com/xwiki/xwiki-platform,NVD_DIRECT_COMMIT,1337,COMPLETED,"              {{VAR VAR=""VAR"" VAR=""VAR:VAR"" /}}  {{VAR VAR=""VAR""}}  $VAR.VAR.VAR.VAR(20)  {{/VAR}}",7,3
xwiki-platform_b0cdfd893912baaa053d106a92e39fa1858843c7,xwiki-platform-core/xwiki-platform-bridge/pom.xml,    <xwiki.jacoco.instructionRatio>0.50</xwiki.jacoco.instructionRatio>,    <xwiki.jacoco.instructionRatio>0.39</xwiki.jacoco.instructionRatio>,b0cdfd893912baaa053d106a92e39fa1858843c7,CVE-2023-36470,b0cdfd893912baaa053d106a92e39fa1858843c7,https://github.com/xwiki/xwiki-platform,NVD_DIRECT_COMMIT,1337,COMPLETED,<VAR.VAR.VAR>0.50</VAR.VAR.VAR> <VAR.VAR.VAR>0.39</VAR.VAR.VAR>,0,3
