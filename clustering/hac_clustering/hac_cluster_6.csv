commit,file,added_code,deleted_code,hash_clean,cve_id,hash,repo_url,rel_type,score,extraction_status,text_norm,cluster_kmeans,cluster_hac
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,README.md,"<p align=""center"">
  <a href=""https://useanything.com""><img src=""https://github.com/Mintplex-Labs/anything-llm/blob/master/images/wordmark.png?raw=true"" alt=""AnythingLLM logo""></a>
</p>

<p align=""center"">
    <b>AnythingLLM: A business-compliant document chatbot</b>. <br />
    A hyper-efficient and open-source enterprise-ready document chatbot solution for all.
</p>

<p align=""center"">
  <a href=""https://discord.gg/6UyHPeGZAC"" target=""_blank"">
      <img src=""https://dcbadge.vercel.app/api/server/6UyHPeGZAC?compact=true&style=flat"" alt=""Discord"">
  </a> |
  <a href=""https://github.com/Mintplex-Labs/anything-llm/blob/master/LICENSE"" target=""_blank"">
      <img src=""https://img.shields.io/static/v1?label=license&message=MIT&color=white"" alt=""License"">
  </a> |
  <a href=""https://docs.useanything.com"" target=""_blank"">
    Docs
  </a> |
   <a href=""https://my.mintplexlabs.com/aio-checkout?product=anythingllm"" target=""_blank"">
    Hosted Instance
  </a>
</p>

A full-stack application that enables you to turn any document, resource, or piece of content into context that any LLM can use as references during chatting. This application allows you to pick and choose which LLM or Vector Database you want to use. Currently this project supports [Pinecone](https://pinecone.io), [ChromaDB](https://trychroma.com) & more for vector storage and [OpenAI](https://openai.com) for LLM/chatting.


![Chatting](/images/screenshots/chat.png)
[view more screenshots](/images/screenshots/SCREENSHOTS.md)

### Watch the demo!

[![Watch the video](/images/youtube.png)](https://youtu.be/0vZ69AIP_hM)


### Product Overview
AnythingLLM aims to be a full-stack application where you can use commercial off-the-shelf LLMs or popular open source LLMs and vectorDB solutions.

Anything LLM is a full-stack product that you can run locally as well as host remotely and be able to chat intelligently with any documents you provide it.

AnythingLLM divides your documents into objects called `workspaces`. A Workspace functions a lot like a thread, but with the addition of containerization of your documents. Workspaces can share documents, but they do not talk to each other so you can keep your context for each workspace clean.

Some cool features of AnythingLLM
- Multi-user instance support and oversight
- Atomically manage documents in your vector database from a simple UI
- Two chat modes `conversation` and `query`. Conversation retains previous questions and amendments. Query is simple QA against your documents
- Each chat response contains a citation that is linked to the original content
- Simple technology stack for fast iteration
- 100% Cloud deployment ready.
- ""Bring your own LLM"" model. _still in progress - openai support only currently_
- Extremely efficient cost-saving measures for managing very large documents. You'll never pay to embed a massive document or transcript more than once. 90% more cost effective than other document chatbot solutions.
- Full Developer API for custom integrations!

### Technical Overview
This monorepo consists of three main sections:
- `collector`: Python tools that enable you to quickly convert online resources or local documents into LLM useable format.
- `frontend`: A viteJS + React frontend that you can run to easily create and manage all your content the LLM can use.
- `server`: A nodeJS + express server to handle all the interactions and do all the vectorDB management and LLM interactions.

### Requirements
- `yarn` and `node` on your machine
- `python` 3.9+ for running scripts in `collector/`.
- access to an LLM like `GPT-3.5`, `GPT-4`.
- a [Pinecone.io](https://pinecone.io) free account*.
*you can use drop in replacements for these. This is just the easiest to get up and running fast. We support multiple vector database providers.

## How to get started (Docker - simple setup)
[Get up and running in minutes with Docker](./docker/HOW_TO_USE_DOCKER.md)


### How to get started (Development environment)
- `yarn setup` from the project root directory.
  - This will fill in the required `.env` files you'll need in each of the application sections. Go fill those out before proceeding or else things won't work right.
- `cd frontend && yarn install && cd ../server && yarn install` from the project root directory.

To boot the server locally (run commands from root of repo):
- ensure `server/.env.development` is set and filled out.
`yarn dev:server`

To boot the frontend locally (run commands from root of repo):
- ensure `frontend/.env` is set and filled out.
- ensure `VITE_API_BASE=""http://localhost:3001/api""`
`yarn dev:frontend`

Next, you will need some content to embed. This could be a Youtube Channel, Medium articles, local text files, word documents, and the list goes on. This is where you will use the `collector/` part of the repo.

[Go set up and run collector scripts](./collector/README.md)

[Learn about documents](./server/storage/documents/DOCUMENTS.md)

[Learn about vector caching](./server/storage/vector-cache/VECTOR_CACHE.md)

## Contributing
- create issue
- create PR with branch name format of `<issue number>-<short name>`
- yee haw let's merge

## Telemetry
AnythingLLM by Mintplex Labs Inc contains a telemetry feature that collects anonymous usage information.

### Why?
We use this information to help us understand how AnythingLLM is used, to help us prioritize work on new features and bug fixes, and to help us improve AnythingLLM's performance and stability.

### Opting out
Set `DISABLE_TELEMETRY` in your server or docker .env settings to ""true"" to opt out of telemetry.

```
DISABLE_TELEMETRY=""true""
```

### What do you explicitly track?
We will only track usage details that help us make product and roadmap decisions, specifically:
- Version of your installation
- When a document is added or removed. No information _about_ the document. Just that the event occurred. This gives us an idea of use.
- Type of vector database in use. Let's us know which vector database provider is the most used to prioritize changes when updates arrive for that provider.
- Type of LLM in use. Let's us know the most popular choice and prioritize changes when updates arrive for that provider.
- Chat is sent. This is the most regular ""event"" and gives us an idea of the daily-activity of this project across all installations. Again, only the event is sent - we have no information on the nature or content of the chat itself.

You can verify these claims by finding all locations `Telemetry.sendTelemetry` is called. Additionally these events are written to the output log so you can also see the specific data which was sent - if enabled. No IP or other identifying information is collected. The Telemetry provider is [PostHog](https://posthog.com/) - an open-source telemetry collection service.",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"<VAR VAR=""VAR""> <VAR VAR=""VAR: </VAR> <VAR VAR=""VAR""> <VAR>VAR: VAR VAR-VAR VAR VAR</VAR>. <VAR /> VAR VAR-VAR VAR VAR-VAR VAR-VAR VAR VAR VAR VAR VAR. </VAR> <VAR VAR=""VAR""> <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: VAR </VAR> | <VAR VAR=""VAR: VAR VAR </VAR> </VAR> VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ![VAR](/VAR/VAR/VAR.VAR) [VAR VAR VAR](/VAR/VAR/VAR.VAR)  [![VAR VAR VAR](/VAR/VAR.VAR)](VAR:  VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR`. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR - VAR-VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR `VAR` VAR `VAR`. VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR - 100% VAR VAR VAR. - ""VAR VAR VAR VAR"" VAR. VAR VAR VAR - VAR VAR VAR VAR - VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. 90% VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR!  VAR VAR VAR VAR VAR VAR VAR: - `VAR`: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  - `VAR` VAR `VAR` VAR VAR VAR - `VAR` 3.9+ VAR VAR VAR VAR `VAR/`. - VAR VAR VAR VAR VAR `VAR-3.5`, `VAR-4`. - VAR [VAR.VAR](VAR: *VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.  [VAR VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR)  - `VAR VAR` VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR `.VAR` VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. - `VAR VAR && VAR VAR && VAR ../VAR && VAR VAR` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR.VAR` VAR VAR VAR VAR VAR. `VAR VAR:VAR` VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR` VAR VAR VAR VAR VAR. - VAR `VAR=""VAR: `VAR VAR:VAR` VAR, VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR VAR VAR VAR. [VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR) [VAR VAR VAR](./VAR/VAR/VAR/VAR.VAR) [VAR VAR VAR VAR](./VAR/VAR/VAR-VAR/VAR.VAR)  - VAR VAR - VAR VAR VAR VAR VAR VAR VAR `<VAR VAR>-<VAR VAR>` - VAR VAR VAR'VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR.  VAR `VAR` VAR VAR VAR VAR VAR .VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR. ``` VAR=""VAR"" ```  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR: - VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR. VAR VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR, VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ",6,6
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/components/WorkspaceChat/ChatContainer/index.jsx,"import { useState, useEffect } from ""react"";
import ChatHistory from ""./ChatHistory"";
import PromptInput from ""./PromptInput"";
import Workspace from ""../../../models/workspace"";
import handleChat from ""../../../utils/chat"";
import { isMobile } from ""react-device-detect"";
import { SidebarMobileHeader } from ""../../Sidebar"";

export default function ChatContainer({ workspace, knownHistory = [] }) {
  const [message, setMessage] = useState("""");
  const [loadingResponse, setLoadingResponse] = useState(false);
  const [chatHistory, setChatHistory] = useState(knownHistory);

  const handleMessageChange = (event) => {
    setMessage(event.target.value);
  };

  const handleSubmit = async (event) => {
    event.preventDefault();
    if (!message || message === """") return false;

    const prevChatHistory = [
      ...chatHistory,
      { content: message, role: ""user"" },
      {
        content: """",
        role: ""assistant"",
        pending: true,
        userMessage: message,
        animate: true,
      },
    ];

    setChatHistory(prevChatHistory);
    setMessage("""");
    setLoadingResponse(true);
  };

  useEffect(() => {
    async function fetchReply() {
      const promptMessage =
        chatHistory.length > 0 ? chatHistory[chatHistory.length - 1] : null;
      const remHistory = chatHistory.length > 0 ? chatHistory.slice(0, -1) : [];
      var _chatHistory = [...remHistory];

      if (!promptMessage || !promptMessage?.userMessage) {
        setLoadingResponse(false);
        return false;
      }

      const chatResult = await Workspace.sendChat(
        workspace,
        promptMessage.userMessage,
        window.localStorage.getItem(`workspace_chat_mode_${workspace.slug}`) ??
          ""chat""
      );
      handleChat(
        chatResult,
        setLoadingResponse,
        setChatHistory,
        remHistory,
        _chatHistory
      );
    }
    loadingResponse === true && fetchReply();
  }, [loadingResponse, chatHistory, workspace]);

  return (
    <div
      style={{ height: isMobile ? ""100%"" : ""calc(100% - 32px)"" }}
      className=""transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] bg-white dark:bg-black-900 w-full md:min-w-[82%] p-[18px] h-full overflow-y-scroll""
    >
      {isMobile && <SidebarMobileHeader />}
      <div className=""flex flex-col h-full w-full flex"">
        <ChatHistory history={chatHistory} workspace={workspace} />
        <PromptInput
          workspace={workspace}
          message={message}
          submit={handleSubmit}
          onChange={handleMessageChange}
          inputDisabled={loadingResponse}
          buttonDisabled={loadingResponse}
        />
      </div>
    </div>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR""; VAR VAR VAR VAR({ VAR, VAR = [] }) { VAR [VAR, VAR] = VAR(""""); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = (VAR) => { VAR(VAR.VAR.VAR); }; VAR VAR = VAR (VAR) => { VAR.VAR(); VAR (!VAR || VAR === """") VAR VAR; VAR VAR = [ ...VAR, { VAR: VAR, VAR: ""VAR"" }, { VAR: """", VAR: ""VAR"", VAR: VAR, VAR: VAR, VAR: VAR, }, ]; VAR(VAR); VAR(""""); VAR(VAR); }; VAR(() => { VAR VAR VAR() { VAR VAR = VAR.VAR > 0 ? VAR[VAR.VAR - 1] : VAR; VAR VAR = VAR.VAR > 0 ? VAR.VAR(0, -1) : []; VAR VAR = [...VAR]; VAR (!VAR || !VAR?.VAR) { VAR(VAR); VAR VAR; } VAR VAR = VAR VAR.VAR( VAR, VAR.VAR, VAR.VAR.VAR(`VAR${VAR.VAR}`) ?? ""VAR"" ); VAR( VAR, VAR, VAR, VAR, VAR ); } VAR === VAR && VAR(); }, [VAR, VAR, VAR]); VAR ( <VAR VAR={{ VAR: VAR ? ""100%"" : ""VAR(100% - 32px)"" }} VAR=""VAR-VAR VAR-500 VAR VAR:VAR-[2px] VAR:VAR-[8px] VAR:VAR-[16px] VAR:VAR-[26px] VAR-VAR VAR:VAR-VAR-900 VAR-VAR VAR:VAR-VAR-[82%] VAR-[18px] VAR-VAR VAR-VAR-VAR"" > {VAR && <VAR />} <VAR VAR=""VAR VAR-VAR VAR-VAR VAR-VAR VAR""> <VAR VAR={VAR} VAR={VAR} /> <VAR VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} /> </VAR> </VAR> ); } ",0,6
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/index.css,"@tailwind base;
@tailwind components;
@tailwind utilities;

html,
body {
  padding: 0;
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,
    Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
  background-color: white;
}

a {
  color: inherit;
  text-decoration: none;
}

* {
  box-sizing: border-box;
}

.g327 {
  border-color: #302f30;
}

@font-face {
  font-family: ""AvenirNextW10-Bold"";
  src: url(""../public/fonts/AvenirNext.ttf"");
}

.Avenir {
  font-family: AvenirNextW10-Bold;
  font-display: swap;
}

.grr {
  grid-template-columns: repeat(2, 1fr);
}

.greyC {
  filter: gray;
  -webkit-filter: grayscale(100%);
  transition: 0.4s;
}

.greyC:hover {
  filter: none;
  -webkit-filter: none;
  transition: 0.4s;
}

.chat__message {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message 0.15s ease-out 0s forwards;
  animation-delay: 500ms;
}

@keyframes message {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
    padding-top: 1rem;
  }
}

.doc__source {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message2 0.15s ease-out 0s forwards;
  animation-delay: 50ms;
}

@keyframes message2 {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
  }
}

@media (prefers-color-scheme: light) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(255 255 255) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: dark) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(20 20 20) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: light) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(220, 221, 223, 10%),
      rgb(220, 221, 223) 89%
    );
  }
}

@media (prefers-color-scheme: dark) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(41, 37, 36, 50%),
      rgb(41 37 36) 90%
    );
  }
}

/**
 * ==============================================
 * Dot Falling
 * ==============================================
 */
.dot-falling {
  position: relative;
  left: -9999px;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  box-shadow: 9999px 0 0 0 #5fa4fa;
  animation: dot-falling 1.5s infinite linear;
  animation-delay: 0.1s;
}

.dot-falling::before,
.dot-falling::after {
  content: """";
  display: inline-block;
  position: absolute;
  top: 0;
}

.dot-falling::before {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-before 1.5s infinite linear;
  animation-delay: 0s;
}

.dot-falling::after {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-after 1.5s infinite linear;
  animation-delay: 0.2s;
}

@keyframes dot-falling {
  0% {
    box-shadow: 9999px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9999px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9999px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-before {
  0% {
    box-shadow: 9984px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9984px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9984px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-after {
  0% {
    box-shadow: 10014px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 10014px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 10014px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

#chat-history::-webkit-scrollbar,
#chat-container::-webkit-scrollbar,
.no-scroll::-webkit-scrollbar {
  display: none !important;
}

/* Hide scrollbar for IE, Edge and Firefox */
#chat-history,
#chat-container,
.no-scroll {
  -ms-overflow-style: none !important;
  /* IE and Edge */
  scrollbar-width: none !important;
  /* Firefox */
}

.z-99 {
  z-index: 99;
}

.z-98 {
  z-index: 98;
}

.file-uploader {
  width: 100% !important;
  height: 100px !important;
}

.grid-loader > circle {
  fill: #008eff;
}

dialog {
  pointer-events: none;
  opacity: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

dialog[open] {
  opacity: 1;
  pointer-events: inherit;
}

dialog::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(2px);
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"@VAR VAR; @VAR VAR; @VAR VAR; VAR, VAR { VAR: 0; VAR: 0; VAR-VAR: -VAR-VAR, VAR, VAR VAR, VAR, VAR, VAR, VAR, VAR VAR, VAR VAR, VAR VAR, VAR-VAR; VAR-VAR: VAR; } VAR { VAR: VAR; VAR-VAR: VAR; } * { VAR-VAR: VAR-VAR; } .VAR { VAR-VAR:  } @VAR-VAR { VAR-VAR: ""VAR-VAR""; VAR: VAR(""../VAR/VAR/VAR.VAR""); } .VAR { VAR-VAR: VAR-VAR; VAR-VAR: VAR; } .VAR { VAR-VAR-VAR: VAR(2, 1fr); } .VAR { VAR: VAR; -VAR-VAR: VAR(100%); VAR: 0.4s; } .VAR:VAR { VAR: VAR; -VAR-VAR: VAR; VAR: 0.4s; } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 500ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; VAR-VAR: 1rem; } } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 50ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(255 255 255) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(20 20 20) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(220, 221, 223, 10%), VAR(220, 221, 223) 89% ); } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(41, 37, 36, 50%), VAR(41 37 36) 90% ); } } /** * ============================================== * VAR VAR * ============================================== */ .VAR-VAR { VAR: VAR; VAR: -9999px; VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR-VAR: 9999px 0 0 0  VAR: VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.1s; } .VAR-VAR::VAR, .VAR-VAR::VAR { VAR: """"; VAR: VAR-VAR; VAR: VAR; VAR: 0; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0s; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.2s; } @VAR VAR-VAR { 0% { VAR-VAR: 9999px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9999px 0 0 0  } 100% { VAR-VAR: 9999px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 9984px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9984px 0 0 0  } 100% { VAR-VAR: 9984px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 10014px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 10014px 0 0 0  } 100% { VAR-VAR: 10014px 15px 0 0 VAR(152, 128, 255, 0); } }   .VAR-VAR::-VAR-VAR { VAR: VAR !VAR; }    .VAR-VAR { -VAR-VAR-VAR: VAR !VAR;  VAR-VAR: VAR !VAR;  } .VAR-99 { VAR-VAR: 99; } .VAR-98 { VAR-VAR: 98; } .VAR-VAR { VAR: 100% !VAR; VAR: 100px !VAR; } .VAR-VAR > VAR { VAR:  } VAR { VAR-VAR: VAR; VAR: 0; VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; } VAR[VAR] { VAR: 1; VAR-VAR: VAR; } VAR::VAR { VAR: VAR(0, 0, 0, 0.5); VAR-VAR: VAR(2px); } ",0,6
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Invite/index.jsx,"import React, { useEffect, useState } from ""react"";
import { useParams } from ""react-router-dom"";
import { FullScreenLoader } from ""../../components/Preloader"";
import Invite from ""../../models/invite"";
import NewUserModal from ""./NewUserModal"";

export default function InvitePage() {
  const { code } = useParams();
  const [result, setResult] = useState({
    status: ""loading"",
    message: null,
  });

  useEffect(() => {
    async function checkInvite() {
      if (!code) {
        setResult({
          status: ""invalid"",
          message: ""No invite code provided."",
        });
        return;
      }
      const { invite, error } = await Invite.checkInvite(code);
      setResult({
        status: invite ? ""valid"" : ""invalid"",
        message: error,
      });
    }
    checkInvite();
  }, []);

  if (result.status === ""loading"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
        <FullScreenLoader />
      </div>
    );
  }

  if (result.status === ""invalid"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex items-center justify-center"">
        <p className=""text-red-600 text-lg"">{result.message}</p>
      </div>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-gray-100 dark:bg-stone-900 flex items-center justify-center"">
      <NewUserModal />
    </div>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR({ VAR: ""VAR"", VAR: VAR, }); VAR(() => { VAR VAR VAR() { VAR (!VAR) { VAR({ VAR: ""VAR"", VAR: ""VAR VAR VAR VAR."", }); VAR; } VAR { VAR, VAR } = VAR VAR.VAR(VAR); VAR({ VAR: VAR ? ""VAR"" : ""VAR"", VAR: VAR, }); } VAR(); }, []); VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> <VAR /> </VAR> ); } VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR-VAR-600 VAR-VAR"">{VAR.VAR}</VAR> </VAR> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-900 VAR VAR-VAR VAR-VAR""> <VAR /> </VAR> ); } ",6,6
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/Main/index.jsx,"import React from ""react"";
import DefaultChatContainer from ""../../components/DefaultChat"";
import Sidebar from ""../../components/Sidebar"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function Main() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <DefaultChatContainer />
    </div>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR ""VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> ); } ",6,6
anything-llm_3c88aec034934bcbad30c5ef1cab62cbbdb98e64,frontend/src/pages/WorkspaceChat/index.jsx,"import React, { useEffect, useState } from ""react"";
import { default as WorkspaceChatContainer } from ""../../components/WorkspaceChat"";
import Sidebar from ""../../components/Sidebar"";
import { useParams } from ""react-router-dom"";
import Workspace from ""../../models/workspace"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function WorkspaceChat() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return <ShowWorkspaceChat />;
}

function ShowWorkspaceChat() {
  const { slug } = useParams();
  const [workspace, setWorkspace] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function getWorkspace() {
      if (!slug) return;
      const _workspace = await Workspace.bySlug(slug);
      setWorkspace(_workspace);
      setLoading(false);
    }
    getWorkspace();
  }, []);

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <WorkspaceChatContainer loading={loading} workspace={workspace} />
    </div>
  );
}",,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,CVE-2023-4897,3c88aec034934bcbad30c5ef1cab62cbbdb98e64,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR VAR VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR <VAR />; } VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(VAR); VAR(VAR); VAR(VAR); } VAR(); }, []); VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR VAR={VAR} VAR={VAR} /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,README.md,"<p align=""center"">
  <a href=""https://useanything.com""><img src=""https://github.com/Mintplex-Labs/anything-llm/blob/master/images/wordmark.png?raw=true"" alt=""AnythingLLM logo""></a>
</p>

<p align=""center"">
    <b>AnythingLLM: A business-compliant document chatbot</b>. <br />
    A hyper-efficient and open-source enterprise-ready document chatbot solution for all.
</p>

<p align=""center"">
  <a href=""https://discord.gg/6UyHPeGZAC"" target=""_blank"">
      <img src=""https://dcbadge.vercel.app/api/server/6UyHPeGZAC?compact=true&style=flat"" alt=""Discord"">
  </a> |
  <a href=""https://github.com/Mintplex-Labs/anything-llm/blob/master/LICENSE"" target=""_blank"">
      <img src=""https://img.shields.io/static/v1?label=license&message=MIT&color=white"" alt=""License"">
  </a> |
  <a href=""https://docs.useanything.com"" target=""_blank"">
    Docs
  </a> |
   <a href=""https://my.mintplexlabs.com/aio-checkout?product=anythingllm"" target=""_blank"">
    Hosted Instance
  </a>
</p>

A full-stack application that enables you to turn any document, resource, or piece of content into context that any LLM can use as references during chatting. This application allows you to pick and choose which LLM or Vector Database you want to use. Currently this project supports [Pinecone](https://pinecone.io), [ChromaDB](https://trychroma.com) & more for vector storage and [OpenAI](https://openai.com) for LLM/chatting.


![Chatting](/images/screenshots/chat.png)
[view more screenshots](/images/screenshots/SCREENSHOTS.md)

### Watch the demo!

[![Watch the video](/images/youtube.png)](https://youtu.be/0vZ69AIP_hM)


### Product Overview
AnythingLLM aims to be a full-stack application where you can use commercial off-the-shelf LLMs or popular open source LLMs and vectorDB solutions.

Anything LLM is a full-stack product that you can run locally as well as host remotely and be able to chat intelligently with any documents you provide it.

AnythingLLM divides your documents into objects called `workspaces`. A Workspace functions a lot like a thread, but with the addition of containerization of your documents. Workspaces can share documents, but they do not talk to each other so you can keep your context for each workspace clean.

Some cool features of AnythingLLM
- Multi-user instance support and oversight
- Atomically manage documents in your vector database from a simple UI
- Two chat modes `conversation` and `query`. Conversation retains previous questions and amendments. Query is simple QA against your documents
- Each chat response contains a citation that is linked to the original content
- Simple technology stack for fast iteration
- 100% Cloud deployment ready.
- ""Bring your own LLM"" model. _still in progress - openai support only currently_
- Extremely efficient cost-saving measures for managing very large documents. You'll never pay to embed a massive document or transcript more than once. 90% more cost effective than other document chatbot solutions.
- Full Developer API for custom integrations!

### Technical Overview
This monorepo consists of three main sections:
- `collector`: Python tools that enable you to quickly convert online resources or local documents into LLM useable format.
- `frontend`: A viteJS + React frontend that you can run to easily create and manage all your content the LLM can use.
- `server`: A nodeJS + express server to handle all the interactions and do all the vectorDB management and LLM interactions.

### Requirements
- `yarn` and `node` on your machine
- `python` 3.9+ for running scripts in `collector/`.
- access to an LLM like `GPT-3.5`, `GPT-4`.
- a [Pinecone.io](https://pinecone.io) free account*.
*you can use drop in replacements for these. This is just the easiest to get up and running fast. We support multiple vector database providers.

## How to get started (Docker - simple setup)
[Get up and running in minutes with Docker](./docker/HOW_TO_USE_DOCKER.md)


### How to get started (Development environment)
- `yarn setup` from the project root directory.
  - This will fill in the required `.env` files you'll need in each of the application sections. Go fill those out before proceeding or else things won't work right.
- `cd frontend && yarn install && cd ../server && yarn install` from the project root directory.

To boot the server locally (run commands from root of repo):
- ensure `server/.env.development` is set and filled out.
`yarn dev:server`

To boot the frontend locally (run commands from root of repo):
- ensure `frontend/.env` is set and filled out.
- ensure `VITE_API_BASE=""http://localhost:3001/api""`
`yarn dev:frontend`

Next, you will need some content to embed. This could be a Youtube Channel, Medium articles, local text files, word documents, and the list goes on. This is where you will use the `collector/` part of the repo.

[Go set up and run collector scripts](./collector/README.md)

[Learn about documents](./server/storage/documents/DOCUMENTS.md)

[Learn about vector caching](./server/storage/vector-cache/VECTOR_CACHE.md)

## Contributing
- create issue
- create PR with branch name format of `<issue number>-<short name>`
- yee haw let's merge

## Telemetry
AnythingLLM by Mintplex Labs Inc contains a telemetry feature that collects anonymous usage information.

### Why?
We use this information to help us understand how AnythingLLM is used, to help us prioritize work on new features and bug fixes, and to help us improve AnythingLLM's performance and stability.

### Opting out
Set `DISABLE_TELEMETRY` in your server or docker .env settings to ""true"" to opt out of telemetry.

```
DISABLE_TELEMETRY=""true""
```

### What do you explicitly track?
We will only track usage details that help us make product and roadmap decisions, specifically:
- Version of your installation
- When a document is added or removed. No information _about_ the document. Just that the event occurred. This gives us an idea of use.
- Type of vector database in use. Let's us know which vector database provider is the most used to prioritize changes when updates arrive for that provider.
- Type of LLM in use. Let's us know the most popular choice and prioritize changes when updates arrive for that provider.
- Chat is sent. This is the most regular ""event"" and gives us an idea of the daily-activity of this project across all installations. Again, only the event is sent - we have no information on the nature or content of the chat itself.

You can verify these claims by finding all locations `Telemetry.sendTelemetry` is called. Additionally these events are written to the output log so you can also see the specific data which was sent - if enabled. No IP or other identifying information is collected. The Telemetry provider is [PostHog](https://posthog.com/) - an open-source telemetry collection service.",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"<VAR VAR=""VAR""> <VAR VAR=""VAR: </VAR> <VAR VAR=""VAR""> <VAR>VAR: VAR VAR-VAR VAR VAR</VAR>. <VAR /> VAR VAR-VAR VAR VAR-VAR VAR-VAR VAR VAR VAR VAR VAR. </VAR> <VAR VAR=""VAR""> <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: VAR </VAR> | <VAR VAR=""VAR: VAR VAR </VAR> </VAR> VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ![VAR](/VAR/VAR/VAR.VAR) [VAR VAR VAR](/VAR/VAR/VAR.VAR)  [![VAR VAR VAR](/VAR/VAR.VAR)](VAR:  VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR`. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR - VAR-VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR `VAR` VAR `VAR`. VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR - 100% VAR VAR VAR. - ""VAR VAR VAR VAR"" VAR. VAR VAR VAR - VAR VAR VAR VAR - VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. 90% VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR!  VAR VAR VAR VAR VAR VAR VAR: - `VAR`: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  - `VAR` VAR `VAR` VAR VAR VAR - `VAR` 3.9+ VAR VAR VAR VAR `VAR/`. - VAR VAR VAR VAR VAR `VAR-3.5`, `VAR-4`. - VAR [VAR.VAR](VAR: *VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.  [VAR VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR)  - `VAR VAR` VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR `.VAR` VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. - `VAR VAR && VAR VAR && VAR ../VAR && VAR VAR` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR.VAR` VAR VAR VAR VAR VAR. `VAR VAR:VAR` VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR` VAR VAR VAR VAR VAR. - VAR `VAR=""VAR: `VAR VAR:VAR` VAR, VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR VAR VAR VAR. [VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR) [VAR VAR VAR](./VAR/VAR/VAR/VAR.VAR) [VAR VAR VAR VAR](./VAR/VAR/VAR-VAR/VAR.VAR)  - VAR VAR - VAR VAR VAR VAR VAR VAR VAR `<VAR VAR>-<VAR VAR>` - VAR VAR VAR'VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR.  VAR `VAR` VAR VAR VAR VAR VAR .VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR. ``` VAR=""VAR"" ```  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR: - VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR. VAR VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR, VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,README.md,"<p align=""center"">
  <a href=""https://useanything.com""><img src=""https://github.com/Mintplex-Labs/anything-llm/blob/master/images/wordmark.png?raw=true"" alt=""AnythingLLM logo""></a>
</p>

<p align=""center"">
    <b>AnythingLLM: A business-compliant document chatbot</b>. <br />
    A hyper-efficient and open-source enterprise-ready document chatbot solution for all.
</p>

<p align=""center"">
  <a href=""https://discord.gg/6UyHPeGZAC"" target=""_blank"">
      <img src=""https://dcbadge.vercel.app/api/server/6UyHPeGZAC?compact=true&style=flat"" alt=""Discord"">
  </a> |
  <a href=""https://github.com/Mintplex-Labs/anything-llm/blob/master/LICENSE"" target=""_blank"">
      <img src=""https://img.shields.io/static/v1?label=license&message=MIT&color=white"" alt=""License"">
  </a> |
  <a href=""https://docs.useanything.com"" target=""_blank"">
    Docs
  </a> |
   <a href=""https://my.mintplexlabs.com/aio-checkout?product=anythingllm"" target=""_blank"">
    Hosted Instance
  </a>
</p>

A full-stack application that enables you to turn any document, resource, or piece of content into context that any LLM can use as references during chatting. This application allows you to pick and choose which LLM or Vector Database you want to use. Currently this project supports [Pinecone](https://pinecone.io), [ChromaDB](https://trychroma.com) & more for vector storage and [OpenAI](https://openai.com) for LLM/chatting.


![Chatting](/images/screenshots/chat.png)
[view more screenshots](/images/screenshots/SCREENSHOTS.md)

### Watch the demo!

[![Watch the video](/images/youtube.png)](https://youtu.be/0vZ69AIP_hM)


### Product Overview
AnythingLLM aims to be a full-stack application where you can use commercial off-the-shelf LLMs or popular open source LLMs and vectorDB solutions.

Anything LLM is a full-stack product that you can run locally as well as host remotely and be able to chat intelligently with any documents you provide it.

AnythingLLM divides your documents into objects called `workspaces`. A Workspace functions a lot like a thread, but with the addition of containerization of your documents. Workspaces can share documents, but they do not talk to each other so you can keep your context for each workspace clean.

Some cool features of AnythingLLM
- Multi-user instance support and oversight
- Atomically manage documents in your vector database from a simple UI
- Two chat modes `conversation` and `query`. Conversation retains previous questions and amendments. Query is simple QA against your documents
- Each chat response contains a citation that is linked to the original content
- Simple technology stack for fast iteration
- 100% Cloud deployment ready.
- ""Bring your own LLM"" model. _still in progress - openai support only currently_
- Extremely efficient cost-saving measures for managing very large documents. You'll never pay to embed a massive document or transcript more than once. 90% more cost effective than other document chatbot solutions.
- Full Developer API for custom integrations!

### Technical Overview
This monorepo consists of three main sections:
- `collector`: Python tools that enable you to quickly convert online resources or local documents into LLM useable format.
- `frontend`: A viteJS + React frontend that you can run to easily create and manage all your content the LLM can use.
- `server`: A nodeJS + express server to handle all the interactions and do all the vectorDB management and LLM interactions.

### Requirements
- `yarn` and `node` on your machine
- `python` 3.9+ for running scripts in `collector/`.
- access to an LLM like `GPT-3.5`, `GPT-4`.
- a [Pinecone.io](https://pinecone.io) free account*.
*you can use drop in replacements for these. This is just the easiest to get up and running fast. We support multiple vector database providers.

## How to get started (Docker - simple setup)
[Get up and running in minutes with Docker](./docker/HOW_TO_USE_DOCKER.md)


### How to get started (Development environment)
- `yarn setup` from the project root directory.
  - This will fill in the required `.env` files you'll need in each of the application sections. Go fill those out before proceeding or else things won't work right.
- `cd frontend && yarn install && cd ../server && yarn install` from the project root directory.

To boot the server locally (run commands from root of repo):
- ensure `server/.env.development` is set and filled out.
`yarn dev:server`

To boot the frontend locally (run commands from root of repo):
- ensure `frontend/.env` is set and filled out.
- ensure `VITE_API_BASE=""http://localhost:3001/api""`
`yarn dev:frontend`

Next, you will need some content to embed. This could be a Youtube Channel, Medium articles, local text files, word documents, and the list goes on. This is where you will use the `collector/` part of the repo.

[Go set up and run collector scripts](./collector/README.md)

[Learn about documents](./server/storage/documents/DOCUMENTS.md)

[Learn about vector caching](./server/storage/vector-cache/VECTOR_CACHE.md)

## Contributing
- create issue
- create PR with branch name format of `<issue number>-<short name>`
- yee haw let's merge

## Telemetry
AnythingLLM by Mintplex Labs Inc contains a telemetry feature that collects anonymous usage information.

### Why?
We use this information to help us understand how AnythingLLM is used, to help us prioritize work on new features and bug fixes, and to help us improve AnythingLLM's performance and stability.

### Opting out
Set `DISABLE_TELEMETRY` in your server or docker .env settings to ""true"" to opt out of telemetry.

```
DISABLE_TELEMETRY=""true""
```

### What do you explicitly track?
We will only track usage details that help us make product and roadmap decisions, specifically:
- Version of your installation
- When a document is added or removed. No information _about_ the document. Just that the event occurred. This gives us an idea of use.
- Type of vector database in use. Let's us know which vector database provider is the most used to prioritize changes when updates arrive for that provider.
- Type of LLM in use. Let's us know the most popular choice and prioritize changes when updates arrive for that provider.
- Chat is sent. This is the most regular ""event"" and gives us an idea of the daily-activity of this project across all installations. Again, only the event is sent - we have no information on the nature or content of the chat itself.

You can verify these claims by finding all locations `Telemetry.sendTelemetry` is called. Additionally these events are written to the output log so you can also see the specific data which was sent - if enabled. No IP or other identifying information is collected. The Telemetry provider is [PostHog](https://posthog.com/) - an open-source telemetry collection service.",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"<VAR VAR=""VAR""> <VAR VAR=""VAR: </VAR> <VAR VAR=""VAR""> <VAR>VAR: VAR VAR-VAR VAR VAR</VAR>. <VAR /> VAR VAR-VAR VAR VAR-VAR VAR-VAR VAR VAR VAR VAR VAR. </VAR> <VAR VAR=""VAR""> <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> | <VAR VAR=""VAR: VAR </VAR> | <VAR VAR=""VAR: VAR VAR </VAR> </VAR> VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ![VAR](/VAR/VAR/VAR.VAR) [VAR VAR VAR](/VAR/VAR/VAR.VAR)  [![VAR VAR VAR](/VAR/VAR.VAR)](VAR:  VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR`. VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR - VAR-VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR `VAR` VAR `VAR`. VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR - 100% VAR VAR VAR. - ""VAR VAR VAR VAR"" VAR. VAR VAR VAR - VAR VAR VAR VAR - VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. 90% VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR!  VAR VAR VAR VAR VAR VAR VAR: - `VAR`: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - `VAR`: VAR VAR + VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  - `VAR` VAR `VAR` VAR VAR VAR - `VAR` 3.9+ VAR VAR VAR VAR `VAR/`. - VAR VAR VAR VAR VAR `VAR-3.5`, `VAR-4`. - VAR [VAR.VAR](VAR: *VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR.  [VAR VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR)  - `VAR VAR` VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR `.VAR` VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR. - `VAR VAR && VAR VAR && VAR ../VAR && VAR VAR` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR.VAR` VAR VAR VAR VAR VAR. `VAR VAR:VAR` VAR VAR VAR VAR VAR (VAR VAR VAR VAR VAR VAR): - VAR `VAR/.VAR` VAR VAR VAR VAR VAR. - VAR `VAR=""VAR: `VAR VAR:VAR` VAR, VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR, VAR VAR, VAR VAR VAR, VAR VAR, VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR `VAR/` VAR VAR VAR VAR. [VAR VAR VAR VAR VAR VAR VAR](./VAR/VAR.VAR) [VAR VAR VAR](./VAR/VAR/VAR/VAR.VAR) [VAR VAR VAR VAR](./VAR/VAR/VAR-VAR/VAR.VAR)  - VAR VAR - VAR VAR VAR VAR VAR VAR VAR `<VAR VAR>-<VAR VAR>` - VAR VAR VAR'VAR VAR  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR.  VAR `VAR` VAR VAR VAR VAR VAR .VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR. ``` VAR=""VAR"" ```  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR: - VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR. VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR. VAR VAR VAR VAR VAR ""VAR"" VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR, VAR VAR VAR VAR VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR.VAR` VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR [VAR](VAR: ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/components/WorkspaceChat/ChatContainer/index.jsx,"import { useState, useEffect } from ""react"";
import ChatHistory from ""./ChatHistory"";
import PromptInput from ""./PromptInput"";
import Workspace from ""../../../models/workspace"";
import handleChat from ""../../../utils/chat"";
import { isMobile } from ""react-device-detect"";
import { SidebarMobileHeader } from ""../../Sidebar"";

export default function ChatContainer({ workspace, knownHistory = [] }) {
  const [message, setMessage] = useState("""");
  const [loadingResponse, setLoadingResponse] = useState(false);
  const [chatHistory, setChatHistory] = useState(knownHistory);

  const handleMessageChange = (event) => {
    setMessage(event.target.value);
  };

  const handleSubmit = async (event) => {
    event.preventDefault();
    if (!message || message === """") return false;

    const prevChatHistory = [
      ...chatHistory,
      { content: message, role: ""user"" },
      {
        content: """",
        role: ""assistant"",
        pending: true,
        userMessage: message,
        animate: true,
      },
    ];

    setChatHistory(prevChatHistory);
    setMessage("""");
    setLoadingResponse(true);
  };

  useEffect(() => {
    async function fetchReply() {
      const promptMessage =
        chatHistory.length > 0 ? chatHistory[chatHistory.length - 1] : null;
      const remHistory = chatHistory.length > 0 ? chatHistory.slice(0, -1) : [];
      var _chatHistory = [...remHistory];

      if (!promptMessage || !promptMessage?.userMessage) {
        setLoadingResponse(false);
        return false;
      }

      const chatResult = await Workspace.sendChat(
        workspace,
        promptMessage.userMessage,
        window.localStorage.getItem(`workspace_chat_mode_${workspace.slug}`) ??
          ""chat""
      );
      handleChat(
        chatResult,
        setLoadingResponse,
        setChatHistory,
        remHistory,
        _chatHistory
      );
    }
    loadingResponse === true && fetchReply();
  }, [loadingResponse, chatHistory, workspace]);

  return (
    <div
      style={{ height: isMobile ? ""100%"" : ""calc(100% - 32px)"" }}
      className=""transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] bg-white dark:bg-black-900 w-full md:min-w-[82%] p-[18px] h-full overflow-y-scroll""
    >
      {isMobile && <SidebarMobileHeader />}
      <div className=""flex flex-col h-full w-full flex"">
        <ChatHistory history={chatHistory} workspace={workspace} />
        <PromptInput
          workspace={workspace}
          message={message}
          submit={handleSubmit}
          onChange={handleMessageChange}
          inputDisabled={loadingResponse}
          buttonDisabled={loadingResponse}
        />
      </div>
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR""; VAR VAR VAR VAR({ VAR, VAR = [] }) { VAR [VAR, VAR] = VAR(""""); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = (VAR) => { VAR(VAR.VAR.VAR); }; VAR VAR = VAR (VAR) => { VAR.VAR(); VAR (!VAR || VAR === """") VAR VAR; VAR VAR = [ ...VAR, { VAR: VAR, VAR: ""VAR"" }, { VAR: """", VAR: ""VAR"", VAR: VAR, VAR: VAR, VAR: VAR, }, ]; VAR(VAR); VAR(""""); VAR(VAR); }; VAR(() => { VAR VAR VAR() { VAR VAR = VAR.VAR > 0 ? VAR[VAR.VAR - 1] : VAR; VAR VAR = VAR.VAR > 0 ? VAR.VAR(0, -1) : []; VAR VAR = [...VAR]; VAR (!VAR || !VAR?.VAR) { VAR(VAR); VAR VAR; } VAR VAR = VAR VAR.VAR( VAR, VAR.VAR, VAR.VAR.VAR(`VAR${VAR.VAR}`) ?? ""VAR"" ); VAR( VAR, VAR, VAR, VAR, VAR ); } VAR === VAR && VAR(); }, [VAR, VAR, VAR]); VAR ( <VAR VAR={{ VAR: VAR ? ""100%"" : ""VAR(100% - 32px)"" }} VAR=""VAR-VAR VAR-500 VAR VAR:VAR-[2px] VAR:VAR-[8px] VAR:VAR-[16px] VAR:VAR-[26px] VAR-VAR VAR:VAR-VAR-900 VAR-VAR VAR:VAR-VAR-[82%] VAR-[18px] VAR-VAR VAR-VAR-VAR"" > {VAR && <VAR />} <VAR VAR=""VAR VAR-VAR VAR-VAR VAR-VAR VAR""> <VAR VAR={VAR} VAR={VAR} /> <VAR VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} /> </VAR> </VAR> ); } ",0,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/components/WorkspaceChat/ChatContainer/index.jsx,"import { useState, useEffect } from ""react"";
import ChatHistory from ""./ChatHistory"";
import PromptInput from ""./PromptInput"";
import Workspace from ""../../../models/workspace"";
import handleChat from ""../../../utils/chat"";
import { isMobile } from ""react-device-detect"";
import { SidebarMobileHeader } from ""../../Sidebar"";

export default function ChatContainer({ workspace, knownHistory = [] }) {
  const [message, setMessage] = useState("""");
  const [loadingResponse, setLoadingResponse] = useState(false);
  const [chatHistory, setChatHistory] = useState(knownHistory);

  const handleMessageChange = (event) => {
    setMessage(event.target.value);
  };

  const handleSubmit = async (event) => {
    event.preventDefault();
    if (!message || message === """") return false;

    const prevChatHistory = [
      ...chatHistory,
      { content: message, role: ""user"" },
      {
        content: """",
        role: ""assistant"",
        pending: true,
        userMessage: message,
        animate: true,
      },
    ];

    setChatHistory(prevChatHistory);
    setMessage("""");
    setLoadingResponse(true);
  };

  useEffect(() => {
    async function fetchReply() {
      const promptMessage =
        chatHistory.length > 0 ? chatHistory[chatHistory.length - 1] : null;
      const remHistory = chatHistory.length > 0 ? chatHistory.slice(0, -1) : [];
      var _chatHistory = [...remHistory];

      if (!promptMessage || !promptMessage?.userMessage) {
        setLoadingResponse(false);
        return false;
      }

      const chatResult = await Workspace.sendChat(
        workspace,
        promptMessage.userMessage,
        window.localStorage.getItem(`workspace_chat_mode_${workspace.slug}`) ??
          ""chat""
      );
      handleChat(
        chatResult,
        setLoadingResponse,
        setChatHistory,
        remHistory,
        _chatHistory
      );
    }
    loadingResponse === true && fetchReply();
  }, [loadingResponse, chatHistory, workspace]);

  return (
    <div
      style={{ height: isMobile ? ""100%"" : ""calc(100% - 32px)"" }}
      className=""transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] bg-white dark:bg-black-900 w-full md:min-w-[82%] p-[18px] h-full overflow-y-scroll""
    >
      {isMobile && <SidebarMobileHeader />}
      <div className=""flex flex-col h-full w-full flex"">
        <ChatHistory history={chatHistory} workspace={workspace} />
        <PromptInput
          workspace={workspace}
          message={message}
          submit={handleSubmit}
          onChange={handleMessageChange}
          inputDisabled={loadingResponse}
          buttonDisabled={loadingResponse}
        />
      </div>
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR { VAR, VAR } VAR ""VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR VAR VAR ""../../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR""; VAR VAR VAR VAR({ VAR, VAR = [] }) { VAR [VAR, VAR] = VAR(""""); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR VAR = (VAR) => { VAR(VAR.VAR.VAR); }; VAR VAR = VAR (VAR) => { VAR.VAR(); VAR (!VAR || VAR === """") VAR VAR; VAR VAR = [ ...VAR, { VAR: VAR, VAR: ""VAR"" }, { VAR: """", VAR: ""VAR"", VAR: VAR, VAR: VAR, VAR: VAR, }, ]; VAR(VAR); VAR(""""); VAR(VAR); }; VAR(() => { VAR VAR VAR() { VAR VAR = VAR.VAR > 0 ? VAR[VAR.VAR - 1] : VAR; VAR VAR = VAR.VAR > 0 ? VAR.VAR(0, -1) : []; VAR VAR = [...VAR]; VAR (!VAR || !VAR?.VAR) { VAR(VAR); VAR VAR; } VAR VAR = VAR VAR.VAR( VAR, VAR.VAR, VAR.VAR.VAR(`VAR${VAR.VAR}`) ?? ""VAR"" ); VAR( VAR, VAR, VAR, VAR, VAR ); } VAR === VAR && VAR(); }, [VAR, VAR, VAR]); VAR ( <VAR VAR={{ VAR: VAR ? ""100%"" : ""VAR(100% - 32px)"" }} VAR=""VAR-VAR VAR-500 VAR VAR:VAR-[2px] VAR:VAR-[8px] VAR:VAR-[16px] VAR:VAR-[26px] VAR-VAR VAR:VAR-VAR-900 VAR-VAR VAR:VAR-VAR-[82%] VAR-[18px] VAR-VAR VAR-VAR-VAR"" > {VAR && <VAR />} <VAR VAR=""VAR VAR-VAR VAR-VAR VAR-VAR VAR""> <VAR VAR={VAR} VAR={VAR} /> <VAR VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} VAR={VAR} /> </VAR> </VAR> ); } ",0,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/index.css,"@tailwind base;
@tailwind components;
@tailwind utilities;

html,
body {
  padding: 0;
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,
    Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
  background-color: white;
}

a {
  color: inherit;
  text-decoration: none;
}

* {
  box-sizing: border-box;
}

.g327 {
  border-color: #302f30;
}

@font-face {
  font-family: ""AvenirNextW10-Bold"";
  src: url(""../public/fonts/AvenirNext.ttf"");
}

.Avenir {
  font-family: AvenirNextW10-Bold;
  font-display: swap;
}

.grr {
  grid-template-columns: repeat(2, 1fr);
}

.greyC {
  filter: gray;
  -webkit-filter: grayscale(100%);
  transition: 0.4s;
}

.greyC:hover {
  filter: none;
  -webkit-filter: none;
  transition: 0.4s;
}

.chat__message {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message 0.15s ease-out 0s forwards;
  animation-delay: 500ms;
}

@keyframes message {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
    padding-top: 1rem;
  }
}

.doc__source {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message2 0.15s ease-out 0s forwards;
  animation-delay: 50ms;
}

@keyframes message2 {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
  }
}

@media (prefers-color-scheme: light) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(255 255 255) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: dark) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(20 20 20) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: light) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(220, 221, 223, 10%),
      rgb(220, 221, 223) 89%
    );
  }
}

@media (prefers-color-scheme: dark) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(41, 37, 36, 50%),
      rgb(41 37 36) 90%
    );
  }
}

/**
 * ==============================================
 * Dot Falling
 * ==============================================
 */
.dot-falling {
  position: relative;
  left: -9999px;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  box-shadow: 9999px 0 0 0 #5fa4fa;
  animation: dot-falling 1.5s infinite linear;
  animation-delay: 0.1s;
}

.dot-falling::before,
.dot-falling::after {
  content: """";
  display: inline-block;
  position: absolute;
  top: 0;
}

.dot-falling::before {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-before 1.5s infinite linear;
  animation-delay: 0s;
}

.dot-falling::after {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-after 1.5s infinite linear;
  animation-delay: 0.2s;
}

@keyframes dot-falling {
  0% {
    box-shadow: 9999px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9999px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9999px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-before {
  0% {
    box-shadow: 9984px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9984px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9984px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-after {
  0% {
    box-shadow: 10014px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 10014px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 10014px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

#chat-history::-webkit-scrollbar,
#chat-container::-webkit-scrollbar,
.no-scroll::-webkit-scrollbar {
  display: none !important;
}

/* Hide scrollbar for IE, Edge and Firefox */
#chat-history,
#chat-container,
.no-scroll {
  -ms-overflow-style: none !important;
  /* IE and Edge */
  scrollbar-width: none !important;
  /* Firefox */
}

.z-99 {
  z-index: 99;
}

.z-98 {
  z-index: 98;
}

.file-uploader {
  width: 100% !important;
  height: 100px !important;
}

.grid-loader > circle {
  fill: #008eff;
}

dialog {
  pointer-events: none;
  opacity: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

dialog[open] {
  opacity: 1;
  pointer-events: inherit;
}

dialog::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(2px);
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"@VAR VAR; @VAR VAR; @VAR VAR; VAR, VAR { VAR: 0; VAR: 0; VAR-VAR: -VAR-VAR, VAR, VAR VAR, VAR, VAR, VAR, VAR, VAR VAR, VAR VAR, VAR VAR, VAR-VAR; VAR-VAR: VAR; } VAR { VAR: VAR; VAR-VAR: VAR; } * { VAR-VAR: VAR-VAR; } .VAR { VAR-VAR:  } @VAR-VAR { VAR-VAR: ""VAR-VAR""; VAR: VAR(""../VAR/VAR/VAR.VAR""); } .VAR { VAR-VAR: VAR-VAR; VAR-VAR: VAR; } .VAR { VAR-VAR-VAR: VAR(2, 1fr); } .VAR { VAR: VAR; -VAR-VAR: VAR(100%); VAR: 0.4s; } .VAR:VAR { VAR: VAR; -VAR-VAR: VAR; VAR: 0.4s; } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 500ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; VAR-VAR: 1rem; } } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 50ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(255 255 255) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(20 20 20) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(220, 221, 223, 10%), VAR(220, 221, 223) 89% ); } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(41, 37, 36, 50%), VAR(41 37 36) 90% ); } } /** * ============================================== * VAR VAR * ============================================== */ .VAR-VAR { VAR: VAR; VAR: -9999px; VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR-VAR: 9999px 0 0 0  VAR: VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.1s; } .VAR-VAR::VAR, .VAR-VAR::VAR { VAR: """"; VAR: VAR-VAR; VAR: VAR; VAR: 0; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0s; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.2s; } @VAR VAR-VAR { 0% { VAR-VAR: 9999px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9999px 0 0 0  } 100% { VAR-VAR: 9999px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 9984px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9984px 0 0 0  } 100% { VAR-VAR: 9984px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 10014px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 10014px 0 0 0  } 100% { VAR-VAR: 10014px 15px 0 0 VAR(152, 128, 255, 0); } }   .VAR-VAR::-VAR-VAR { VAR: VAR !VAR; }    .VAR-VAR { -VAR-VAR-VAR: VAR !VAR;  VAR-VAR: VAR !VAR;  } .VAR-99 { VAR-VAR: 99; } .VAR-98 { VAR-VAR: 98; } .VAR-VAR { VAR: 100% !VAR; VAR: 100px !VAR; } .VAR-VAR > VAR { VAR:  } VAR { VAR-VAR: VAR; VAR: 0; VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; } VAR[VAR] { VAR: 1; VAR-VAR: VAR; } VAR::VAR { VAR: VAR(0, 0, 0, 0.5); VAR-VAR: VAR(2px); } ",0,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/index.css,"@tailwind base;
@tailwind components;
@tailwind utilities;

html,
body {
  padding: 0;
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,
    Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
  background-color: white;
}

a {
  color: inherit;
  text-decoration: none;
}

* {
  box-sizing: border-box;
}

.g327 {
  border-color: #302f30;
}

@font-face {
  font-family: ""AvenirNextW10-Bold"";
  src: url(""../public/fonts/AvenirNext.ttf"");
}

.Avenir {
  font-family: AvenirNextW10-Bold;
  font-display: swap;
}

.grr {
  grid-template-columns: repeat(2, 1fr);
}

.greyC {
  filter: gray;
  -webkit-filter: grayscale(100%);
  transition: 0.4s;
}

.greyC:hover {
  filter: none;
  -webkit-filter: none;
  transition: 0.4s;
}

.chat__message {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message 0.15s ease-out 0s forwards;
  animation-delay: 500ms;
}

@keyframes message {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
    padding-top: 1rem;
  }
}

.doc__source {
  transform-origin: 0 100%;
  transform: scale(0);
  animation: message2 0.15s ease-out 0s forwards;
  animation-delay: 50ms;
}

@keyframes message2 {
  0% {
    max-height: 100%;
  }

  80% {
    transform: scale(1.1);
  }

  100% {
    transform: scale(1);
    max-height: 100%;
    overflow: visible;
  }
}

@media (prefers-color-scheme: light) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(255 255 255) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: dark) {
  .sidebar-items:after {
    content: "" "";
    position: absolute;
    left: 0;
    right: 0px;
    height: 4em;
    top: 69vh;
    background: linear-gradient(
      to bottom,
      rgba(173, 3, 3, 0),
      rgb(20 20 20) 50%
    );
    z-index: 1;
    pointer-events: none;
  }
}

@media (prefers-color-scheme: light) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(220, 221, 223, 10%),
      rgb(220, 221, 223) 89%
    );
  }
}

@media (prefers-color-scheme: dark) {
  .fade-up-border {
    background: linear-gradient(
      to bottom,
      rgba(41, 37, 36, 50%),
      rgb(41 37 36) 90%
    );
  }
}

/**
 * ==============================================
 * Dot Falling
 * ==============================================
 */
.dot-falling {
  position: relative;
  left: -9999px;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  box-shadow: 9999px 0 0 0 #5fa4fa;
  animation: dot-falling 1.5s infinite linear;
  animation-delay: 0.1s;
}

.dot-falling::before,
.dot-falling::after {
  content: """";
  display: inline-block;
  position: absolute;
  top: 0;
}

.dot-falling::before {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-before 1.5s infinite linear;
  animation-delay: 0s;
}

.dot-falling::after {
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: #5fa4fa;
  color: #5fa4fa;
  animation: dot-falling-after 1.5s infinite linear;
  animation-delay: 0.2s;
}

@keyframes dot-falling {
  0% {
    box-shadow: 9999px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9999px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9999px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-before {
  0% {
    box-shadow: 9984px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 9984px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 9984px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

@keyframes dot-falling-after {
  0% {
    box-shadow: 10014px -15px 0 0 rgba(152, 128, 255, 0);
  }

  25%,
  50%,
  75% {
    box-shadow: 10014px 0 0 0 #5fa4fa;
  }

  100% {
    box-shadow: 10014px 15px 0 0 rgba(152, 128, 255, 0);
  }
}

#chat-history::-webkit-scrollbar,
#chat-container::-webkit-scrollbar,
.no-scroll::-webkit-scrollbar {
  display: none !important;
}

/* Hide scrollbar for IE, Edge and Firefox */
#chat-history,
#chat-container,
.no-scroll {
  -ms-overflow-style: none !important;
  /* IE and Edge */
  scrollbar-width: none !important;
  /* Firefox */
}

.z-99 {
  z-index: 99;
}

.z-98 {
  z-index: 98;
}

.file-uploader {
  width: 100% !important;
  height: 100px !important;
}

.grid-loader > circle {
  fill: #008eff;
}

dialog {
  pointer-events: none;
  opacity: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

dialog[open] {
  opacity: 1;
  pointer-events: inherit;
}

dialog::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(2px);
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"@VAR VAR; @VAR VAR; @VAR VAR; VAR, VAR { VAR: 0; VAR: 0; VAR-VAR: -VAR-VAR, VAR, VAR VAR, VAR, VAR, VAR, VAR, VAR VAR, VAR VAR, VAR VAR, VAR-VAR; VAR-VAR: VAR; } VAR { VAR: VAR; VAR-VAR: VAR; } * { VAR-VAR: VAR-VAR; } .VAR { VAR-VAR:  } @VAR-VAR { VAR-VAR: ""VAR-VAR""; VAR: VAR(""../VAR/VAR/VAR.VAR""); } .VAR { VAR-VAR: VAR-VAR; VAR-VAR: VAR; } .VAR { VAR-VAR-VAR: VAR(2, 1fr); } .VAR { VAR: VAR; -VAR-VAR: VAR(100%); VAR: 0.4s; } .VAR:VAR { VAR: VAR; -VAR-VAR: VAR; VAR: 0.4s; } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 500ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; VAR-VAR: 1rem; } } .VAR { VAR-VAR: 0 100%; VAR: VAR(0); VAR: VAR 0.15s VAR-VAR 0s VAR; VAR-VAR: 50ms; } @VAR VAR { 0% { VAR-VAR: 100%; } 80% { VAR: VAR(1.1); } 100% { VAR: VAR(1); VAR-VAR: 100%; VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(255 255 255) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR:VAR { VAR: "" ""; VAR: VAR; VAR: 0; VAR: 0px; VAR: 4em; VAR: 69vh; VAR: VAR-VAR( VAR VAR, VAR(173, 3, 3, 0), VAR(20 20 20) 50% ); VAR-VAR: 1; VAR-VAR: VAR; } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(220, 221, 223, 10%), VAR(220, 221, 223) 89% ); } } @VAR (VAR-VAR-VAR: VAR) { .VAR-VAR-VAR { VAR: VAR-VAR( VAR VAR, VAR(41, 37, 36, 50%), VAR(41 37 36) 90% ); } } /** * ============================================== * VAR VAR * ============================================== */ .VAR-VAR { VAR: VAR; VAR: -9999px; VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR-VAR: 9999px 0 0 0  VAR: VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.1s; } .VAR-VAR::VAR, .VAR-VAR::VAR { VAR: """"; VAR: VAR-VAR; VAR: VAR; VAR: 0; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0s; } .VAR-VAR::VAR { VAR: 10px; VAR: 10px; VAR-VAR: 5px; VAR-VAR:  VAR:  VAR: VAR-VAR-VAR 1.5s VAR VAR; VAR-VAR: 0.2s; } @VAR VAR-VAR { 0% { VAR-VAR: 9999px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9999px 0 0 0  } 100% { VAR-VAR: 9999px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 9984px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 9984px 0 0 0  } 100% { VAR-VAR: 9984px 15px 0 0 VAR(152, 128, 255, 0); } } @VAR VAR-VAR-VAR { 0% { VAR-VAR: 10014px -15px 0 0 VAR(152, 128, 255, 0); } 25%, 50%, 75% { VAR-VAR: 10014px 0 0 0  } 100% { VAR-VAR: 10014px 15px 0 0 VAR(152, 128, 255, 0); } }   .VAR-VAR::-VAR-VAR { VAR: VAR !VAR; }    .VAR-VAR { -VAR-VAR-VAR: VAR !VAR;  VAR-VAR: VAR !VAR;  } .VAR-99 { VAR-VAR: 99; } .VAR-98 { VAR-VAR: 98; } .VAR-VAR { VAR: 100% !VAR; VAR: 100px !VAR; } .VAR-VAR > VAR { VAR:  } VAR { VAR-VAR: VAR; VAR: 0; VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; VAR-VAR: VAR; } VAR[VAR] { VAR: 1; VAR-VAR: VAR; } VAR::VAR { VAR: VAR(0, 0, 0, 0.5); VAR-VAR: VAR(2px); } ",0,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Invite/index.jsx,"import React, { useEffect, useState } from ""react"";
import { useParams } from ""react-router-dom"";
import { FullScreenLoader } from ""../../components/Preloader"";
import Invite from ""../../models/invite"";
import NewUserModal from ""./NewUserModal"";

export default function InvitePage() {
  const { code } = useParams();
  const [result, setResult] = useState({
    status: ""loading"",
    message: null,
  });

  useEffect(() => {
    async function checkInvite() {
      if (!code) {
        setResult({
          status: ""invalid"",
          message: ""No invite code provided."",
        });
        return;
      }
      const { invite, error } = await Invite.checkInvite(code);
      setResult({
        status: invite ? ""valid"" : ""invalid"",
        message: error,
      });
    }
    checkInvite();
  }, []);

  if (result.status === ""loading"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
        <FullScreenLoader />
      </div>
    );
  }

  if (result.status === ""invalid"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex items-center justify-center"">
        <p className=""text-red-600 text-lg"">{result.message}</p>
      </div>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-gray-100 dark:bg-stone-900 flex items-center justify-center"">
      <NewUserModal />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR({ VAR: ""VAR"", VAR: VAR, }); VAR(() => { VAR VAR VAR() { VAR (!VAR) { VAR({ VAR: ""VAR"", VAR: ""VAR VAR VAR VAR."", }); VAR; } VAR { VAR, VAR } = VAR VAR.VAR(VAR); VAR({ VAR: VAR ? ""VAR"" : ""VAR"", VAR: VAR, }); } VAR(); }, []); VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> <VAR /> </VAR> ); } VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR-VAR-600 VAR-VAR"">{VAR.VAR}</VAR> </VAR> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-900 VAR VAR-VAR VAR-VAR""> <VAR /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Invite/index.jsx,"import React, { useEffect, useState } from ""react"";
import { useParams } from ""react-router-dom"";
import { FullScreenLoader } from ""../../components/Preloader"";
import Invite from ""../../models/invite"";
import NewUserModal from ""./NewUserModal"";

export default function InvitePage() {
  const { code } = useParams();
  const [result, setResult] = useState({
    status: ""loading"",
    message: null,
  });

  useEffect(() => {
    async function checkInvite() {
      if (!code) {
        setResult({
          status: ""invalid"",
          message: ""No invite code provided."",
        });
        return;
      }
      const { invite, error } = await Invite.checkInvite(code);
      setResult({
        status: invite ? ""valid"" : ""invalid"",
        message: error,
      });
    }
    checkInvite();
  }, []);

  if (result.status === ""loading"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
        <FullScreenLoader />
      </div>
    );
  }

  if (result.status === ""invalid"") {
    return (
      <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex items-center justify-center"">
        <p className=""text-red-600 text-lg"">{result.message}</p>
      </div>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-gray-100 dark:bg-stone-900 flex items-center justify-center"">
      <NewUserModal />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR { VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""./VAR""; VAR VAR VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR({ VAR: ""VAR"", VAR: VAR, }); VAR(() => { VAR VAR VAR() { VAR (!VAR) { VAR({ VAR: ""VAR"", VAR: ""VAR VAR VAR VAR."", }); VAR; } VAR { VAR, VAR } = VAR VAR.VAR(VAR); VAR({ VAR: VAR ? ""VAR"" : ""VAR"", VAR: VAR, }); } VAR(); }, []); VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> <VAR /> </VAR> ); } VAR (VAR.VAR === ""VAR"") { VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR VAR-VAR VAR-VAR""> <VAR VAR=""VAR-VAR-600 VAR-VAR"">{VAR.VAR}</VAR> </VAR> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-900 VAR VAR-VAR VAR-VAR""> <VAR /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Main/index.jsx,"import React from ""react"";
import DefaultChatContainer from ""../../components/DefaultChat"";
import Sidebar from ""../../components/Sidebar"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function Main() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <DefaultChatContainer />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR ""VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/Main/index.jsx,"import React from ""react"";
import DefaultChatContainer from ""../../components/DefaultChat"";
import Sidebar from ""../../components/Sidebar"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function Main() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <DefaultChatContainer />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR ""VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/WorkspaceChat/index.jsx,"import React, { useEffect, useState } from ""react"";
import { default as WorkspaceChatContainer } from ""../../components/WorkspaceChat"";
import Sidebar from ""../../components/Sidebar"";
import { useParams } from ""react-router-dom"";
import Workspace from ""../../models/workspace"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function WorkspaceChat() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return <ShowWorkspaceChat />;
}

function ShowWorkspaceChat() {
  const { slug } = useParams();
  const [workspace, setWorkspace] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function getWorkspace() {
      if (!slug) return;
      const _workspace = await Workspace.bySlug(slug);
      setWorkspace(_workspace);
      setLoading(false);
    }
    getWorkspace();
  }, []);

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <WorkspaceChatContainer loading={loading} workspace={workspace} />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4899,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR VAR VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR <VAR />; } VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(VAR); VAR(VAR); VAR(VAR); } VAR(); }, []); VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR VAR={VAR} VAR={VAR} /> </VAR> ); } ",6,6
anything-llm_dc3dfbf31495fe316b21ee184b9317b38101d30e,frontend/src/pages/WorkspaceChat/index.jsx,"import React, { useEffect, useState } from ""react"";
import { default as WorkspaceChatContainer } from ""../../components/WorkspaceChat"";
import Sidebar from ""../../components/Sidebar"";
import { useParams } from ""react-router-dom"";
import Workspace from ""../../models/workspace"";
import SidebarPlaceholder from ""../../components/Sidebar/Placeholder"";
import ChatPlaceholder from ""../../components/WorkspaceChat/LoadingChat"";
import PasswordModal, {
  usePasswordModal,
} from ""../../components/Modals/Password"";
import { isMobile } from ""react-device-detect"";

export default function WorkspaceChat() {
  const { requiresAuth, mode } = usePasswordModal();
  if (requiresAuth === null || requiresAuth) {
    return (
      <>
        {requiresAuth && <PasswordModal mode={mode} />}
        <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
          {!isMobile && <SidebarPlaceholder />}
          <ChatPlaceholder />
        </div>
      </>
    );
  }

  return <ShowWorkspaceChat />;
}

function ShowWorkspaceChat() {
  const { slug } = useParams();
  const [workspace, setWorkspace] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function getWorkspace() {
      if (!slug) return;
      const _workspace = await Workspace.bySlug(slug);
      setWorkspace(_workspace);
      setLoading(false);
    }
    getWorkspace();
  }, []);

  return (
    <div className=""w-screen h-screen overflow-hidden bg-orange-100 dark:bg-stone-700 flex"">
      {!isMobile && <Sidebar />}
      <WorkspaceChatContainer loading={loading} workspace={workspace} />
    </div>
  );
}",,dc3dfbf31495fe316b21ee184b9317b38101d30e,CVE-2023-4898,dc3dfbf31495fe316b21ee184b9317b38101d30e,https://github.com/mintplex-labs/anything-llm,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR, { VAR, VAR } VAR ""VAR""; VAR { VAR VAR VAR } VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR ""../../VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR VAR ""../../VAR/VAR/VAR""; VAR VAR, { VAR, } VAR ""../../VAR/VAR/VAR""; VAR { VAR } VAR ""VAR-VAR-VAR""; VAR VAR VAR VAR() { VAR { VAR, VAR } = VAR(); VAR (VAR === VAR || VAR) { VAR ( <> {VAR && <VAR VAR={VAR} />} <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR /> </VAR> </> ); } VAR <VAR />; } VAR VAR() { VAR { VAR } = VAR(); VAR [VAR, VAR] = VAR(VAR); VAR [VAR, VAR] = VAR(VAR); VAR(() => { VAR VAR VAR() { VAR (!VAR) VAR; VAR VAR = VAR VAR.VAR(VAR); VAR(VAR); VAR(VAR); } VAR(); }, []); VAR ( <VAR VAR=""VAR-VAR VAR-VAR VAR-VAR VAR-VAR-100 VAR:VAR-VAR-700 VAR""> {!VAR && <VAR />} <VAR VAR={VAR} VAR={VAR} /> </VAR> ); } ",6,6
argo-cd_3800a1e49d1d5a00a6692fee83396a37a6abe89a,util/oidc/oidc.go,"var InvalidRedirectURLError = fmt.Errorf(""invalid return URL"")

	redirectURL := a.baseHRef
		if !isValidRedirectURL(parts[1], []string{a.settings.URL}) {
			sanitizedUrl := parts[1]
			if len(sanitizedUrl) > 100 {
				sanitizedUrl = sanitizedUrl[:100]
			}
			log.Warnf(""Failed to verify app state - got invalid redirectURL %q"", sanitizedUrl)
			return """", fmt.Errorf(""failed to verify app state: %w"", InvalidRedirectURLError)
		}
		redirectURL = parts[1]
	return redirectURL, nil","	returnURL := a.baseHRef
		returnURL = parts[1]
	return returnURL, nil",3800a1e49d1d5a00a6692fee83396a37a6abe89a,CVE-2022-31102,3800a1e49d1d5a00a6692fee83396a37a6abe89a,https://github.com/argoproj/argo-cd,GHSD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = VAR.VAR(""VAR VAR VAR"") VAR := VAR.VAR VAR !VAR(VAR[1], []VAR{VAR.VAR.VAR}) { VAR := VAR[1] VAR VAR(VAR) > 100 { VAR = VAR[:100] } VAR.VAR(""VAR VAR VAR VAR VAR - VAR VAR VAR %VAR"", VAR) VAR """", VAR.VAR(""VAR VAR VAR VAR VAR: %VAR"", VAR) } VAR = VAR[1] VAR VAR, VAR VAR := VAR.VAR VAR = VAR[1] VAR VAR, VAR",6,6
argo-cd_44e52c4ae76e6da1343bdd54e57a822d93549f28,util/helm/client_test.go,"	""math""
	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, math.MaxInt64, true)
func Test_nativeHelmChart_ExtractChartWithLimiter(t *testing.T) {
	client := NewClient(""https://argoproj.github.io/argo-helm"", Creds{}, false, """")
	_, _, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, 100, false)
	assert.Error(t, err, ""error while iterating on tar reader: unexpected EOF"")
}

	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, math.MaxInt64, true)","	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false)
	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false)",44e52c4ae76e6da1343bdd54e57a822d93549f28,CVE-2023-40029,44e52c4ae76e6da1343bdd54e57a822d93549f28,https://github.com/argoproj/argo-cd,GHSD_DIRECT_COMMIT,1337,COMPLETED,"""VAR"" VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, VAR.VAR, VAR) VAR VAR(VAR *VAR.VAR) { VAR := VAR(""VAR: VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, 100, VAR) VAR.VAR(VAR, VAR, ""VAR VAR VAR VAR VAR VAR: VAR VAR"") } VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, VAR.VAR, VAR) VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR) VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR)",6,6
argo-cd_b8f92c4ff226346624f43de3f25d81dac6386674,util/helm/client_test.go,"	""math""
	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, math.MaxInt64, true)
func Test_nativeHelmChart_ExtractChartWithLimiter(t *testing.T) {
	client := NewClient(""https://argoproj.github.io/argo-helm"", Creds{}, false, """")
	_, _, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, 100, false)
	assert.Error(t, err, ""error while iterating on tar reader: unexpected EOF"")
}

	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false, math.MaxInt64, true)","	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false)
	path, closer, err := client.ExtractChart(""argo-cd"", ""0.7.1"", false)",b8f92c4ff226346624f43de3f25d81dac6386674,CVE-2023-40584,b8f92c4ff226346624f43de3f25d81dac6386674,https://github.com/argoproj/argo-cd,NVD_DIRECT_COMMIT,1337,COMPLETED,"""VAR"" VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, VAR.VAR, VAR) VAR VAR(VAR *VAR.VAR) { VAR := VAR(""VAR: VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, 100, VAR) VAR.VAR(VAR, VAR, ""VAR VAR VAR VAR VAR VAR: VAR VAR"") } VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR, VAR.VAR, VAR) VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR) VAR, VAR, VAR := VAR.VAR(""VAR-VAR"", ""0.7.1"", VAR)",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,data_source_profiles.php,"	html_start_box( __('RRA [edit: %s %s]', html_escape($name), ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');","	html_start_box( __('RRA [edit: %s %s]', $name, ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-3816,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,110,COMPLETED,"VAR( VAR('VAR [VAR: %VAR %VAR]', VAR($VAR), ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', ''); VAR( VAR('VAR [VAR: %VAR %VAR]', $VAR, ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,data_source_profiles.php,"	html_start_box( __('RRA [edit: %s %s]', html_escape($name), ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');","	html_start_box( __('RRA [edit: %s %s]', $name, ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-23225,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,110,COMPLETED,"VAR( VAR('VAR [VAR: %VAR %VAR]', VAR($VAR), ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', ''); VAR( VAR('VAR [VAR: %VAR %VAR]', $VAR, ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,data_source_profiles.php,"	html_start_box( __('RRA [edit: %s %s]', html_escape($name), ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');","	html_start_box( __('RRA [edit: %s %s]', $name, ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-26247,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,102,COMPLETED,"VAR( VAR('VAR [VAR: %VAR %VAR]', VAR($VAR), ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', ''); VAR( VAR('VAR [VAR: %VAR %VAR]', $VAR, ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,data_source_profiles.php,"	html_start_box( __('RRA [edit: %s %s]', html_escape($name), ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');","	html_start_box( __('RRA [edit: %s %s]', $name, ($readonly ? __('(Some Elements Read Only)'):'')), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2022-48547,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,110,COMPLETED,"VAR( VAR('VAR [VAR: %VAR %VAR]', VAR($VAR), ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', ''); VAR( VAR('VAR [VAR: %VAR %VAR]', $VAR, ($VAR ? VAR('(VAR VAR VAR VAR)'):'')), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,links.php,"		html_start_box(__('External Links [edit: %s]', html_escape($data['title'])), '100%', true, '3', 'center', '');","		html_start_box(__('External Links [edit: %s]', $data['title']), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-3816,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,110,COMPLETED,"VAR(VAR('VAR VAR [VAR: %VAR]', VAR($VAR['VAR'])), '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR VAR [VAR: %VAR]', $VAR['VAR']), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,links.php,"		html_start_box(__('External Links [edit: %s]', html_escape($data['title'])), '100%', true, '3', 'center', '');","		html_start_box(__('External Links [edit: %s]', $data['title']), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-23225,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,110,COMPLETED,"VAR(VAR('VAR VAR [VAR: %VAR]', VAR($VAR['VAR'])), '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR VAR [VAR: %VAR]', $VAR['VAR']), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,links.php,"		html_start_box(__('External Links [edit: %s]', html_escape($data['title'])), '100%', true, '3', 'center', '');","		html_start_box(__('External Links [edit: %s]', $data['title']), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2021-26247,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,CPE_GIT_REPOBASED,102,COMPLETED,"VAR(VAR('VAR VAR [VAR: %VAR]', VAR($VAR['VAR'])), '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR VAR [VAR: %VAR]', $VAR['VAR']), '100%', VAR, '3', 'VAR', '');",6,6
cacti_2b8097c06030ab72c5b3bdadb23dceb5332f0e94,links.php,"		html_start_box(__('External Links [edit: %s]', html_escape($data['title'])), '100%', true, '3', 'center', '');","		html_start_box(__('External Links [edit: %s]', $data['title']), '100%', true, '3', 'center', '');",2b8097c06030ab72c5b3bdadb23dceb5332f0e94,CVE-2022-48547,2b8097c06030ab72c5b3bdadb23dceb5332f0e94,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,110,COMPLETED,"VAR(VAR('VAR VAR [VAR: %VAR]', VAR($VAR['VAR'])), '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR VAR [VAR: %VAR]', $VAR['VAR']), '100%', VAR, '3', 'VAR', '');",6,6
cacti_3381cba6a9e36b01ed0ab0acfd41b00487966cb5,lihtml_validate.php,"	<table style='width:100%;text-align:center;'>
				<?php print __('Validation error for variable %s with a value of %s.  See backtrace below for more details.', $variable, htmlspecialchars($value));?>
	cacti_debug_backtrace('Validation Error' . ($variable != '' ? "", Variable:$variable"":'') . ($value != '' ? "", Value:$value"":''), true);","	<table style=""width:100%;text-align:center;"">
				Validation error<?php print ($variable != '' ? ' for variable ' . $variable . ', with value of ""' . $value . '""' . ($message != '' ? ', and error:' . $message : '') : '');?>.  See backtrace below for more details.
	cacti_debug_backtrace('Validation Error' . ($variable != '' ? "", Variable:$variable"":"""") . ($value != '' ? "", Value:$value"":""""), true);",3381cba6a9e36b01ed0ab0acfd41b00487966cb5,CVE-2017-11163,3381cba6a9e36b01ed0ab0acfd41b00487966cb5,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,130,COMPLETED,"<VAR VAR='VAR:100%;VAR-VAR:VAR;'> <?VAR VAR VAR('VAR VAR VAR VAR %VAR VAR VAR VAR VAR %VAR. VAR VAR VAR VAR VAR VAR.', $VAR, VAR($VAR));?> VAR('VAR VAR' . ($VAR != '' ? "", VAR:$VAR"":'') . ($VAR != '' ? "", VAR:$VAR"":''), VAR); <VAR VAR=""VAR:100%;VAR-VAR:VAR;""> VAR VAR<?VAR VAR ($VAR != '' ? ' VAR VAR ' . $VAR . ', VAR VAR VAR ""' . $VAR . '""' . ($VAR != '' ? ', VAR VAR:' . $VAR : '') : '');?>. VAR VAR VAR VAR VAR VAR. VAR('VAR VAR' . ($VAR != '' ? "", VAR:$VAR"":"""") . ($VAR != '' ? "", VAR:$VAR"":""""), VAR);",6,6
cacti_3381cba6a9e36b01ed0ab0acfd41b00487966cb5,lihtml_validate.php,"	<table style='width:100%;text-align:center;'>
				<?php print __('Validation error for variable %s with a value of %s.  See backtrace below for more details.', $variable, htmlspecialchars($value));?>
	cacti_debug_backtrace('Validation Error' . ($variable != '' ? "", Variable:$variable"":'') . ($value != '' ? "", Value:$value"":''), true);","	<table style=""width:100%;text-align:center;"">
				Validation error<?php print ($variable != '' ? ' for variable ' . $variable . ', with value of ""' . $value . '""' . ($message != '' ? ', and error:' . $message : '') : '');?>.  See backtrace below for more details.
	cacti_debug_backtrace('Validation Error' . ($variable != '' ? "", Variable:$variable"":"""") . ($value != '' ? "", Value:$value"":""""), true);",3381cba6a9e36b01ed0ab0acfd41b00487966cb5,CVE-2017-10970,3381cba6a9e36b01ed0ab0acfd41b00487966cb5,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,138,COMPLETED,"<VAR VAR='VAR:100%;VAR-VAR:VAR;'> <?VAR VAR VAR('VAR VAR VAR VAR %VAR VAR VAR VAR VAR %VAR. VAR VAR VAR VAR VAR VAR.', $VAR, VAR($VAR));?> VAR('VAR VAR' . ($VAR != '' ? "", VAR:$VAR"":'') . ($VAR != '' ? "", VAR:$VAR"":''), VAR); <VAR VAR=""VAR:100%;VAR-VAR:VAR;""> VAR VAR<?VAR VAR ($VAR != '' ? ' VAR VAR ' . $VAR . ', VAR VAR VAR ""' . $VAR . '""' . ($VAR != '' ? ', VAR VAR:' . $VAR : '') : '');?>. VAR VAR VAR VAR VAR VAR. VAR('VAR VAR' . ($VAR != '' ? "", VAR:$VAR"":"""") . ($VAR != '' ? "", VAR:$VAR"":""""), VAR);",6,6
cacti_4cbb045e03ee20a2bd09094a201a925fbb8a39d9,lihtml_reports.php,"		$header_label = __esc('Report Item [edit Report: %s]', $report['name']);
		$header_label = __esc('Report Item [new Report: %s]', $report['name']);
		$header_label = __('[edit: %s]', $report['name']);
		html_start_box(__esc('Details %s', $header_label), '100%', true, '3', 'center', '');
		html_start_box(__esc('Items %s', $header_label), '100%', '', '3', 'center', get_reports_page() . '?action=item_edit&id=' . get_request_var('id'));
		html_start_box(__esc('Scheduled Events %s', $header_label), '100%', '', '3', 'center', '');
		html_start_box(__esc('Report Preview %s', $header_label), '100%', '', '0', 'center', '');","		$header_label = __('Report Item [edit Report: %s]', $report['name']);
		$header_label = __('Report Item [new Report: %s]', $report['name']);
		$header_label = __('[edit: %s]', html_escape($report['name']));
		html_start_box(__('Details') . "" $header_label"", '100%', true, '3', 'center', '');
		html_start_box(__('Items') . "" $header_label"", '100%', '', '3', 'center', get_reports_page() . '?action=item_edit&id=' . get_request_var('id'));
		html_start_box(__('Scheduled Events') . "" $header_label"", '100%', '', '3', 'center', '');
		html_start_box(__('Report Preview') . "" $header_label"", '100%', '', '0', 'center', '');",4cbb045e03ee20a2bd09094a201a925fbb8a39d9,CVE-2020-7106,4cbb045e03ee20a2bd09094a201a925fbb8a39d9,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,134,COMPLETED,"$VAR = VAR('VAR VAR [VAR VAR: %VAR]', $VAR['VAR']); $VAR = VAR('VAR VAR [VAR VAR: %VAR]', $VAR['VAR']); $VAR = VAR('[VAR: %VAR]', $VAR['VAR']); VAR(VAR('VAR %VAR', $VAR), '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR %VAR', $VAR), '100%', '', '3', 'VAR', VAR() . '?VAR=VAR&VAR=' . VAR('VAR')); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '0', 'VAR', ''); $VAR = VAR('VAR VAR [VAR VAR: %VAR]', $VAR['VAR']); $VAR = VAR('VAR VAR [VAR VAR: %VAR]', $VAR['VAR']); $VAR = VAR('[VAR: %VAR]', VAR($VAR['VAR'])); VAR(VAR('VAR') . "" $VAR"", '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR') . "" $VAR"", '100%', '', '3', 'VAR', VAR() . '?VAR=VAR&VAR=' . VAR('VAR')); VAR(VAR('VAR VAR') . "" $VAR"", '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR') . "" $VAR"", '100%', '', '0', 'VAR', '');",6,6
cacti_4cbb045e03ee20a2bd09094a201a925fbb8a39d9,user_admin.php,"			<div class='cactiTableTitle'><span style='padding:3px;'>"" . __('User Permissions') . "" "" . html_escape($header_label) . ""</span></div>
	html_start_box(__esc('User Settings %s', $header_label), '100%', true, '3', 'center', '');
		$header_label = __('[edit: %s]', $user['username']);
		html_start_box(__esc('User Management %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Graph Permissions %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Group Membership %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Devices Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Template Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Tree Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__esc('Tree Permission %s', $header_label), '100%', '', '3', 'center', '');","			<div class='cactiTableTitle'><span style='padding:3px;'>"" . __('User Permissions') . "" $header_label</span></div>
	html_start_box(__('User Settings %s', $header_label), '100%', true, '3', 'center', '');
		$header_label = __('[edit: %s]', html_escape($user['username']));
		html_start_box(__('User Management %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__('Graph Permissions %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box(__('Group Membership %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box(__('Devices Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box(__('Template Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box(__('Tree Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box(__('Tree Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');",4cbb045e03ee20a2bd09094a201a925fbb8a39d9,CVE-2020-7106,4cbb045e03ee20a2bd09094a201a925fbb8a39d9,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,134,COMPLETED,"<VAR VAR='VAR'><VAR VAR='VAR:3px;'>"" . VAR('VAR VAR') . "" "" . VAR($VAR) . ""</VAR></VAR> VAR(VAR('VAR VAR %VAR', $VAR), '100%', VAR, '3', 'VAR', ''); $VAR = VAR('[VAR: %VAR]', $VAR['VAR']); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); <VAR VAR='VAR'><VAR VAR='VAR:3px;'>"" . VAR('VAR VAR') . "" $VAR</VAR></VAR> VAR(VAR('VAR VAR %VAR', $VAR), '100%', VAR, '3', 'VAR', ''); $VAR = VAR('[VAR: %VAR]', VAR($VAR['VAR'])); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', '');",6,6
cacti_4cbb045e03ee20a2bd09094a201a925fbb8a39d9,user_group_admin.php,"			<div class='cactiTableTitle'><span style='padding:3px;'>"" . __('User Permissions') . "" "" . html_escape($header_label) . ""</span></div>
	html_start_box(__esc('User Settings %s', $header_label), '100%', true, '3', 'center', '');
		$header_label = __esc('User Group Management [edit: %s]', $group['name']);
		html_start_box($header_label, '100%', true, '3', 'center', '');
	html_start_box(__('Graph Permissions %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__('Devices Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__('Template Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__('Tree Permission %s', $header_label), '100%', '', '3', 'center', '');
	html_start_box(__('User Membership %s', $header_label), '100%', '', '3', 'center', '');","			<div class='cactiTableTitle'><span style='padding:3px;'>"" . __('User Permissions') . "" $header_label</span></div>
	html_start_box( __('User Settings %s', $header_label), '100%', true, '3', 'center', '');
		$header_label = __('User Group Management [edit: %s]', html_escape($group['name']));
		html_start_box( $header_label, '100%', true, '3', 'center', '');
	html_start_box( __('Graph Permissions %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box( __('Devices Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box( __('Template Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box( __('Tree Permission %s', html_escape($header_label)), '100%', '', '3', 'center', '');
	html_start_box( __('User Membership %s', html_escape($header_label)), '100%', '', '3', 'center', '');",4cbb045e03ee20a2bd09094a201a925fbb8a39d9,CVE-2020-7106,4cbb045e03ee20a2bd09094a201a925fbb8a39d9,https://github.com/Cacti/cacti,NVD_GIT_REPOBASED,134,COMPLETED,"<VAR VAR='VAR'><VAR VAR='VAR:3px;'>"" . VAR('VAR VAR') . "" "" . VAR($VAR) . ""</VAR></VAR> VAR(VAR('VAR VAR %VAR', $VAR), '100%', VAR, '3', 'VAR', ''); $VAR = VAR('VAR VAR VAR [VAR: %VAR]', $VAR['VAR']); VAR($VAR, '100%', VAR, '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); VAR(VAR('VAR VAR %VAR', $VAR), '100%', '', '3', 'VAR', ''); <VAR VAR='VAR'><VAR VAR='VAR:3px;'>"" . VAR('VAR VAR') . "" $VAR</VAR></VAR> VAR( VAR('VAR VAR %VAR', $VAR), '100%', VAR, '3', 'VAR', ''); $VAR = VAR('VAR VAR VAR [VAR: %VAR]', VAR($VAR['VAR'])); VAR( $VAR, '100%', VAR, '3', 'VAR', ''); VAR( VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR( VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR( VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR( VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', ''); VAR( VAR('VAR VAR %VAR', VAR($VAR)), '100%', '', '3', 'VAR', '');",6,6
cpython_511ca9452033ef95bc7d7fc404b8161068226002,Litest/test_sys.py,"        self.assertEqual(len(sys.int_info), 4)
        self.assertGreaterEqual(sys.int_info.default_max_str_digits, 500)
        self.assertGreaterEqual(sys.int_info.str_digits_check_threshold, 100)
        self.assertGreater(sys.int_info.default_max_str_digits,
                           sys.int_info.str_digits_check_threshold)
        self.assertIsInstance(sys.int_info.default_max_str_digits, int)
        self.assertIsInstance(sys.int_info.str_digits_check_threshold, int)
                 ""warn_default_encoding"", ""safe_path"", ""int_max_str_digits"")","        self.assertEqual(len(sys.int_info), 2)
                 ""warn_default_encoding"", ""safe_path"")",511ca9452033ef95bc7d7fc404b8161068226002,CVE-2020-10735,511ca9452033ef95bc7d7fc404b8161068226002,https://github.com/python/cpython,NVD_GIT_REPOBASED,186,COMPLETED,"VAR.VAR(VAR(VAR.VAR), 4) VAR.VAR(VAR.VAR.VAR, 500) VAR.VAR(VAR.VAR.VAR, 100) VAR.VAR(VAR.VAR.VAR, VAR.VAR.VAR) VAR.VAR(VAR.VAR.VAR, VAR) VAR.VAR(VAR.VAR.VAR, VAR) ""VAR"", ""VAR"", ""VAR"") VAR.VAR(VAR(VAR.VAR), 2) ""VAR"", ""VAR"")",6,6
cpython_8f0fa4bd10aba723aff988720cd26b93be99bc12,Litest/test_sys.py,"        self.assertEqual(len(sys.int_info), 4)
        self.assertGreaterEqual(sys.int_info.default_max_str_digits, 500)
        self.assertGreaterEqual(sys.int_info.str_digits_check_threshold, 100)
        self.assertGreater(sys.int_info.default_max_str_digits,
                           sys.int_info.str_digits_check_threshold)
        self.assertIsInstance(sys.int_info.default_max_str_digits, int)
        self.assertIsInstance(sys.int_info.str_digits_check_threshold, int)
                 ""warn_default_encoding"", ""int_max_str_digits"")","        self.assertEqual(len(sys.int_info), 2)
                 ""warn_default_encoding"")",8f0fa4bd10aba723aff988720cd26b93be99bc12,CVE-2020-10735,8f0fa4bd10aba723aff988720cd26b93be99bc12,https://github.com/python/cpython,NVD_GIT_REPOBASED,186,COMPLETED,"VAR.VAR(VAR(VAR.VAR), 4) VAR.VAR(VAR.VAR.VAR, 500) VAR.VAR(VAR.VAR.VAR, 100) VAR.VAR(VAR.VAR.VAR, VAR.VAR.VAR) VAR.VAR(VAR.VAR.VAR, VAR) VAR.VAR(VAR.VAR.VAR, VAR) ""VAR"", ""VAR"") VAR.VAR(VAR(VAR.VAR), 2) ""VAR"")",6,6
cpython_bb8071a4cae5ab3fe321481dd3d73662ffb26052,Litest/test_xmlrpc.py,"        conn.send('POST /RPC2 HTTP/1.0\r\n'
                  'Content-Length: 100\r\n\r\n'
                  'bye HTTP/1.1\r\n'
                  'Host: %s:%s\r\n'
                  'Accept-Encoding: identity\r\n'
                  'Content-Length: 0\r\n\r\n'
                  % (ADDR, PORT))","        conn.request('POST', '/RPC2 HTTP/1.0\r\nContent-Length: 100\r\n\r\nbye')",bb8071a4cae5ab3fe321481dd3d73662ffb26052,CVE-2019-9947,bb8071a4cae5ab3fe321481dd3d73662ffb26052,https://github.com/python/cpython,CPE_GIT_REPOBASED,96,COMPLETED,"VAR.VAR('VAR /VAR VAR/1.0\VAR\VAR' 'VAR-VAR: 100\VAR\VAR\VAR\VAR' 'VAR VAR/1.1\VAR\VAR' 'VAR: %VAR:%VAR\VAR\VAR' 'VAR-VAR: VAR\VAR\VAR' 'VAR-VAR: 0\VAR\VAR\VAR\VAR' % (VAR, VAR)) VAR.VAR('VAR', '/VAR VAR/1.0\VAR\VAR-VAR: 100\VAR\VAR\VAR\VAR')",6,6
cpython_bb8071a4cae5ab3fe321481dd3d73662ffb26052,Litest/test_xmlrpc.py,"        conn.send('POST /RPC2 HTTP/1.0\r\n'
                  'Content-Length: 100\r\n\r\n'
                  'bye HTTP/1.1\r\n'
                  'Host: %s:%s\r\n'
                  'Accept-Encoding: identity\r\n'
                  'Content-Length: 0\r\n\r\n'
                  % (ADDR, PORT))","        conn.request('POST', '/RPC2 HTTP/1.0\r\nContent-Length: 100\r\n\r\nbye')",bb8071a4cae5ab3fe321481dd3d73662ffb26052,CVE-2019-9740,bb8071a4cae5ab3fe321481dd3d73662ffb26052,https://github.com/python/cpython,CPE_GIT_REPOBASED,96,COMPLETED,"VAR.VAR('VAR /VAR VAR/1.0\VAR\VAR' 'VAR-VAR: 100\VAR\VAR\VAR\VAR' 'VAR VAR/1.1\VAR\VAR' 'VAR: %VAR:%VAR\VAR\VAR' 'VAR-VAR: VAR\VAR\VAR' 'VAR-VAR: 0\VAR\VAR\VAR\VAR' % (VAR, VAR)) VAR.VAR('VAR', '/VAR VAR/1.0\VAR\VAR-VAR: 100\VAR\VAR\VAR\VAR')",6,6
cpython_c50d437e942d4c4c45c8cd76329b05340c02eb31,Litest/test_xmlrpc.py,"        conn.send('POST /RPC2 HTTP/1.0\r\n'
                  'Content-Length: 100\r\n\r\n'
                  'bye HTTP/1.1\r\n'
                  f'Host: {ADDR}:{PORT}\r\n'
                  'Accept-Encoding: identity\r\n'
                  'Content-Length: 0\r\n\r\n'.encode('ascii'))","        conn.request('POST', '/RPC2 HTTP/1.0\r\nContent-Length: 100\r\n\r\nbye')",c50d437e942d4c4c45c8cd76329b05340c02eb31,CVE-2019-9947,c50d437e942d4c4c45c8cd76329b05340c02eb31,https://github.com/python/cpython,CPE_GIT_REPOBASED,98,COMPLETED,"VAR.VAR('VAR /VAR VAR/1.0\VAR\VAR' 'VAR-VAR: 100\VAR\VAR\VAR\VAR' 'VAR VAR/1.1\VAR\VAR' VAR'VAR: {VAR}:{VAR}\VAR\VAR' 'VAR-VAR: VAR\VAR\VAR' 'VAR-VAR: 0\VAR\VAR\VAR\VAR'.VAR('VAR')) VAR.VAR('VAR', '/VAR VAR/1.0\VAR\VAR-VAR: 100\VAR\VAR\VAR\VAR')",6,6
cpython_cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15,Litest/test_sys.py,"        self.assertEqual(len(sys.int_info), 4)
        self.assertGreaterEqual(sys.int_info.default_max_str_digits, 500)
        self.assertGreaterEqual(sys.int_info.str_digits_check_threshold, 100)
        self.assertGreater(sys.int_info.default_max_str_digits,
                           sys.int_info.str_digits_check_threshold)
        self.assertIsInstance(sys.int_info.default_max_str_digits, int)
        self.assertIsInstance(sys.int_info.str_digits_check_threshold, int)
                 ""hash_randomization"", ""isolated"", ""dev_mode"", ""utf8_mode"",
                 ""int_max_str_digits"")","        self.assertEqual(len(sys.int_info), 2)
                 ""hash_randomization"", ""isolated"", ""dev_mode"", ""utf8_mode"")",cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15,CVE-2020-10735,cec1e9dfd769bd3a16142d0fdd1a36f19c77ed15,https://github.com/python/cpython,NVD_GIT_REPOBASED,186,COMPLETED,"VAR.VAR(VAR(VAR.VAR), 4) VAR.VAR(VAR.VAR.VAR, 500) VAR.VAR(VAR.VAR.VAR, 100) VAR.VAR(VAR.VAR.VAR, VAR.VAR.VAR) VAR.VAR(VAR.VAR.VAR, VAR) VAR.VAR(VAR.VAR.VAR, VAR) ""VAR"", ""VAR"", ""VAR"", ""VAR"", ""VAR"") VAR.VAR(VAR(VAR.VAR), 2) ""VAR"", ""VAR"", ""VAR"", ""VAR"")",6,6
cpython_ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,Litest/test_httplib.py,"    def test_overflowing_header_limit_after_100(self):
        body = (
            'HTTP/1.1 100 OK\r\n'
            'r\n' * 32768
        )
        resp = client.HTTPResponse(FakeSocket(body))
        self.assertRaises(client.HTTPException, resp.begin)

        expected = {""responses""}  # Allowlist documented dict() object","        expected = {""responses""}  # White-list documented dict() object",ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,CVE-2021-3737,ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,https://github.com/python/cpython,GHSD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR(VAR): VAR = ( 'VAR/1.1 100 VAR\VAR\VAR' 'VAR\VAR' * 32768 ) VAR = VAR.VAR(VAR(VAR)) VAR.VAR(VAR.VAR, VAR.VAR) VAR = {""VAR""}  VAR = {""VAR""} ",6,6
cpython_ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,Misc/NEWS.d/next/Security/2021-05-05-17-37-04.bpo-44022.bS3XJ9.rst,"mod:`http.client` now avoids infinitely reading potential HTTP headers after a
``100 Continue`` status response from the server.",,ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,CVE-2021-3737,ea9327036680acc92d9f89eaf6f6a54d2f8d78d9,https://github.com/python/cpython,GHSD_DIRECT_COMMIT,1337,COMPLETED,VAR:`VAR.VAR` VAR VAR VAR VAR VAR VAR VAR VAR VAR ``100 VAR`` VAR VAR VAR VAR VAR. ,6,6
cpython_f8b71da9aac6ea74808dcdd0cc266e705431356b,Litest/test_sys.py,"        self.assertEqual(len(sys.int_info), 4)
        self.assertGreaterEqual(sys.int_info.default_max_str_digits, 500)
        self.assertGreaterEqual(sys.int_info.str_digits_check_threshold, 100)
        self.assertGreater(sys.int_info.default_max_str_digits,
                           sys.int_info.str_digits_check_threshold)
        self.assertIsInstance(sys.int_info.default_max_str_digits, int)
        self.assertIsInstance(sys.int_info.str_digits_check_threshold, int)
                 ""warn_default_encoding"", ""safe_path"", ""int_max_str_digits"")","        self.assertEqual(len(sys.int_info), 2)
                 ""warn_default_encoding"", ""safe_path"")",f8b71da9aac6ea74808dcdd0cc266e705431356b,CVE-2020-10735,f8b71da9aac6ea74808dcdd0cc266e705431356b,https://github.com/python/cpython,NVD_GIT_REPOBASED,186,COMPLETED,"VAR.VAR(VAR(VAR.VAR), 4) VAR.VAR(VAR.VAR.VAR, 500) VAR.VAR(VAR.VAR.VAR, 100) VAR.VAR(VAR.VAR.VAR, VAR.VAR.VAR) VAR.VAR(VAR.VAR.VAR, VAR) VAR.VAR(VAR.VAR.VAR, VAR) ""VAR"", ""VAR"", ""VAR"") VAR.VAR(VAR(VAR.VAR), 2) ""VAR"", ""VAR"")",6,6
deno_99b5eaa2f4f81b0f6fb46a388808a0d8f40b91e1,ext/websocket/Cargo.toml,"version = ""0.100.0""","version = ""0.99.0""",99b5eaa2f4f81b0f6fb46a388808a0d8f40b91e1,CVE-2023-28445,99b5eaa2f4f81b0f6fb46a388808a0d8f40b91e1,https://github.com/denoland/deno,NVD_GIT_REPOBASED,74,COMPLETED,"VAR = ""0.100.0"" VAR = ""0.99.0""",6,6
directus_8daed9c41baeaf1d08c1e292bf9f0dcef65e48fb,docs/.vuepress/theme/styles/index.styl,"    box-shadow: 0px 10px 20px 0px rgba(23, 41, 64, 0.2), 0px 4px 8px 0px rgba(23, 41, 64, 0.2);

  video
    width 100%

  .no-shadow
    box-shadow: none;",,8daed9c41baeaf1d08c1e292bf9f0dcef65e48fb,CVE-2022-26969,8daed9c41baeaf1d08c1e292bf9f0dcef65e48fb,https://github.com/directus/directus,NVD_GIT_REPOBASED,66,COMPLETED,"VAR-VAR: 0px 10px 20px 0px VAR(23, 41, 64, 0.2), 0px 4px 8px 0px VAR(23, 41, 64, 0.2); VAR VAR 100% .VAR-VAR VAR-VAR: VAR; ",0,6
discourse_3de765c89524a526ce611e11468d758a471a933f,plugins/chat/config/settings.yml,"  chat_maximum_message_length:
    type: integer
    default: 6000
    client: true
    hidden: true
    min: 100
    max: 12000",,3de765c89524a526ce611e11468d758a471a933f,CVE-2022-41921,3de765c89524a526ce611e11468d758a471a933f,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR: VAR: VAR VAR: 6000 VAR: VAR VAR: VAR VAR: 100 VAR: 12000 ,0,6
discourse_3de765c89524a526ce611e11468d758a471a933f,plugins/chat/spec/components/chat_message_creator_spec.rb,"    it ""errors when length is greater than `chat_maximum_message_length`"" do
      SiteSetting.chat_maximum_message_length = 100
      creator =
        Chat::ChatMessageCreator.create(
          chat_channel: public_chat_channel,
          user: user1,
          content: ""a really long and in depth message that is just too detailed"" * 100,
        )
      expect(creator.failed?).to eq(true)
      expect(creator.error.message).to match(
        I18n.t(
          ""chat.errors.message_too_long"",
          { maximum: SiteSetting.chat_maximum_message_length },
        ),
      )
    end
",,3de765c89524a526ce611e11468d758a471a933f,CVE-2022-41921,3de765c89524a526ce611e11468d758a471a933f,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ""VAR VAR VAR VAR VAR VAR `VAR`"" VAR VAR.VAR = 100 VAR = VAR::VAR.VAR( VAR: VAR, VAR: VAR, VAR: ""VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR"" * 100, ) VAR(VAR.VAR?).VAR VAR(VAR) VAR(VAR.VAR.VAR).VAR VAR( VAR.VAR( ""VAR.VAR.VAR"", { VAR: VAR.VAR }, ), ) VAR ",6,6
discourse_3de765c89524a526ce611e11468d758a471a933f,plugins/chat/spec/components/chat_message_updater_spec.rb,"  it ""errors when length is greater than `chat_maximum_message_length`"" do
    SiteSetting.chat_maximum_message_length = 100
    og_message = ""This won't be changed!""
    chat_message = create_chat_message(user1, og_message, public_chat_channel)
    new_message = ""2 long"" * 100

    updater =
      Chat::ChatMessageUpdater.update(
        guardian: guardian,
        chat_message: chat_message,
        new_content: new_message,
      )
    expect(updater.failed?).to eq(true)
    expect(updater.error.message).to match(
      I18n.t(
        ""chat.errors.message_too_long"",
        { maximum: SiteSetting.chat_maximum_message_length },
      ),
    )
    expect(chat_message.reload.message).to eq(og_message)
  end

    updater =
      Chat::ChatMessageUpdater.update(
        guardian: Guardian.new(Fabricate(:user)),
        chat_message: chat_message,
        new_content: new_message,
      )
    events =
      DiscourseEvent.track_events do
        Chat::ChatMessageUpdater.update(
          guardian: guardian,
          chat_message: chat_message,
          new_content: ""Change to this!"",
        )
      end","    updater = Chat::ChatMessageUpdater.update(
      guardian: Guardian.new(Fabricate(:user)),
      chat_message: chat_message,
      new_content: new_message,
    )
    events = DiscourseEvent.track_events {
      Chat::ChatMessageUpdater.update(
        guardian: guardian,
        chat_message: chat_message,
        new_content: ""Change to this!"",
      )
    }",3de765c89524a526ce611e11468d758a471a933f,CVE-2022-41921,3de765c89524a526ce611e11468d758a471a933f,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ""VAR VAR VAR VAR VAR VAR `VAR`"" VAR VAR.VAR = 100 VAR = ""VAR VAR'VAR VAR VAR!"" VAR = VAR(VAR, VAR, VAR) VAR = ""2 VAR"" * 100 VAR = VAR::VAR.VAR( VAR: VAR, VAR: VAR, VAR: VAR, ) VAR(VAR.VAR?).VAR VAR(VAR) VAR(VAR.VAR.VAR).VAR VAR( VAR.VAR( ""VAR.VAR.VAR"", { VAR: VAR.VAR }, ), ) VAR(VAR.VAR.VAR).VAR VAR(VAR) VAR VAR = VAR::VAR.VAR( VAR: VAR.VAR(VAR(:VAR)), VAR: VAR, VAR: VAR, ) VAR = VAR.VAR VAR VAR::VAR.VAR( VAR: VAR, VAR: VAR, VAR: ""VAR VAR VAR!"", ) VAR VAR = VAR::VAR.VAR( VAR: VAR.VAR(VAR(:VAR)), VAR: VAR, VAR: VAR, ) VAR = VAR.VAR { VAR::VAR.VAR( VAR: VAR, VAR: VAR, VAR: ""VAR VAR VAR!"", ) }",6,6
discourse_c186a46910431020e8efc425dec2133e7a99fa9a,spec/lioneboxer_spec.rb,"
    it ""escapes URLs of local audio uploads"" do
      result =
        described_class.onebox_raw(
          ""#{Discourse.base_url}/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#'<>"",
        )
      expect(result[:onebox]).to eq(<<~HTML)
        <audio  controls>
          <source src='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E'>
          <a href='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E'>
            http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E
          </a>
        </audio>
      HTML
      expect(result[:preview]).to eq(<<~HTML)
        <audio  controls>
          <source src='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E'>
          <a href='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E'>
            http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.wav#&apos;%3C%3E
          </a>
        </audio>
      HTML
    end

    it ""escapes URLs of local video uploads"" do
      result =
        described_class.onebox_raw(
          ""#{Discourse.base_url}/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#'<>"",
        )
      expect(result[:onebox]).to eq(<<~HTML)
        <div class=""onebox video-onebox"">
          <video  width=""100%"" height=""100%"" controls="""">
            <source src='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E'>
            <a href='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E'>
              http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E
            </a>
          </video>
        </div>
      HTML
      expect(result[:preview]).to eq(<<~HTML)
        <div class=""onebox video-onebox"">
          <video  width=""100%"" height=""100%"" controls="""">
            <source src='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E'>
            <a href='http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E'>
              http://test.localhost/uploads/default/original/1X/a1c31803be81b85ecafc4f77b1008eee9b3b82f4.mp4#&apos;%3C%3E
            </a>
          </video>
        </div>
      HTML
    end

    it ""escapes URLs of generic local links"" do
      result = described_class.onebox_raw(""#{Discourse.base_url}/g/somegroup#'onerror='"")
      expect(result[:onebox]).to eq(
        ""<a href='http://test.localhost/g/somegroup#&apos;onerror=&apos;'>http://test.localhost/g/somegroup#&apos;onerror=&apos;</a>"",
      )
      expect(result[:preview]).to eq(
        ""<a href='http://test.localhost/g/somegroup#&apos;onerror=&apos;'>http://test.localhost/g/somegroup#&apos;onerror=&apos;</a>"",
      )
    end",,c186a46910431020e8efc425dec2133e7a99fa9a,CVE-2023-25172,c186a46910431020e8efc425dec2133e7a99fa9a,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ""VAR VAR VAR VAR VAR VAR"" VAR VAR = VAR.VAR( "" ) VAR(VAR[:VAR]).VAR VAR(<<~VAR) <VAR VAR> <VAR VAR='VAR: <VAR VAR='VAR: VAR: </VAR> </VAR> VAR VAR(VAR[:VAR]).VAR VAR(<<~VAR) <VAR VAR> <VAR VAR='VAR: <VAR VAR='VAR: VAR: </VAR> </VAR> VAR VAR VAR ""VAR VAR VAR VAR VAR VAR"" VAR VAR = VAR.VAR( "" ) VAR(VAR[:VAR]).VAR VAR(<<~VAR) <VAR VAR=""VAR VAR-VAR""> <VAR VAR=""100%"" VAR=""100%"" VAR=""""> <VAR VAR='VAR: <VAR VAR='VAR: VAR: </VAR> </VAR> </VAR> VAR VAR(VAR[:VAR]).VAR VAR(<<~VAR) <VAR VAR=""VAR VAR-VAR""> <VAR VAR=""100%"" VAR=""100%"" VAR=""""> <VAR VAR='VAR: <VAR VAR='VAR: VAR: </VAR> </VAR> </VAR> VAR VAR VAR ""VAR VAR VAR VAR VAR VAR"" VAR VAR = VAR.VAR("" VAR(VAR[:VAR]).VAR VAR( ""<VAR VAR='VAR: ) VAR(VAR[:VAR]).VAR VAR( ""<VAR VAR='VAR: ) VAR ",6,6
discourse_fd16eade7fcc6bba4b71e71106a2eb13cdfdae4a,lifinal_destination/ssrf_detector.rb,"    # This is a list of private IPv4 IP ranges that are not allowed to be globally reachable as given by
    # https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml.
    PRIVATE_IPV4_RANGES = [
      IPAddr.new(""0.0.0.0/8""),
      IPAddr.new(""10.0.0.0/8""),
      IPAddr.new(""100.64.0.0/10""),
      IPAddr.new(""127.0.0.0/8""),
      IPAddr.new(""169.254.0.0/16""),
      IPAddr.new(""172.16.0.0/12""),
      IPAddr.new(""192.0.0.0/24""),
      IPAddr.new(""192.0.0.0/29""),
      IPAddr.new(""192.0.0.8/32""),
      IPAddr.new(""192.0.0.170/32""),
      IPAddr.new(""192.0.0.171/32""),
      IPAddr.new(""192.0.2.0/24""),
      IPAddr.new(""192.168.0.0/16""),
      IPAddr.new(""192.175.48.0/24""),
      IPAddr.new(""198.18.0.0/15""),
      IPAddr.new(""198.51.100.0/24""),
      IPAddr.new(""203.0.113.0/24""),
      IPAddr.new(""240.0.0.0/4""),
      IPAddr.new(""255.255.255.255/32""),
    ]

    # This is a list of private IPv6 IP ranges that are not allowed to be globally reachable as given by
    # https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml.
    #
    # ::ffff:0:0/96 is excluded from the list because it is used for IPv4-mapped IPv6 addresses which is something we want to allow.
    PRIVATE_IPV6_RANGES = [
      IPAddr.new(""::1/128""),
      IPAddr.new(""::/128""),
      IPAddr.new(""64:ff9b:1::/48""),
      IPAddr.new(""100::/64""),
      IPAddr.new(""2001::/23""),
      IPAddr.new(""2001:2::/48""),
      IPAddr.new(""2001:db8::/32""),
      IPAddr.new(""fc00::/7""),
      IPAddr.new(""fe80::/10""),
    ]

    PRIVATE_IP_RANGES = PRIVATE_IPV4_RANGES + PRIVATE_IPV6_RANGES
      ip = ip.native
      return false if ip_in_ranges?(ip, blocked_ip_blocks) || ip_in_ranges?(ip, PRIVATE_IP_RANGES)","    def self.standard_private_ranges
      @private_ranges ||= [
        IPAddr.new(""0.0.0.0/8""),
        IPAddr.new(""127.0.0.1""),
        IPAddr.new(""172.16.0.0/12""),
        IPAddr.new(""192.168.0.0/16""),
        IPAddr.new(""10.0.0.0/8""),
        IPAddr.new(""::1""),
        IPAddr.new(""fc00::/7""),
        IPAddr.new(""fe80::/10""),
      ]
    end
      if ip_in_ranges?(ip, blocked_ip_blocks) || ip_in_ranges?(ip, standard_private_ranges)
        return false
      end",fd16eade7fcc6bba4b71e71106a2eb13cdfdae4a,CVE-2023-28111,fd16eade7fcc6bba4b71e71106a2eb13cdfdae4a,https://github.com/discourse/discourse,NVD_DIRECT_COMMIT,1337,COMPLETED,"  VAR = [ VAR.VAR(""0.0.0.0/8""), VAR.VAR(""10.0.0.0/8""), VAR.VAR(""100.64.0.0/10""), VAR.VAR(""127.0.0.0/8""), VAR.VAR(""169.254.0.0/16""), VAR.VAR(""172.16.0.0/12""), VAR.VAR(""192.0.0.0/24""), VAR.VAR(""192.0.0.0/29""), VAR.VAR(""192.0.0.8/32""), VAR.VAR(""192.0.0.170/32""), VAR.VAR(""192.0.0.171/32""), VAR.VAR(""192.0.2.0/24""), VAR.VAR(""192.168.0.0/16""), VAR.VAR(""192.175.48.0/24""), VAR.VAR(""198.18.0.0/15""), VAR.VAR(""198.51.100.0/24""), VAR.VAR(""203.0.113.0/24""), VAR.VAR(""240.0.0.0/4""), VAR.VAR(""255.255.255.255/32""), ]     VAR = [ VAR.VAR(""::1/128""), VAR.VAR(""::/128""), VAR.VAR(""64:VAR:1::/48""), VAR.VAR(""100::/64""), VAR.VAR(""2001::/23""), VAR.VAR(""2001:2::/48""), VAR.VAR(""2001:VAR::/32""), VAR.VAR(""VAR::/7""), VAR.VAR(""VAR::/10""), ] VAR = VAR + VAR VAR = VAR.VAR VAR VAR VAR VAR?(VAR, VAR) || VAR?(VAR, VAR) VAR VAR.VAR @VAR ||= [ VAR.VAR(""0.0.0.0/8""), VAR.VAR(""127.0.0.1""), VAR.VAR(""172.16.0.0/12""), VAR.VAR(""192.168.0.0/16""), VAR.VAR(""10.0.0.0/8""), VAR.VAR(""::1""), VAR.VAR(""VAR::/7""), VAR.VAR(""VAR::/10""), ] VAR VAR VAR?(VAR, VAR) || VAR?(VAR, VAR) VAR VAR VAR",0,6
django_8d7271578d7b153435b40fe40236ebec43cbf1b9,tests/staticfiles_tests/project/documents/nested/css/base.css,html {height: 100%;},,8d7271578d7b153435b40fe40236ebec43cbf1b9,CVE-2020-24583,8d7271578d7b153435b40fe40236ebec43cbf1b9,https://github.com/django/django,GHSD_DIRECT_COMMIT,1337,COMPLETED,VAR {VAR: 100%;} ,6,6
envoy_5333b928d8bcffa26ab19bf018369a835f697585,docs/root/configuration/http/http_conn_man/runtime.rst,"
.. _config_http_conn_man_runtime_path_with_escaped_slashes_action:

http_connection_manager.path_with_escaped_slashes_action
  Overrides Envoy's default action taken when the
  :ref:`path_with_escaped_slashes_action <envoy_v3_api_field_extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.path_with_escaped_slashes_action>`.
  was not specified or set to the IMPLEMENTATION_SPECIFIC_DEFAULT value. Possible values:

  - 2 sets action to the REJECT_REQUEST.
  - 3 sets action to the UNESCAPE_AND_REDIRECT.
  - 4 sets action to the UNESCAPE_AND_FORWARD.
  - all other values set the action to KEEP_UNCHANGED.

.. _config_http_conn_man_runtime_path_with_escaped_slashes_action_enabled:

http_connection_manager.path_with_escaped_slashes_action_enabled
  % of requests that will be subject to the
  :ref:`path_with_escaped_slashes_action <envoy_v3_api_field_extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.path_with_escaped_slashes_action>`.
  action. For all other requests the KEEP_UNCHANGED action will be applied. Defaults to 100.",,5333b928d8bcffa26ab19bf018369a835f697585,CVE-2021-29492,5333b928d8bcffa26ab19bf018369a835f697585,https://github.com/envoyproxy/envoy,NVD_GIT_REPOBASED,162,COMPLETED,.. VAR: VAR.VAR VAR VAR'VAR VAR VAR VAR VAR VAR :VAR:`VAR <VAR.VAR.VAR.VAR.VAR.VAR.VAR>`. VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR: - 2 VAR VAR VAR VAR VAR. - 3 VAR VAR VAR VAR VAR. - 4 VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR. .. VAR: VAR.VAR % VAR VAR VAR VAR VAR VAR VAR VAR :VAR:`VAR <VAR.VAR.VAR.VAR.VAR.VAR.VAR>`. VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR 100. ,6,6
envoy_5333b928d8bcffa26ab19bf018369a835f697585,source/extensions/filters/network/http_connection_manager/config.cc,"envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
    PathWithEscapedSlashesAction
    getPathWithEscapedSlashesActionRuntimeOverride(Server::Configuration::FactoryContext& context) {
  // The default behavior is to leave escaped slashes unchanged.
  uint64_t runtime_override = context.runtime().snapshot().getInteger(
      ""http_connection_manager.path_with_escaped_slashes_action"", 0);
  switch (runtime_override) {
  default:
    // Also includes runtime override values of 0 and 1
    return envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
        KEEP_UNCHANGED;
  case 2:
    return envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
        REJECT_REQUEST;
  case 3:
    return envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
        UNESCAPE_AND_REDIRECT;
  case 4:
    return envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
        UNESCAPE_AND_FORWARD;
  }
}

envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
    PathWithEscapedSlashesAction
    getPathWithEscapedSlashesAction(const envoy::extensions::filters::network::
                                        http_connection_manager::v3::HttpConnectionManager& config,
                                    Server::Configuration::FactoryContext& context) {
  envoy::type::v3::FractionalPercent default_fraction;
  default_fraction.set_numerator(100);
  default_fraction.set_denominator(envoy::type::v3::FractionalPercent::HUNDRED);
  if (context.runtime().snapshot().featureEnabled(
          ""http_connection_manager.path_with_escaped_slashes_action_enabled"", default_fraction)) {
    return config.path_with_escaped_slashes_action() ==
                   envoy::extensions::filters::network::http_connection_manager::v3::
                       HttpConnectionManager::IMPLEMENTATION_SPECIFIC_DEFAULT
               ? getPathWithEscapedSlashesActionRuntimeOverride(context)
               : config.path_with_escaped_slashes_action();
  }

  // When action is disabled through runtime the behavior is to keep escaped slashes unchanged.
  return envoy::extensions::filters::network::http_connection_manager::v3::HttpConnectionManager::
      KEEP_UNCHANGED;
}

      local_reply_(LocalReply::Factory::create(config.local_reply_config(), context)),
      path_with_escaped_slashes_action_(getPathWithEscapedSlashesAction(config, context)) {","      local_reply_(LocalReply::Factory::create(config.local_reply_config(), context)) {",5333b928d8bcffa26ab19bf018369a835f697585,CVE-2021-29492,5333b928d8bcffa26ab19bf018369a835f697585,https://github.com/envoyproxy/envoy,NVD_GIT_REPOBASED,162,COMPLETED,"VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR VAR(VAR::VAR::VAR& VAR) {  VAR VAR = VAR.VAR().VAR().VAR( ""VAR.VAR"", 0); VAR (VAR) { VAR:  VAR VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR; VAR 2: VAR VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR; VAR 3: VAR VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR; VAR 4: VAR VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR; } } VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR VAR(VAR VAR::VAR::VAR::VAR:: VAR::VAR::VAR& VAR, VAR::VAR::VAR& VAR) { VAR::VAR::VAR::VAR VAR; VAR.VAR(100); VAR.VAR(VAR::VAR::VAR::VAR::VAR); VAR (VAR.VAR().VAR().VAR( ""VAR.VAR"", VAR)) { VAR VAR.VAR() == VAR::VAR::VAR::VAR::VAR::VAR:: VAR::VAR ? VAR(VAR) : VAR.VAR(); }  VAR VAR::VAR::VAR::VAR::VAR::VAR::VAR:: VAR; } VAR(VAR::VAR::VAR(VAR.VAR(), VAR)), VAR(VAR(VAR, VAR)) { VAR(VAR::VAR::VAR(VAR.VAR(), VAR)) {",6,6
envoy_5eba69a1f375413fb93fab4173f9c393ac8c2818,test/common/http/http2/codec_impl_test.cc,"  // Ping frames are 17 bytes each so 237 full frames and a partial frame fit in the current min
  // size for buffer slices. Setting the limit to 2x+1 the number that fits in a single slice allows
  // the logic below that verifies drain and overflow thresholds.
  static const int kMaxOutboundControlFrames = 475;
  // Drain floor(kMaxOutboundFrames / 2) slices from the send buffer
  // Send floor(kMaxOutboundFrames / 2) more pings.
  EXPECT_EQ(ack_count, kMaxOutboundControlFrames + kMaxOutboundControlFrames / 2);","  static const int kMaxOutboundControlFrames = 100;
  // Drain kMaxOutboundFrames / 2 slices from the send buffer
  // Send kMaxOutboundFrames / 2 more pings.",5eba69a1f375413fb93fab4173f9c393ac8c2818,CVE-2020-12604,5eba69a1f375413fb93fab4173f9c393ac8c2818,https://github.com/envoyproxy/envoy,NVD_GIT_REPOBASED,68,COMPLETED,"   VAR VAR VAR VAR = 475;   VAR(VAR, VAR + VAR / 2); VAR VAR VAR VAR = 100;  ",0,6
envoy_cb4ef0b09200c720dfdb07e097092dd105450343,source/extensions/compression/brotli/decompressor/brotli_decompressor_impl.cc,"#include ""source/common/runtime/runtime_features.h""

namespace {

// How many times the output buffer is allowed to be bigger than the input
// buffer. This value is used to detect compression bombs.
// TODO(rojkov): Re-design the Decompressor interface to handle compression
// bombs gracefully instead of this quick solution.
constexpr uint32_t MaxInflateRatio = 100;

} // namespace

  Common::BrotliContext ctx(chunk_size_, MaxInflateRatio * input_buffer.length());
  if (Runtime::runtimeFeatureEnabled(
          ""envoy.reloadable_features.enable_compression_bomb_protection"") &&
      (output_buffer.length() > ctx.max_output_size_)) {
    stats_.brotli_error_.inc();
    return false;
  }
",  Common::BrotliContext ctx(chunk_size_);,cb4ef0b09200c720dfdb07e097092dd105450343,CVE-2022-29225,cb4ef0b09200c720dfdb07e097092dd105450343,https://github.com/envoyproxy/envoy,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR {     VAR VAR VAR = 100; }  VAR::VAR VAR(VAR, VAR * VAR.VAR()); VAR (VAR::VAR( ""VAR.VAR.VAR"") && (VAR.VAR() > VAR.VAR)) { VAR.VAR.VAR(); VAR VAR; } VAR::VAR VAR(VAR);",6,6
envoy_cb4ef0b09200c720dfdb07e097092dd105450343,source/extensions/compression/gzip/decompressor/zlib_decompressor_impl.cc,"#include ""source/common/runtime/runtime_features.h""
namespace {

// How many times the output buffer is allowed to be bigger than the size of
// accumulated input. This value is used to detect compression bombs.
// TODO(rojkov): Re-design the Decompressor interface to handle compression
// bombs gracefully instead of this quick solution.
constexpr uint64_t MaxInflateRatio = 100;

} // namespace

  uint64_t limit = MaxInflateRatio * input_buffer.length();


      if (Runtime::runtimeFeatureEnabled(
              ""envoy.reloadable_features.enable_compression_bomb_protection"") &&
          (output_buffer.length() > limit)) {
        stats_.zlib_data_error_.inc();
        ENVOY_LOG(trace,
                  ""excessive decompression ratio detected: output ""
                  ""size {} for input size {}"",
                  output_buffer.length(), input_buffer.length());
        return;
      }",,cb4ef0b09200c720dfdb07e097092dd105450343,CVE-2022-29225,cb4ef0b09200c720dfdb07e097092dd105450343,https://github.com/envoyproxy/envoy,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR {     VAR VAR VAR = 100; }  VAR VAR = VAR * VAR.VAR(); VAR (VAR::VAR( ""VAR.VAR.VAR"") && (VAR.VAR() > VAR)) { VAR.VAR.VAR(); VAR(VAR, ""VAR VAR VAR VAR: VAR "" ""VAR {} VAR VAR VAR {}"", VAR.VAR(), VAR.VAR()); VAR; } ",6,6
envoy_cb4ef0b09200c720dfdb07e097092dd105450343,source/extensions/compression/zstd/decompressor/zstd_decompressor_impl.cc,"#include ""source/common/runtime/runtime_features.h""

namespace {

// How many times the output buffer is allowed to be bigger than the size of
// accumulated input. This value is used to detect compression bombs.
// TODO(rojkov): Re-design the Decompressor interface to handle compression
// bombs gracefully instead of this quick solution.
constexpr uint64_t MaxInflateRatio = 100;

} // namespace

  uint64_t limit = MaxInflateRatio * input_buffer.length();

      if (Runtime::runtimeFeatureEnabled(
              ""envoy.reloadable_features.enable_compression_bomb_protection"") &&
          (output_buffer.length() > limit)) {
        stats_.zstd_generic_error_.inc();
        ENVOY_LOG(trace,
                  ""excessive decompression ratio detected: output ""
                  ""size {} for input size {}"",
                  output_buffer.length(), input_buffer.length());
        return;
      }",,cb4ef0b09200c720dfdb07e097092dd105450343,CVE-2022-29225,cb4ef0b09200c720dfdb07e097092dd105450343,https://github.com/envoyproxy/envoy,NVD_DIRECT_COMMIT,1337,COMPLETED," VAR {     VAR VAR VAR = 100; }  VAR VAR = VAR * VAR.VAR(); VAR (VAR::VAR( ""VAR.VAR.VAR"") && (VAR.VAR() > VAR)) { VAR.VAR.VAR(); VAR(VAR, ""VAR VAR VAR VAR: VAR "" ""VAR {} VAR VAR VAR {}"", VAR.VAR(), VAR.VAR()); VAR; } ",6,6
envoy_eff020170c6267e6c8dc235473f7fc85c5b1e07d,source/common/common/regex.cc,"#include ""common/common/regex.h""

#include ""envoy/common/exception.h""

#include ""common/common/assert.h""
#include ""common/common/fmt.h""
#include ""common/protobuf/utility.h""

#include ""re2/re2.h""

namespace Envoy {
namespace Regex {
namespace {

class CompiledStdMatcher : public CompiledMatcher {
public:
  CompiledStdMatcher(std::regex&& regex) : regex_(std::move(regex)) {}

  // CompiledMatcher
  bool match(absl::string_view value) const override {
    return std::regex_match(value.begin(), value.end(), regex_);
  }

private:
  const std::regex regex_;
};

class CompiledGoogleReMatcher : public CompiledMatcher {
public:
  CompiledGoogleReMatcher(const envoy::type::matcher::RegexMatcher& config)
      : regex_(config.regex(), re2::RE2::Quiet) {
    if (!regex_.ok()) {
      throw EnvoyException(regex_.error());
    }

    const uint32_t max_program_size =
        PROTOBUF_GET_WRAPPED_OR_DEFAULT(config.google_re2(), max_program_size, 100);
    if (static_cast<uint32_t>(regex_.ProgramSize()) > max_program_size) {
      throw EnvoyException(fmt::format(""regex '{}' RE2 program size of {} > max program size of ""
                                       ""{}. Increase configured max program size if necessary."",
                                       config.regex(), regex_.ProgramSize(), max_program_size));
    }
  }

  // CompiledMatcher
  bool match(absl::string_view value) const override {
    return re2::RE2::FullMatch(re2::StringPiece(value.data(), value.size()), regex_);
  }

private:
  const re2::RE2 regex_;
};

} // namespace

CompiledMatcherPtr Utility::parseRegex(const envoy::type::matcher::RegexMatcher& matcher) {
  // Google Re is the only currently supported engine.
  ASSERT(matcher.has_google_re2());
  return std::make_unique<CompiledGoogleReMatcher>(matcher);
}

CompiledMatcherPtr Utility::parseStdRegexAsCompiledMatcher(const std::string& regex,
                                                           std::regex::flag_type flags) {
  return std::make_unique<CompiledStdMatcher>(parseStdRegex(regex, flags));
}

std::regex Utility::parseStdRegex(const std::string& regex, std::regex::flag_type flags) {
  // TODO(zuercher): In the future, PGV (https://github.com/lyft/protoc-gen-validate) annotations
  // may allow us to remove this in favor of direct validation of regular expressions.
  try {
    return std::regex(regex, flags);
  } catch (const std::regex_error& e) {
    throw EnvoyException(fmt::format(""Invalid regex '{}': {}"", regex, e.what()));
  }
}

} // namespace Regex
} // namespace Envoy",,eff020170c6267e6c8dc235473f7fc85c5b1e07d,CVE-2019-14993,eff020170c6267e6c8dc235473f7fc85c5b1e07d,https://github.com/envoyproxy/envoy,NVD_GIT_REPOBASED,106,COMPLETED,"      VAR VAR { VAR VAR { VAR { VAR VAR : VAR VAR { VAR: VAR(VAR::VAR&& VAR) : VAR(VAR::VAR(VAR)) {}  VAR VAR(VAR::VAR VAR) VAR VAR { VAR VAR::VAR(VAR.VAR(), VAR.VAR(), VAR); } VAR: VAR VAR::VAR VAR; }; VAR VAR : VAR VAR { VAR: VAR(VAR VAR::VAR::VAR::VAR& VAR) : VAR(VAR.VAR(), VAR::VAR::VAR) { VAR (!VAR.VAR()) { VAR VAR(VAR.VAR()); } VAR VAR VAR = VAR(VAR.VAR(), VAR, 100); VAR (VAR<VAR>(VAR.VAR()) > VAR) { VAR VAR(VAR::VAR(""VAR '{}' VAR VAR VAR VAR {} > VAR VAR VAR VAR "" ""{}. VAR VAR VAR VAR VAR VAR VAR."", VAR.VAR(), VAR.VAR(), VAR)); } }  VAR VAR(VAR::VAR VAR) VAR VAR { VAR VAR::VAR::VAR(VAR::VAR(VAR.VAR(), VAR.VAR()), VAR); } VAR: VAR VAR::VAR VAR; }; }  VAR VAR::VAR(VAR VAR::VAR::VAR::VAR& VAR) {  VAR(VAR.VAR()); VAR VAR::VAR<VAR>(VAR); } VAR VAR::VAR(VAR VAR::VAR& VAR, VAR::VAR::VAR VAR) { VAR VAR::VAR<VAR>(VAR(VAR, VAR)); } VAR::VAR VAR::VAR(VAR VAR::VAR& VAR, VAR::VAR::VAR VAR) {   VAR { VAR VAR::VAR(VAR, VAR); } VAR (VAR VAR::VAR& VAR) { VAR VAR(VAR::VAR(""VAR VAR '{}': {}"", VAR, VAR.VAR())); } } }  }  ",6,6
envoy_eff020170c6267e6c8dc235473f7fc85c5b1e07d,source/common/common/regex.cc,"#include ""common/common/regex.h""

#include ""envoy/common/exception.h""

#include ""common/common/assert.h""
#include ""common/common/fmt.h""
#include ""common/protobuf/utility.h""

#include ""re2/re2.h""

namespace Envoy {
namespace Regex {
namespace {

class CompiledStdMatcher : public CompiledMatcher {
public:
  CompiledStdMatcher(std::regex&& regex) : regex_(std::move(regex)) {}

  // CompiledMatcher
  bool match(absl::string_view value) const override {
    return std::regex_match(value.begin(), value.end(), regex_);
  }

private:
  const std::regex regex_;
};

class CompiledGoogleReMatcher : public CompiledMatcher {
public:
  CompiledGoogleReMatcher(const envoy::type::matcher::RegexMatcher& config)
      : regex_(config.regex(), re2::RE2::Quiet) {
    if (!regex_.ok()) {
      throw EnvoyException(regex_.error());
    }

    const uint32_t max_program_size =
        PROTOBUF_GET_WRAPPED_OR_DEFAULT(config.google_re2(), max_program_size, 100);
    if (static_cast<uint32_t>(regex_.ProgramSize()) > max_program_size) {
      throw EnvoyException(fmt::format(""regex '{}' RE2 program size of {} > max program size of ""
                                       ""{}. Increase configured max program size if necessary."",
                                       config.regex(), regex_.ProgramSize(), max_program_size));
    }
  }

  // CompiledMatcher
  bool match(absl::string_view value) const override {
    return re2::RE2::FullMatch(re2::StringPiece(value.data(), value.size()), regex_);
  }

private:
  const re2::RE2 regex_;
};

} // namespace

CompiledMatcherPtr Utility::parseRegex(const envoy::type::matcher::RegexMatcher& matcher) {
  // Google Re is the only currently supported engine.
  ASSERT(matcher.has_google_re2());
  return std::make_unique<CompiledGoogleReMatcher>(matcher);
}

CompiledMatcherPtr Utility::parseStdRegexAsCompiledMatcher(const std::string& regex,
                                                           std::regex::flag_type flags) {
  return std::make_unique<CompiledStdMatcher>(parseStdRegex(regex, flags));
}

std::regex Utility::parseStdRegex(const std::string& regex, std::regex::flag_type flags) {
  // TODO(zuercher): In the future, PGV (https://github.com/lyft/protoc-gen-validate) annotations
  // may allow us to remove this in favor of direct validation of regular expressions.
  try {
    return std::regex(regex, flags);
  } catch (const std::regex_error& e) {
    throw EnvoyException(fmt::format(""Invalid regex '{}': {}"", regex, e.what()));
  }
}

} // namespace Regex
} // namespace Envoy",,eff020170c6267e6c8dc235473f7fc85c5b1e07d,CVE-2019-15225,eff020170c6267e6c8dc235473f7fc85c5b1e07d,https://github.com/envoyproxy/envoy,NVD_GIT_REPOBASED,106,COMPLETED,"      VAR VAR { VAR VAR { VAR { VAR VAR : VAR VAR { VAR: VAR(VAR::VAR&& VAR) : VAR(VAR::VAR(VAR)) {}  VAR VAR(VAR::VAR VAR) VAR VAR { VAR VAR::VAR(VAR.VAR(), VAR.VAR(), VAR); } VAR: VAR VAR::VAR VAR; }; VAR VAR : VAR VAR { VAR: VAR(VAR VAR::VAR::VAR::VAR& VAR) : VAR(VAR.VAR(), VAR::VAR::VAR) { VAR (!VAR.VAR()) { VAR VAR(VAR.VAR()); } VAR VAR VAR = VAR(VAR.VAR(), VAR, 100); VAR (VAR<VAR>(VAR.VAR()) > VAR) { VAR VAR(VAR::VAR(""VAR '{}' VAR VAR VAR VAR {} > VAR VAR VAR VAR "" ""{}. VAR VAR VAR VAR VAR VAR VAR."", VAR.VAR(), VAR.VAR(), VAR)); } }  VAR VAR(VAR::VAR VAR) VAR VAR { VAR VAR::VAR::VAR(VAR::VAR(VAR.VAR(), VAR.VAR()), VAR); } VAR: VAR VAR::VAR VAR; }; }  VAR VAR::VAR(VAR VAR::VAR::VAR::VAR& VAR) {  VAR(VAR.VAR()); VAR VAR::VAR<VAR>(VAR); } VAR VAR::VAR(VAR VAR::VAR& VAR, VAR::VAR::VAR VAR) { VAR VAR::VAR<VAR>(VAR(VAR, VAR)); } VAR::VAR VAR::VAR(VAR VAR::VAR& VAR, VAR::VAR::VAR VAR) {   VAR { VAR VAR::VAR(VAR, VAR); } VAR (VAR VAR::VAR& VAR) { VAR VAR(VAR::VAR(""VAR VAR '{}': {}"", VAR, VAR.VAR())); } } }  }  ",6,6
glpi_ad748d59c94da177a3ed25111c453902396f320c,front/backup.php,,"<?php
/**
 * ---------------------------------------------------------------------
 * GLPI - Gestionnaire Libre de Parc Informatique
 * Copyright (C) 2015-2018 Teclib' and contributors.
 *
 * http://glpi-project.org
 *
 * based on GLPI - Gestionnaire Libre de Parc Informatique
 * Copyright (C) 2003-2014 by the INDEPNET Development Team.
 *
 * ---------------------------------------------------------------------
 *
 * LICENSE
 *
 * This file is part of GLPI.
 *
 * GLPI is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * GLPI is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GLPI. If not, see <http://www.gnu.org/licenses/>.
 * ---------------------------------------------------------------------
 */

include ('../inc/includes.php');

if (isset($_POST['check_version'])) {
   Session::checkRight('backup', Backup::CHECKUPDATE);
   Toolbox::checkNewVersionAvailable(0, true);
   Html::back();
}

Session::checkRight(""backup"", READ);

Html::header(__('Maintenance'), $_SERVER['PHP_SELF'], ""admin"", ""backup"");

$max_time = min(get_cfg_var(""max_execution_time""), get_cfg_var(""max_input_time""));

if ($max_time == 0) {
   $defaulttimeout  = 60;
   $defaultrowlimit = 5;

} else if ($max_time > 5) {
   $defaulttimeout  = $max_time-2;
   $defaultrowlimit = 5;

} else {
   $defaulttimeout  = max(1, $max_time-2);
   $defaultrowlimit = 2;
}


/**
 * Generate an XML backup file of the database
 * @global DB $DB
 */
function xmlbackup() {
   global $CFG_GLPI, $DB;

   //on parcoure la DB et on liste tous les noms des tables dans $table
   //on incremente $query[] de ""select * from $table""  pour chaque occurence de $table

   $result = $DB->listTables();
   $i      = 0;
   while ($line = $result->next()) {
      $table = $line['TABLE_NAME'];

      $query[$i] = ""SELECT *
                    FROM `$table`"";
      $i++;
   }

   // Filename
   $time_file = date(""Y-m-d-H-i"");
   $filename = GLPI_DUMP_DIR . ""/glpi-backup-"" . GLPI_VERSION . ""-$time_file.xml"";

   $A = new XML();

   // Your query
   $A->SqlString = $query;

   //File path
   $A->FilePath = $filename;

   // Define layout type
   $A->Type = 4;

   // Generate the XML file
   $A->DoXML();

   // In case of error, display it
   if ($A->IsError == 1) {
      printf(__('ERROR:'), $A->ErrorString);
   }
}

/**
 * Init time to computer time spend
 * @global type $TPSDEB
 * @global int $TPSCOUR
 */
function init_time() {
   global $TPSDEB, $TPSCOUR;

   list($usec,$sec) = explode("" "", microtime());
   $TPSDEB          = $sec;
   $TPSCOUR         = 0;
}

/**
 * Get current time
 * @global type $TPSDEB
 * @global type $TPSCOUR
 */
function current_time() {
   global $TPSDEB, $TPSCOUR;

   list($usec,$sec) = explode("" "", microtime());
   $TPSFIN          = $sec;
   if (round($TPSFIN-$TPSDEB, 1) >= $TPSCOUR+1) {//une seconde de plus
      $TPSCOUR = round($TPSFIN-$TPSDEB, 1);
   }
}

/**
 * Get data of a table
 * @param DB $DB
 * @param string $table table name
 * @param integer $from FROM xxx
 * @param integer $limit LIMIT xxx
 * @return string SQL query ""INSERT INTO...""
 */
function get_content($DB, $table, $from, $limit) {

   $content = """";

   $iterator = $DB->request($table, ['START' => $from, 'LIMIT' => $limit]);

   if ($iterator->count()) {

      while ($row = $iterator->next()) {
         $insert = ""INSERT INTO `$table` VALUES ("";

         foreach ($row as $field_key => $field_val) {
            if (is_null($field_val)) {
               $insert .= ""NULL,"";
            } else if ($field_val != """") {
               $insert .= ""'"" . addslashes($field_val) . ""',"";
            } else {
               $insert .= ""'',"";
            }
         }
         $insert = preg_replace(""/,$/"", """", $insert);
         $insert .= "");\n"";
         $content .= $insert;
      }
   }
   return $content;
}

/**  Get structure of a table
 *
 * @param $DB     DB object
 * @param $table  table name
**/
function get_def($DB, $table) {

   $def  = ""### Dump table $table\n\n"";
   $def .= ""DROP TABLE IF EXISTS `$table`;\n"";

   $query  = ""SHOW CREATE TABLE `$table`"";
   $result = $DB->query($query);
   $DB->query(""SET SESSION sql_quote_show_create = 1"");
   $row = $DB->fetch_row($result);

   $def .= preg_replace(""/AUTO_INCREMENT=\w+/i"", """", $row[1]);
   $def .= "";"";
   return $def.""\n\n"";
}


/**  Restore a mysql dump
 *
 * @param $DB        DB object
 * @param $dumpFile  dump file
 * @param $duree     max delay before refresh
**/
function restoreMySqlDump($DB, $dumpFile, $duree) {
   global $DB, $TPSCOUR, $offset, $cpt;

   // $dumpFile, fichier source
   // $duree=timeout pour changement de page (-1 = aucun)

   // Desactivation pour empecher les addslashes au niveau de la creation des tables
   // En plus, au niveau du dump on considere qu'on est bon
   // set_magic_quotes_runtime(0);

   if (!file_exists($dumpFile)) {
      echo sprintf(__('File %s not found.'), $dumpFile).""<br>"";
      return false;
   }
   if (substr($dumpFile, -2) == ""gz"") {
      $fileHandle = gzopen($dumpFile, ""rb"");
   } else {
      $fileHandle = fopen($dumpFile, ""rb"");
   }

   if (!$fileHandle) {
      //TRASN: %s is the name of the file
      echo sprintf(__('Unauthorized access to the file %s'), $dumpFile).""<br>"";
      return false;
   }

   if ($offset != 0) {
      if (substr($dumpFile, -2) == ""gz"") {
         if (gzseek($fileHandle, $offset, SEEK_SET) != 0) { //erreur
            //TRANS: %s is the number of the byte
            printf(__(""Unable to find the byte %s""), Html::formatNumber($offset, false, 0));
            echo ""<br>"";
            return false;
         }
      } else {
         if (fseek($fileHandle, $offset, SEEK_SET) != 0) { //erreur
            //TRANS: %s is the number of the byte
            printf(__(""Unable to find the byte %s""), Html::formatNumber($offset, false, 0));
            echo ""<br>"";
            return false;
         }
      }
      Html::glpi_flush();
   }

   $formattedQuery = """";

   if (substr($dumpFile, -2) == ""gz"") {
      while (!gzeof($fileHandle)) {
         current_time();
         if (($duree > 0)
             && ($TPSCOUR >= $duree)) { //on atteint la fin du temps imparti
            return true;
         }

         // specify read length to be able to read long lines
         $buffer = gzgets($fileHandle, 102400);

         // do not strip comments due to problems when # in begin of a data line
         $formattedQuery .= $buffer;

         if (substr(rtrim($formattedQuery), -1) == "";"") {
            // Do not use the $DB->query
            if ($DB->query($formattedQuery)) { //if no success continue to concatenate
               $offset         = gztell($fileHandle);
               $formattedQuery = """";
               $cpt++;
            }
         }
      }
   } else {
      while (!feof($fileHandle)) {
         current_time();
         if (($duree > 0)
               && ($TPSCOUR >= $duree)) { //on atteint la fin du temps imparti
            return true;
         }

         // specify read length to be able to read long lines
         $buffer = fgets($fileHandle, 102400);

         // do not strip comments due to problems when # in begin of a data line
         $formattedQuery .= $buffer;

         if (substr(rtrim($formattedQuery), -1) == "";"") {
            // Do not use the $DB->query
            if ($DB->query($formattedQuery)) { //if no success continue to concatenate
               $offset         = ftell($fileHandle);
               $formattedQuery = """";
               $cpt++;
            }
         }
      }
   }

   if ($DB->error) {
      echo ""<hr>"";
      //TRANS: %s is the SQL query which generates the error
      printf(__(""SQL error starting from %s""), ""[$formattedQuery]"");
      echo ""<br>"".$DB->error().""<hr>"";
   }

   if (substr($dumpFile, -2) == ""gz"") {
      gzclose($fileHandle);
   } else {
      fclose($fileHandle);
   }
   $offset = -1;
   return true;
}


/**  Backup a glpi DB
 *
 * @param $DB        DB object
 * @param $dumpFile  dump file
 * @param $duree     max delay before refresh
 * @param $rowlimit  rowlimit to backup in one time
**/
function backupMySql($DB, $dumpFile, $duree, $rowlimit) {
   global $TPSCOUR, $offsettable, $offsetrow, $cpt;

   // $dumpFile, fichier source
   // $duree=timeout pour changement de page (-1 = aucun)

   if (function_exists('gzopen')) {
      $fileHandle = gzopen($dumpFile, ""a"");
   } else {
      $fileHandle = gzopen64($dumpFile, ""a"");
   }

   if (!$fileHandle) {
      //TRANS: %s is the name of the file
      echo sprintf(__('Unauthorized access to the file %s'), $dumpFile).""<br>"";
      return false;
   }

   if ($offsettable == 0 && $offsetrow == -1) {
      $time_file = date(""Y-m-d-H-i"");
      $cur_time  = date(""Y-m-d H:i"");
      $todump    = ""#GLPI Dump database on $cur_time\n"";
      gzwrite ($fileHandle, $todump);
   }

   $result = $DB->listTables();
   $numtab = 0;
   while ($t = $result->next()) {
      $tables[$numtab] = $t['TABLE_NAME'];
      $numtab++;
   }

   for (; $offsettable<$numtab; $offsettable++) {
      // Dump de la structure table
      if ($offsetrow == -1) {
         $todump = ""\n"".get_def($DB, $tables[$offsettable]);
         gzwrite ($fileHandle, $todump);
         $offsetrow++;
         $cpt++;
      }
      current_time();
      if (($duree > 0)
          && ($TPSCOUR >= $duree)) { //on atteint la fin du temps imparti
         return true;
      }
      $fin = 0;
      while (!$fin) {
         $todump    = get_content($DB, $tables[$offsettable], $offsetrow, $rowlimit);
         $rowtodump = substr_count($todump, ""INSERT INTO"");

         if ($rowtodump > 0) {
            gzwrite ($fileHandle, $todump);
            $cpt       += $rowtodump;
            $offsetrow += $rowlimit;
            if ($rowtodump<$rowlimit) {
               $fin = 1;
            }
            current_time();
            if (($duree > 0)
                && ($TPSCOUR >= $duree)) { //on atteint la fin du temps imparti
               return true;
            }

         } else {
            $fin       = 1;
            $offsetrow = -1;
         }
      }

      if ($fin) {
         $offsetrow = -1;
      }
      current_time();
      if (($duree > 0)
          && ($TPSCOUR >= $duree)) { //on atteint la fin du temps imparti
         return true;
      }
   }

   if ($DB->error()) {
      echo ""<hr>"";
      //TRANS: %s is the SQL query which generates the error
      printf(__(""SQL error starting from %s""), ""[$formattedQuery]"");
      echo ""<br>"".$DB->error().""<hr>"";
   }
   $offsettable = -1;
   gzclose($fileHandle);
   return true;
}


// #################"" DUMP sql#################################

if (isset($_GET[""dump""]) && $_GET[""dump""] != """") {
   $time_file = date(""Y-m-d-H-i"");
   $cur_time  = date(""Y-m-d H:i"");
   $filename  = GLPI_DUMP_DIR . ""/glpi-backup-"".GLPI_VERSION.""-$time_file.sql.gz"";

   if (!isset($_GET[""duree""]) && is_file($filename)) {
      echo ""<div class='center'>"".__('The file already exists').""</div>"";

   } else {
      init_time(); //initialise le temps
      //debut de fichier

      if (!isset($_GET[""offsettable""])) {
         $offsettable = 0;
      } else {
         $offsettable = $_GET[""offsettable""];
      }

      //debut de fichier
      if (!isset($_GET[""offsetrow""])) {
         $offsetrow = -1;
      } else {
         $offsetrow = $_GET[""offsetrow""];
      }

      //timeout de 5 secondes par defaut, -1 pour utiliser sans timeout
      if (!isset($_GET[""duree""])) {
         $duree = $defaulttimeout;
      } else {
         $duree = $_GET[""duree""];
      }

      //Limite de lignes a dumper a chaque fois
      if (!isset($_GET[""rowlimit""])) {
         $rowlimit = $defaultrowlimit;
      } else {
         $rowlimit = $_GET[""rowlimit""];
      }

      //si le nom du fichier n'est pas en parametre le mettre ici
      if (!isset($_GET[""fichier""])) {
         $fichier = $filename;
      } else {
         $fichier = $_GET[""fichier""];
      }

      $tot = $DB->listTables()->count();
      if (isset($offsettable)) {
         if ($offsettable >= 0) {
            $percent = min(100, round(100*$offsettable/$tot, 0));
         } else {
            $percent = 100;
         }
      } else {
         $percent = 0;
      }

      if ($percent >= 0) {
         Html::displayProgressBar(400, $percent);
         echo '<br>';
      }

      if ($offsettable >= 0) {
         if (backupMySql($DB, $fichier, $duree, $rowlimit)) {
            echo ""<div class='center spaced'>"".
                 ""<a href=\""backup.php?dump=1&duree=$duree&rowlimit=$rowlimit&offsetrow="".
                    ""$offsetrow&offsettable=$offsettable&cpt=$cpt&fichier=$fichier\"">"".
                    __('Automatic redirection, else click').""</a>"";
            echo ""<script type='text/javascript'>"" .
                ""window.location=\""backup.php?dump=1&duree=$duree&rowlimit="".
                     ""$rowlimit&offsetrow=$offsetrow&offsettable=$offsettable&cpt=$cpt&fichier="".
                     ""$fichier\"";</script></div>"";
            Html::glpi_flush();
            exit;
         }
      }
   }
}


// ##############################   fin dump sql########################""""""""


// ################################## dump XML #############################

if (isset($_GET[""xmlnow""]) && ($_GET[""xmlnow""] != """")) {
   xmlbackup();
}

// ################################## fin dump XML #############################

if (isset($_GET[""file""]) && ($_GET[""file""] != """") && is_file(GLPI_DUMP_DIR . ""/"" . $_GET[""file""])) {
   $filepath = realpath(GLPI_DUMP_DIR . ""/"" . $_GET['file']);
   if (is_file($filepath) && Toolbox::startsWith($filepath, GLPI_DUMP_DIR)) {
      $_SESSION['TRY_OLD_CONFIG_FIRST'] = true;
      init_time(); //initialise le temps

      //debut de fichier
      if (!isset($_GET[""offset""])) {
         $offset = 0;
      } else {
         $offset = $_GET[""offset""];
      }

      //timeout de 5 secondes par defaut, -1 pour utiliser sans timeout
      if (!isset($_GET[""duree""])) {
         $duree = $defaulttimeout;
      } else {
         $duree = $_GET[""duree""];
      }

      $fsize = filesize($filepath);
      if (isset($offset)) {
         if ($offset == -1) {
            $percent = 100;
         } else {
            $percent = min(100, round(100*$offset/$fsize, 0));
         }
      } else {
         $percent = 0;
      }

      if ($percent >= 0) {
         Html::displayProgressBar(400, $percent);
         echo '<br>';
      }

      if ($offset != -1) {
         if (restoreMySqlDump($DB, $filepath, $duree)) {
            echo ""<div class='center'>"".
               ""<a href=\""backup.php?file="".$_GET[""file""].""&amp;duree=$duree&amp;offset="".
                     ""$offset&amp;cpt=$cpt&amp;donotcheckversion=1\"">"";
            echo __('Automatic redirection, else click').""</a>"";
            echo ""<script language='javascript' type='text/javascript'>"".
                  ""window.location=\""backup.php?file="".
                  $_GET[""file""].""&duree=$duree&offset=$offset&cpt=$cpt&donotcheckversion=1\"";"".
                  ""</script></div>"";
            Html::glpi_flush();
            exit;
         }

      } else {
         // Compatiblity for old version for utf8 complete conversion
         $cnf                = new Config();
         $input['id']        = 1;
         $input['utf8_conv'] = 1;
         $cnf->update($input);
      }
   }
}

if (isset($_POST[""delfile""])) {
   if (isset($_POST['file']) && ($_POST[""file""] != """")) {
      $filepath = realpath(GLPI_DUMP_DIR . ""/"" . $_POST['file']);
      if (is_file($filepath) && Toolbox::startsWith($filepath, GLPI_DUMP_DIR)) {
         $filename = $_POST[""file""];
         unlink($filepath);
         // TRANS: %s is a file name
         echo ""<div class ='center spaced'>"".sprintf(__('%s deleted'), $filename).""</div>"";
      }
   }
}

if (Session::haveRight('backup', Backup::CHECKUPDATE)) {
   echo ""<div class='center spaced'><table class='tab_glpi'>"";
   echo ""<tr class='tab_bg_1'><td colspan='4' class='center b'>"";
   Html::showSimpleForm($_SERVER['PHP_SELF'], 'check_version',
                        __('Check if a new version is available'));
   echo ""</td></tr></table></div>"";
}

// Title backup
echo ""<div class='center'>"";
if (Session::haveRight('backup', CREATE)) {
   echo ""<table class='tab_glpi'><tr><td colspan='4'>"";
   echo ""<div class='warning'><i class='fa fa-exclamation-triangle fa-5x'></i><ul><li>"";
   echo __('GLPI internal backup system is a helper for very small instances.');
   echo ""<br/>"" . __('You should rather use a dedicated tool on your server.');
   echo ""</li></ul></div>"";
   echo ""</td></tr><tr><td>"";
   echo ""<i class='far fa-save fa-3x'></i>"";
         ""</td>"";
   echo ""<td><a class='vsubmit'
              href=\""#\"" "".HTML::addConfirmationOnAction(__('Backup the database?'),
                                                         ""window.location='"".$CFG_GLPI[""root_doc""].
                                                           ""/front/backup.php?dump=dump'"").
              "">"".__('SQL Dump').""</a>&nbsp;</td>"";
   echo ""<td><a class='vsubmit'
              href=\""#\"" "".HTML::addConfirmationOnAction(__('Backup the database?'),
                                                         ""window.location='"".$CFG_GLPI[""root_doc""].
                                                           ""/front/backup.php?xmlnow=xmlnow'"").
              "">"".__('XML Dump').""</a>&nbsp;</td>"";
   echo ""</tr></table>"";
}
echo ""<br><table class='tab_cadre' cellpadding='5'>"".
     ""<tr class='center'>"".
     ""<th><u><i>"".__('File').""</i></u></th>"".
     ""<th><u><i>"".__('Size').""</i></u></th>"".
     ""<th><u><i>"".__('Date').""</i></u></th>"".
     ""<th colspan='3'>&nbsp;</th>"".
     ""</tr>"";

$dir   = opendir(GLPI_DUMP_DIR);
$files = [];
while ($file = readdir($dir)) {
   if (($file != ""."") && ($file != "".."")
       && (preg_match(""/\.sql.gz$/i"", $file)
           || preg_match(""/\.sql$/i"", $file))) {

      $files[$file] = filemtime(GLPI_DUMP_DIR . ""/"" . $file);
   }
}
arsort($files);

if (count($files)) {
   foreach ($files as $file => $date) {
      $taille_fic = filesize(GLPI_DUMP_DIR . ""/"" . $file);
      echo ""<tr class='tab_bg_2'><td>$file&nbsp;</td>"".
           ""<td class='right'>"".Toolbox::getSize($taille_fic).""</td>"".
           ""<td>&nbsp;"" . Html::convDateTime(date(""Y-m-d H:i"", $date)) . ""</td>"";
      if (Session::haveRight('backup', PURGE)) {
         echo ""<td>&nbsp;"";
              //TRANS: %s is the filename
              $string = sprintf(__('Delete the file %s?'), $file);
              Html::showSimpleForm($_SERVER['PHP_SELF'], 'delfile',
                                   _x('button', 'Delete permanently'),
                                   ['file' => $file], '', '', $string);

         echo ""</td>"";
         echo ""<td>&nbsp;"";
         // Multiple confirmation
         $string   = [];
         //TRANS: %s is the filename
         $string[] = [sprintf(__('Replace the current database with the backup file %s?'),
                                   $file)];
         $string[] = [__('Warning, your actual database will be totaly overwriten by the database you want to restore !!!')];

         echo ""<a class='vsubmit' href=\""#\"" "".HTML::addConfirmationOnAction($string,
                                        ""window.location='"".$CFG_GLPI[""root_doc""].
                                        ""/front/backup.php?file=$file&amp;donotcheckversion=1'"").
              "">"".__('Restore').""</a>&nbsp;</td>"";
      }
      if (Session::haveRight('backup', CREATE)) {
         echo ""<td>&nbsp;"".
              ""<a class='vsubmit' href=\""document.send.php?file=_dumps/$file\"">"".__('Download').
              ""</a></td>"";
      }
      echo ""</tr>"";
   }
}
closedir($dir);

$dir = opendir(GLPI_DUMP_DIR);
unset($files);
$files = [];

while ($file = readdir($dir)) {
   if (($file != ""."") && ($file != "".."")
       && preg_match(""/\.xml$/i"", $file)) {

      $files[$file] = filemtime(GLPI_DUMP_DIR . ""/"" . $file);
   }
}
arsort($files);

if (count($files)) {
   foreach ($files as $file => $date) {
      $taille_fic = filesize(GLPI_DUMP_DIR . ""/"" . $file);
      echo ""<tr class='tab_bg_1'><td colspan='6'><hr noshade></td></tr>"".
           ""<tr class='tab_bg_2'><td>$file&nbsp;</td>"".
            ""<td class='right'>"".Toolbox::getSize($taille_fic).""</td>"".
            ""<td>&nbsp;"" . Html::convDateTime(date(""Y-m-d H:i"", $date)) . ""</td>"";
      if (Session::haveRight('backup', PURGE)) {
         echo ""<td colspan=2>"";
         //TRANS: %s is the filename
         $string = sprintf(__('Delete the file %s?'), $file);
         Html::showSimpleForm($_SERVER['PHP_SELF'], 'delfile', _x('button', 'Delete permanently'),
                              ['file' => $file], '', '', $string);
         echo ""</td>"";
      }
      if (Session::haveRight('backup', CREATE)) {
         echo ""<td>&nbsp;<a class='vsubmit' href=\""document.send.php?file=_dumps/$file\"">"".
                       __('Download').""</a></td>"";
      }
      echo ""</tr>"";
   }
}
closedir($dir);

echo ""</table>"";
echo ""</div>"";

Html::footer();",ad748d59c94da177a3ed25111c453902396f320c,CVE-2020-11060,ad748d59c94da177a3ed25111c453902396f320c,https://github.com/glpi-project/glpi,NVD_DIRECT_COMMIT,1337,COMPLETED," <?VAR /** * --------------------------------------------------------------------- * VAR - VAR VAR VAR VAR VAR * VAR (VAR) 2015-2018 VAR' VAR VAR. * * VAR: * * VAR VAR VAR - VAR VAR VAR VAR VAR * VAR (VAR) 2003-2014 VAR VAR VAR VAR VAR. * * --------------------------------------------------------------------- * * VAR * * VAR VAR VAR VAR VAR VAR. * * VAR VAR VAR VAR; VAR VAR VAR VAR VAR/VAR VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR VAR VAR VAR; VAR VAR 2 VAR VAR VAR, VAR * (VAR VAR VAR) VAR VAR VAR. * * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, * VAR VAR VAR VAR; VAR VAR VAR VAR VAR VAR * VAR VAR VAR VAR VAR VAR VAR. VAR VAR * VAR VAR VAR VAR VAR VAR VAR. * * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR VAR VAR. VAR VAR, VAR <VAR: * --------------------------------------------------------------------- */ VAR ('../VAR/VAR.VAR'); VAR (VAR($VAR['VAR'])) { VAR::VAR('VAR', VAR::VAR); VAR::VAR(0, VAR); VAR::VAR(); } VAR::VAR(""VAR"", VAR); VAR::VAR(VAR('VAR'), $VAR['VAR'], ""VAR"", ""VAR""); $VAR = VAR(VAR(""VAR""), VAR(""VAR"")); VAR ($VAR == 0) { $VAR = 60; $VAR = 5; } VAR VAR ($VAR > 5) { $VAR = $VAR-2; $VAR = 5; } VAR { $VAR = VAR(1, $VAR-2); $VAR = 2; } /** * VAR VAR VAR VAR VAR VAR VAR VAR * @VAR VAR $VAR */ VAR VAR() { VAR $VAR, $VAR;   $VAR = $VAR->VAR(); $VAR = 0; VAR ($VAR = $VAR->VAR()) { $VAR = $VAR['VAR']; $VAR[$VAR] = ""VAR * VAR `$VAR`""; $VAR++; }  $VAR = VAR(""VAR-VAR-VAR-VAR-VAR""); $VAR = VAR . ""/VAR-VAR-"" . VAR . ""-$VAR.VAR""; $VAR = VAR VAR();  $VAR->VAR = $VAR;  $VAR->VAR = $VAR;  $VAR->VAR = 4;  $VAR->VAR();  VAR ($VAR->VAR == 1) { VAR(VAR('VAR:'), $VAR->VAR); } } /** * VAR VAR VAR VAR VAR VAR * @VAR VAR $VAR * @VAR VAR $VAR */ VAR VAR() { VAR $VAR, $VAR; VAR($VAR,$VAR) = VAR("" "", VAR()); $VAR = $VAR; $VAR = 0; } /** * VAR VAR VAR * @VAR VAR $VAR * @VAR VAR $VAR */ VAR VAR() { VAR $VAR, $VAR; VAR($VAR,$VAR) = VAR("" "", VAR()); $VAR = $VAR; VAR (VAR($VAR-$VAR, 1) >= $VAR+1) { $VAR = VAR($VAR-$VAR, 1); } } /** * VAR VAR VAR VAR VAR * @VAR VAR $VAR * @VAR VAR $VAR VAR VAR * @VAR VAR $VAR VAR VAR * @VAR VAR $VAR VAR VAR * @VAR VAR VAR VAR ""VAR VAR..."" */ VAR VAR($VAR, $VAR, $VAR, $VAR) { $VAR = """"; $VAR = $VAR->VAR($VAR, ['VAR' => $VAR, 'VAR' => $VAR]); VAR ($VAR->VAR()) { VAR ($VAR = $VAR->VAR()) { $VAR = ""VAR VAR `$VAR` VAR (""; VAR ($VAR VAR $VAR => $VAR) { VAR (VAR($VAR)) { $VAR .= ""VAR,""; } VAR VAR ($VAR != """") { $VAR .= ""'"" . VAR($VAR) . ""',""; } VAR { $VAR .= ""'',""; } } $VAR = VAR(""/,$/"", """", $VAR); $VAR .= "");\VAR""; $VAR .= $VAR; } } VAR $VAR; } /** VAR VAR VAR VAR VAR * * @VAR $VAR VAR VAR * @VAR $VAR VAR VAR **/ VAR VAR($VAR, $VAR) { $VAR = "" $VAR .= ""VAR VAR VAR VAR `$VAR`;\VAR""; $VAR = ""VAR VAR VAR `$VAR`""; $VAR = $VAR->VAR($VAR); $VAR->VAR(""VAR VAR VAR = 1""); $VAR = $VAR->VAR($VAR); $VAR .= VAR(""/VAR=\VAR+/VAR"", """", $VAR[1]); $VAR .= "";""; VAR $VAR.""\VAR\VAR""; } /** VAR VAR VAR VAR * * @VAR $VAR VAR VAR * @VAR $VAR VAR VAR * @VAR $VAR VAR VAR VAR VAR **/ VAR VAR($VAR, $VAR, $VAR) { VAR $VAR, $VAR, $VAR, $VAR;      VAR (!VAR($VAR)) { VAR VAR(VAR('VAR %VAR VAR VAR.'), $VAR).""<VAR>""; VAR VAR; } VAR (VAR($VAR, -2) == ""VAR"") { $VAR = VAR($VAR, ""VAR""); } VAR { $VAR = VAR($VAR, ""VAR""); } VAR (!$VAR) {  VAR VAR(VAR('VAR VAR VAR VAR VAR %VAR'), $VAR).""<VAR>""; VAR VAR; } VAR ($VAR != 0) { VAR (VAR($VAR, -2) == ""VAR"") { VAR (VAR($VAR, $VAR, VAR) != 0) {   VAR(VAR(""VAR VAR VAR VAR VAR %VAR""), VAR::VAR($VAR, VAR, 0)); VAR ""<VAR>""; VAR VAR; } } VAR { VAR (VAR($VAR, $VAR, VAR) != 0) {   VAR(VAR(""VAR VAR VAR VAR VAR %VAR""), VAR::VAR($VAR, VAR, 0)); VAR ""<VAR>""; VAR VAR; } } VAR::VAR(); } $VAR = """"; VAR (VAR($VAR, -2) == ""VAR"") { VAR (!VAR($VAR)) { VAR(); VAR (($VAR > 0) && ($VAR >= $VAR)) {  VAR VAR; }  $VAR = VAR($VAR, 102400);  $VAR .= $VAR; VAR (VAR(VAR($VAR), -1) == "";"") {  VAR ($VAR->VAR($VAR)) {  $VAR = VAR($VAR); $VAR = """"; $VAR++; } } } } VAR { VAR (!VAR($VAR)) { VAR(); VAR (($VAR > 0) && ($VAR >= $VAR)) {  VAR VAR; }  $VAR = VAR($VAR, 102400);  $VAR .= $VAR; VAR (VAR(VAR($VAR), -1) == "";"") {  VAR ($VAR->VAR($VAR)) {  $VAR = VAR($VAR); $VAR = """"; $VAR++; } } } } VAR ($VAR->VAR) { VAR ""<VAR>"";  VAR(VAR(""VAR VAR VAR VAR %VAR""), ""[$VAR]""); VAR ""<VAR>"".$VAR->VAR().""<VAR>""; } VAR (VAR($VAR, -2) == ""VAR"") { VAR($VAR); } VAR { VAR($VAR); } $VAR = -1; VAR VAR; } /** VAR VAR VAR VAR * * @VAR $VAR VAR VAR * @VAR $VAR VAR VAR * @VAR $VAR VAR VAR VAR VAR * @VAR $VAR VAR VAR VAR VAR VAR VAR **/ VAR VAR($VAR, $VAR, $VAR, $VAR) { VAR $VAR, $VAR, $VAR, $VAR;   VAR (VAR('VAR')) { $VAR = VAR($VAR, ""VAR""); } VAR { $VAR = VAR($VAR, ""VAR""); } VAR (!$VAR) {  VAR VAR(VAR('VAR VAR VAR VAR VAR %VAR'), $VAR).""<VAR>""; VAR VAR; } VAR ($VAR == 0 && $VAR == -1) { $VAR = VAR(""VAR-VAR-VAR-VAR-VAR""); $VAR = VAR(""VAR-VAR-VAR VAR:VAR""); $VAR = "" VAR ($VAR, $VAR); } $VAR = $VAR->VAR(); $VAR = 0; VAR ($VAR = $VAR->VAR()) { $VAR[$VAR] = $VAR['VAR']; $VAR++; } VAR (; $VAR<$VAR; $VAR++) {  VAR ($VAR == -1) { $VAR = ""\VAR"".VAR($VAR, $VAR[$VAR]); VAR ($VAR, $VAR); $VAR++; $VAR++; } VAR(); VAR (($VAR > 0) && ($VAR >= $VAR)) {  VAR VAR; } $VAR = 0; VAR (!$VAR) { $VAR = VAR($VAR, $VAR[$VAR], $VAR, $VAR); $VAR = VAR($VAR, ""VAR VAR""); VAR ($VAR > 0) { VAR ($VAR, $VAR); $VAR += $VAR; $VAR += $VAR; VAR ($VAR<$VAR) { $VAR = 1; } VAR(); VAR (($VAR > 0) && ($VAR >= $VAR)) {  VAR VAR; } } VAR { $VAR = 1; $VAR = -1; } } VAR ($VAR) { $VAR = -1; } VAR(); VAR (($VAR > 0) && ($VAR >= $VAR)) {  VAR VAR; } } VAR ($VAR->VAR()) { VAR ""<VAR>"";  VAR(VAR(""VAR VAR VAR VAR %VAR""), ""[$VAR]""); VAR ""<VAR>"".$VAR->VAR().""<VAR>""; } $VAR = -1; VAR($VAR); VAR VAR; }  VAR (VAR($VAR[""VAR""]) && $VAR[""VAR""] != """") { $VAR = VAR(""VAR-VAR-VAR-VAR-VAR""); $VAR = VAR(""VAR-VAR-VAR VAR:VAR""); $VAR = VAR . ""/VAR-VAR-"".VAR.""-$VAR.VAR.VAR""; VAR (!VAR($VAR[""VAR""]) && VAR($VAR)) { VAR ""<VAR VAR='VAR'>"".VAR('VAR VAR VAR VAR').""</VAR>""; } VAR { VAR();   VAR (!VAR($VAR[""VAR""])) { $VAR = 0; } VAR { $VAR = $VAR[""VAR""]; }  VAR (!VAR($VAR[""VAR""])) { $VAR = -1; } VAR { $VAR = $VAR[""VAR""]; }  VAR (!VAR($VAR[""VAR""])) { $VAR = $VAR; } VAR { $VAR = $VAR[""VAR""]; }  VAR (!VAR($VAR[""VAR""])) { $VAR = $VAR; } VAR { $VAR = $VAR[""VAR""]; }  VAR (!VAR($VAR[""VAR""])) { $VAR = $VAR; } VAR { $VAR = $VAR[""VAR""]; } $VAR = $VAR->VAR()->VAR(); VAR (VAR($VAR)) { VAR ($VAR >= 0) { $VAR = VAR(100, VAR(100*$VAR/$VAR, 0)); } VAR { $VAR = 100; } } VAR { $VAR = 0; } VAR ($VAR >= 0) { VAR::VAR(400, $VAR); VAR '<VAR>'; } VAR ($VAR >= 0) { VAR (VAR($VAR, $VAR, $VAR, $VAR)) { VAR ""<VAR VAR='VAR VAR'>"". ""<VAR VAR=\""VAR.VAR?VAR=1&VAR=$VAR&VAR=$VAR&VAR="". ""$VAR&VAR=$VAR&VAR=$VAR&VAR=$VAR\"">"". VAR('VAR VAR, VAR VAR').""</VAR>""; VAR ""<VAR VAR='VAR/VAR'>"" . ""VAR.VAR=\""VAR.VAR?VAR=1&VAR=$VAR&VAR="". ""$VAR&VAR=$VAR&VAR=$VAR&VAR=$VAR&VAR="". ""$VAR\"";</VAR></VAR>""; VAR::VAR(); VAR; } } } }   VAR (VAR($VAR[""VAR""]) && ($VAR[""VAR""] != """")) { VAR(); }  VAR (VAR($VAR[""VAR""]) && ($VAR[""VAR""] != """") && VAR(VAR . ""/"" . $VAR[""VAR""])) { $VAR = VAR(VAR . ""/"" . $VAR['VAR']); VAR (VAR($VAR) && VAR::VAR($VAR, VAR)) { $VAR['VAR'] = VAR; VAR();   VAR (!VAR($VAR[""VAR""])) { $VAR = 0; } VAR { $VAR = $VAR[""VAR""]; }  VAR (!VAR($VAR[""VAR""])) { $VAR = $VAR; } VAR { $VAR = $VAR[""VAR""]; } $VAR = VAR($VAR); VAR (VAR($VAR)) { VAR ($VAR == -1) { $VAR = 100; } VAR { $VAR = VAR(100, VAR(100*$VAR/$VAR, 0)); } } VAR { $VAR = 0; } VAR ($VAR >= 0) { VAR::VAR(400, $VAR); VAR '<VAR>'; } VAR ($VAR != -1) { VAR (VAR($VAR, $VAR, $VAR)) { VAR ""<VAR VAR='VAR'>"". ""<VAR VAR=\""VAR.VAR?VAR="".$VAR[""VAR""].""&VAR;VAR=$VAR&VAR;VAR="". ""$VAR&VAR;VAR=$VAR&VAR;VAR=1\"">""; VAR VAR('VAR VAR, VAR VAR').""</VAR>""; VAR ""<VAR VAR='VAR' VAR='VAR/VAR'>"". ""VAR.VAR=\""VAR.VAR?VAR="". $VAR[""VAR""].""&VAR=$VAR&VAR=$VAR&VAR=$VAR&VAR=1\"";"". ""</VAR></VAR>""; VAR::VAR(); VAR; } } VAR {  $VAR = VAR VAR(); $VAR['VAR'] = 1; $VAR['VAR'] = 1; $VAR->VAR($VAR); } } } VAR (VAR($VAR[""VAR""])) { VAR (VAR($VAR['VAR']) && ($VAR[""VAR""] != """")) { $VAR = VAR(VAR . ""/"" . $VAR['VAR']); VAR (VAR($VAR) && VAR::VAR($VAR, VAR)) { $VAR = $VAR[""VAR""]; VAR($VAR);  VAR ""<VAR VAR ='VAR VAR'>"".VAR(VAR('%VAR VAR'), $VAR).""</VAR>""; } } } VAR (VAR::VAR('VAR', VAR::VAR)) { VAR ""<VAR VAR='VAR VAR'><VAR VAR='VAR'>""; VAR ""<VAR VAR='VAR'><VAR VAR='4' VAR='VAR VAR'>""; VAR::VAR($VAR['VAR'], 'VAR', VAR('VAR VAR VAR VAR VAR VAR VAR')); VAR ""</VAR></VAR></VAR></VAR>""; }  VAR ""<VAR VAR='VAR'>""; VAR (VAR::VAR('VAR', VAR)) { VAR ""<VAR VAR='VAR'><VAR><VAR VAR='4'>""; VAR ""<VAR VAR='VAR'><VAR VAR='VAR VAR-VAR-VAR VAR-5x'></VAR><VAR><VAR>""; VAR VAR('VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.'); VAR ""<VAR/>"" . VAR('VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.'); VAR ""</VAR></VAR></VAR>""; VAR ""</VAR></VAR><VAR><VAR>""; VAR ""<VAR VAR='VAR VAR-VAR VAR-3x'></VAR>""; ""</VAR>""; VAR ""<VAR><VAR VAR='VAR' VAR=\"" ""VAR.VAR='"".$VAR[""VAR""]. ""/VAR/VAR.VAR?VAR=VAR'""). "">"".VAR('VAR VAR').""</VAR>&VAR;</VAR>""; VAR ""<VAR><VAR VAR='VAR' VAR=\"" ""VAR.VAR='"".$VAR[""VAR""]. ""/VAR/VAR.VAR?VAR=VAR'""). "">"".VAR('VAR VAR').""</VAR>&VAR;</VAR>""; VAR ""</VAR></VAR>""; } VAR ""<VAR><VAR VAR='VAR' VAR='5'>"". ""<VAR VAR='VAR'>"". ""<VAR><VAR><VAR>"".VAR('VAR').""</VAR></VAR></VAR>"". ""<VAR><VAR><VAR>"".VAR('VAR').""</VAR></VAR></VAR>"". ""<VAR><VAR><VAR>"".VAR('VAR').""</VAR></VAR></VAR>"". ""<VAR VAR='3'>&VAR;</VAR>"". ""</VAR>""; $VAR = VAR(VAR); $VAR = []; VAR ($VAR = VAR($VAR)) { VAR (($VAR != ""."") && ($VAR != "".."") && (VAR(""/\.VAR.VAR$/VAR"", $VAR) || VAR(""/\.VAR$/VAR"", $VAR))) { $VAR[$VAR] = VAR(VAR . ""/"" . $VAR); } } VAR($VAR); VAR (VAR($VAR)) { VAR ($VAR VAR $VAR => $VAR) { $VAR = VAR(VAR . ""/"" . $VAR); VAR ""<VAR VAR='VAR'><VAR>$VAR&VAR;</VAR>"". ""<VAR VAR='VAR'>"".VAR::VAR($VAR).""</VAR>"". ""<VAR>&VAR;"" . VAR::VAR(VAR(""VAR-VAR-VAR VAR:VAR"", $VAR)) . ""</VAR>""; VAR (VAR::VAR('VAR', VAR)) { VAR ""<VAR>&VAR;"";  $VAR = VAR(VAR('VAR VAR VAR %VAR?'), $VAR); VAR::VAR($VAR['VAR'], 'VAR', VAR('VAR', 'VAR VAR'), ['VAR' => $VAR], '', '', $VAR); VAR ""</VAR>""; VAR ""<VAR>&VAR;"";  $VAR = [];  $VAR[] = [VAR(VAR('VAR VAR VAR VAR VAR VAR VAR VAR %VAR?'), $VAR)]; $VAR[] = [VAR('VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR !!!')]; VAR ""<VAR VAR='VAR' VAR=\"" ""VAR.VAR='"".$VAR[""VAR""]. ""/VAR/VAR.VAR?VAR=$VAR&VAR;VAR=1'""). "">"".VAR('VAR').""</VAR>&VAR;</VAR>""; } VAR (VAR::VAR('VAR', VAR)) { VAR ""<VAR>&VAR;"". ""<VAR VAR='VAR' VAR=\""VAR.VAR.VAR?VAR=VAR/$VAR\"">"".VAR('VAR'). ""</VAR></VAR>""; } VAR ""</VAR>""; } } VAR($VAR); $VAR = VAR(VAR); VAR($VAR); $VAR = []; VAR ($VAR = VAR($VAR)) { VAR (($VAR != ""."") && ($VAR != "".."") && VAR(""/\.VAR$/VAR"", $VAR)) { $VAR[$VAR] = VAR(VAR . ""/"" . $VAR); } } VAR($VAR); VAR (VAR($VAR)) { VAR ($VAR VAR $VAR => $VAR) { $VAR = VAR(VAR . ""/"" . $VAR); VAR ""<VAR VAR='VAR'><VAR VAR='6'><VAR VAR></VAR></VAR>"". ""<VAR VAR='VAR'><VAR>$VAR&VAR;</VAR>"". ""<VAR VAR='VAR'>"".VAR::VAR($VAR).""</VAR>"". ""<VAR>&VAR;"" . VAR::VAR(VAR(""VAR-VAR-VAR VAR:VAR"", $VAR)) . ""</VAR>""; VAR (VAR::VAR('VAR', VAR)) { VAR ""<VAR VAR=2>"";  $VAR = VAR(VAR('VAR VAR VAR %VAR?'), $VAR); VAR::VAR($VAR['VAR'], 'VAR', VAR('VAR', 'VAR VAR'), ['VAR' => $VAR], '', '', $VAR); VAR ""</VAR>""; } VAR (VAR::VAR('VAR', VAR)) { VAR ""<VAR>&VAR;<VAR VAR='VAR' VAR=\""VAR.VAR.VAR?VAR=VAR/$VAR\"">"". VAR('VAR').""</VAR></VAR>""; } VAR ""</VAR>""; } } VAR($VAR); VAR ""</VAR>""; VAR ""</VAR>""; VAR::VAR();",6,6
go_1e43cfa15b4b618812e85c00c9e92c2615b324c8,src/mime/multipart/formdata_test.go,"func TestReadFormLimits(t *testing.T) {
	for _, test := range []struct {
		values           int
		files            int
		extraKeysPerFile int
		wantErr          error
		godebug          string
	}{
		{values: 1000},
		{values: 1001, wantErr: ErrMessageTooLarge},
		{values: 500, files: 500},
		{values: 501, files: 500, wantErr: ErrMessageTooLarge},
		{files: 1000},
		{files: 1001, wantErr: ErrMessageTooLarge},
		{files: 1, extraKeysPerFile: 9998}, // plus Content-Disposition and Content-Type
		{files: 1, extraKeysPerFile: 10000, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxparts=100"", values: 100},
		{godebug: ""multipartmaxparts=100"", values: 101, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 48},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 50, wantErr: ErrMessageTooLarge},
	} {
		name := fmt.Sprintf(""values=%v/files=%v/extraKeysPerFile=%v"", test.values, test.files, test.extraKeysPerFile)
		if test.godebug != """" {
			name += fmt.Sprintf(""/godebug=%v"", test.godebug)
		}
		t.Run(name, func(t *testing.T) {
			if test.godebug != """" {
				t.Setenv(""GODEBUG"", test.godebug)
			}
			var buf bytes.Buffer
			fw := NewWriter(&buf)
			for i := 0; i < test.values; i++ {
				w, _ := fw.CreateFormField(fmt.Sprintf(""field%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
			for i := 0; i < test.files; i++ {
				h := make(textproto.MIMEHeader)
				h.Set(""Content-Disposition"",
					fmt.Sprintf(`form-data; name=""file%v""; filename=""file%v""`, i, i))
				h.Set(""Content-Type"", ""application/octet-stream"")
				for j := 0; j < test.extraKeysPerFile; j++ {
					h.Set(fmt.Sprintf(""k%v"", j), ""v"")
				}
				w, _ := fw.CreatePart(h)
				fmt.Fprintf(w, ""value %v"", i)
			}
			if err := fw.Close(); err != nil {
				t.Fatal(err)
			}
			fr := NewReader(bytes.NewReader(buf.Bytes()), fw.Boundary())
			form, err := fr.ReadForm(1 << 10)
			if err == nil {
				defer form.RemoveAll()
			}
			if err != test.wantErr {
				t.Errorf(""ReadForm = %v, want %v"", err, test.wantErr)
			}
		})
	}
}
",,1e43cfa15b4b618812e85c00c9e92c2615b324c8,CVE-2023-24536,1e43cfa15b4b618812e85c00c9e92c2615b324c8,https://github.com/golang/go,CPE_GIT_REPOBASED,134,COMPLETED,"VAR VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR { VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR }{ {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 500, VAR: 500}, {VAR: 501, VAR: 500, VAR: VAR}, {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 1, VAR: 9998},  {VAR: 1, VAR: 10000, VAR: VAR}, {VAR: ""VAR=100"", VAR: 100}, {VAR: ""VAR=100"", VAR: 101, VAR: VAR}, {VAR: ""VAR=100"", VAR: 2, VAR: 48}, {VAR: ""VAR=100"", VAR: 2, VAR: 50, VAR: VAR}, } { VAR := VAR.VAR(""VAR=%VAR/VAR=%VAR/VAR=%VAR"", VAR.VAR, VAR.VAR, VAR.VAR) VAR VAR.VAR != """" { VAR += VAR.VAR(""/VAR=%VAR"", VAR.VAR) } VAR.VAR(VAR, VAR(VAR *VAR.VAR) { VAR VAR.VAR != """" { VAR.VAR(""VAR"", VAR.VAR) } VAR VAR VAR.VAR VAR := VAR(&VAR) VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR := VAR(VAR.VAR) VAR.VAR(""VAR-VAR"", VAR.VAR(`VAR-VAR; VAR=""VAR%VAR""; VAR=""VAR%VAR""`, VAR, VAR)) VAR.VAR(""VAR-VAR"", ""VAR/VAR-VAR"") VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR.VAR(VAR.VAR(""VAR%VAR"", VAR), ""VAR"") } VAR, VAR := VAR.VAR(VAR) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := VAR.VAR(); VAR != VAR { VAR.VAR(VAR) } VAR := VAR(VAR.VAR(VAR.VAR()), VAR.VAR()) VAR, VAR := VAR.VAR(1 << 10) VAR VAR == VAR { VAR VAR.VAR() } VAR VAR != VAR.VAR { VAR.VAR(""VAR = %VAR, VAR %VAR"", VAR, VAR.VAR) } }) } } ",6,6
go_3c010f2c2182a12f28ad86c5e1ff984f1f2d880a,src/mime/multipart/formdata.go,"		const mapEntryOverhead = 200
		maxMemoryBytes -= mapEntryOverhead
		const fileHeaderSize = 100
		maxMemoryBytes -= mapEntryOverhead
		maxMemoryBytes -= fileHeaderSize
	size = 400
		size += 200 // map entry overhead","		maxMemoryBytes -= 100 // map overhead
		size += 100 // map entry overhead",3c010f2c2182a12f28ad86c5e1ff984f1f2d880a,CVE-2023-24536,3c010f2c2182a12f28ad86c5e1ff984f1f2d880a,https://github.com/golang/go,CPE_GIT_REPOBASED,122,COMPLETED,VAR VAR = 200 VAR -= VAR VAR VAR = 100 VAR -= VAR VAR -= VAR VAR = 400 VAR += 200  VAR -= 100  VAR += 100 ,6,6
go_770130659b6fb2acf271476579a3644e093dda7f,src/crypto/x509/verify.go,"		if candidateChains, err = c.buildChains(nil, []*Certificate{c}, nil, &opts); err != nil {
// maxChainSignatureChecks is the maximum number of CheckSignatureFrom calls
// that an invocation of buildChains will (tranistively) make. Most chains are
// less than 15 certificates long, so this leaves space for multiple chains and
// for failed checks due to different intermediates having the same Subject.
const maxChainSignatureChecks = 100
func (c *Certificate) buildChains(cache map[*Certificate][][]*Certificate, currentChain []*Certificate, sigChecks *int, opts *VerifyOptions) (chains [][]*Certificate, err error) {
	var (
		hintErr  error
		hintCert *Certificate
	)

	considerCandidate := func(certType int, candidate *Certificate) {
			if cert.Equal(candidate) {
				return
		if sigChecks == nil {
			sigChecks = new(int)
		}
		*sigChecks++
		if *sigChecks > maxChainSignatureChecks {
			err = errors.New(""x509: signature check attempts limit reached while verifying certificate chain"")
			return
		if err := c.CheckSignatureFrom(candidate); err != nil {
			if hintErr == nil {
				hintErr = err
				hintCert = candidate
			return

		err = candidate.isValid(certType, currentChain, opts)
			return

		switch certType {
		case rootCertificate:
			chains = append(chains, appendToFreshChain(currentChain, candidate))
		case intermediateCertificate:
			if cache == nil {
				cache = make(map[*Certificate][][]*Certificate)
			}
			childChains, ok := cache[candidate]
			if !ok {
				childChains, err = candidate.buildChains(cache, appendToFreshChain(currentChain, candidate), sigChecks, opts)
				cache[candidate] = childChains
			}
			chains = append(chains, childChains...)
	}

	for _, rootNum := range opts.Roots.findPotentialParents(c) {
		considerCandidate(rootCertificate, opts.Roots.certs[rootNum])
	}
	for _, intermediateNum := range opts.Intermediates.findPotentialParents(c) {
		considerCandidate(intermediateCertificate, opts.Intermediates.certs[intermediateNum])","		if candidateChains, err = c.buildChains(make(map[int][][]*Certificate), []*Certificate{c}, &opts); err != nil {
func (c *Certificate) buildChains(cache map[int][][]*Certificate, currentChain []*Certificate, opts *VerifyOptions) (chains [][]*Certificate, err error) {
	possibleRoots, failedRoot, rootErr := opts.Roots.findVerifiedParents(c)
nextRoot:
	for _, rootNum := range possibleRoots {
		root := opts.Roots.certs[rootNum]
			if cert.Equal(root) {
				continue nextRoot
		err = root.isValid(rootCertificate, currentChain, opts)
		if err != nil {
			continue
		chains = append(chains, appendToFreshChain(currentChain, root))
	}
	possibleIntermediates, failedIntermediate, intermediateErr := opts.Intermediates.findVerifiedParents(c)
nextIntermediate:
	for _, intermediateNum := range possibleIntermediates {
		intermediate := opts.Intermediates.certs[intermediateNum]
		for _, cert := range currentChain {
			if cert.Equal(intermediate) {
				continue nextIntermediate
		err = intermediate.isValid(intermediateCertificate, currentChain, opts)
			continue
		var childChains [][]*Certificate
		childChains, ok := cache[intermediateNum]
		if !ok {
			childChains, err = intermediate.buildChains(cache, appendToFreshChain(currentChain, intermediate), opts)
			cache[intermediateNum] = childChains
		chains = append(chains, childChains...)

		hintErr := rootErr
		hintCert := failedRoot
		if hintErr == nil {
			hintErr = intermediateErr
			hintCert = failedIntermediate
		}",770130659b6fb2acf271476579a3644e093dda7f,CVE-2018-16875,770130659b6fb2acf271476579a3644e093dda7f,https://github.com/golang/go,CPE_GIT_REPOBASED,118,COMPLETED,"VAR VAR, VAR = VAR.VAR(VAR, []*VAR{VAR}, VAR, &VAR); VAR != VAR {     VAR VAR = 100 VAR (VAR *VAR) VAR(VAR VAR[*VAR][][]*VAR, VAR []*VAR, VAR *VAR, VAR *VAR) (VAR [][]*VAR, VAR VAR) { VAR ( VAR VAR VAR *VAR ) VAR := VAR(VAR VAR, VAR *VAR) { VAR VAR.VAR(VAR) { VAR VAR VAR == VAR { VAR = VAR(VAR) } *VAR++ VAR *VAR > VAR { VAR = VAR.VAR(""VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR"") VAR VAR VAR := VAR.VAR(VAR); VAR != VAR { VAR VAR == VAR { VAR = VAR VAR = VAR VAR VAR = VAR.VAR(VAR, VAR, VAR) VAR VAR VAR { VAR VAR: VAR = VAR(VAR, VAR(VAR, VAR)) VAR VAR: VAR VAR == VAR { VAR = VAR(VAR[*VAR][][]*VAR) } VAR, VAR := VAR[VAR] VAR !VAR { VAR, VAR = VAR.VAR(VAR, VAR(VAR, VAR), VAR, VAR) VAR[VAR] = VAR } VAR = VAR(VAR, VAR...) } VAR VAR, VAR := VAR VAR.VAR.VAR(VAR) { VAR(VAR, VAR.VAR.VAR[VAR]) } VAR VAR, VAR := VAR VAR.VAR.VAR(VAR) { VAR(VAR, VAR.VAR.VAR[VAR]) VAR VAR, VAR = VAR.VAR(VAR(VAR[VAR][][]*VAR), []*VAR{VAR}, &VAR); VAR != VAR { VAR (VAR *VAR) VAR(VAR VAR[VAR][][]*VAR, VAR []*VAR, VAR *VAR) (VAR [][]*VAR, VAR VAR) { VAR, VAR, VAR := VAR.VAR.VAR(VAR) VAR: VAR VAR, VAR := VAR VAR { VAR := VAR.VAR.VAR[VAR] VAR VAR.VAR(VAR) { VAR VAR VAR = VAR.VAR(VAR, VAR, VAR) VAR VAR != VAR { VAR VAR = VAR(VAR, VAR(VAR, VAR)) } VAR, VAR, VAR := VAR.VAR.VAR(VAR) VAR: VAR VAR, VAR := VAR VAR { VAR := VAR.VAR.VAR[VAR] VAR VAR, VAR := VAR VAR { VAR VAR.VAR(VAR) { VAR VAR VAR = VAR.VAR(VAR, VAR, VAR) VAR VAR VAR [][]*VAR VAR, VAR := VAR[VAR] VAR !VAR { VAR, VAR = VAR.VAR(VAR, VAR(VAR, VAR), VAR) VAR[VAR] = VAR VAR = VAR(VAR, VAR...) VAR := VAR VAR := VAR VAR VAR == VAR { VAR = VAR VAR = VAR }",6,6
go_7917b5f31204528ea72e0629f0b7d52b35b27538,src/mime/multipart/formdata_test.go,"func TestReadFormLimits(t *testing.T) {
	for _, test := range []struct {
		values           int
		files            int
		extraKeysPerFile int
		wantErr          error
		godebug          string
	}{
		{values: 1000},
		{values: 1001, wantErr: ErrMessageTooLarge},
		{values: 500, files: 500},
		{values: 501, files: 500, wantErr: ErrMessageTooLarge},
		{files: 1000},
		{files: 1001, wantErr: ErrMessageTooLarge},
		{files: 1, extraKeysPerFile: 9998}, // plus Content-Disposition and Content-Type
		{files: 1, extraKeysPerFile: 10000, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxparts=100"", values: 100},
		{godebug: ""multipartmaxparts=100"", values: 101, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 48},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 50, wantErr: ErrMessageTooLarge},
	} {
		name := fmt.Sprintf(""values=%v/files=%v/extraKeysPerFile=%v"", test.values, test.files, test.extraKeysPerFile)
		if test.godebug != """" {
			name += fmt.Sprintf(""/godebug=%v"", test.godebug)
		}
		t.Run(name, func(t *testing.T) {
			if test.godebug != """" {
				t.Setenv(""GODEBUG"", test.godebug)
			}
			var buf bytes.Buffer
			fw := NewWriter(&buf)
			for i := 0; i < test.values; i++ {
				w, _ := fw.CreateFormField(fmt.Sprintf(""field%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
			for i := 0; i < test.files; i++ {
				h := make(textproto.MIMEHeader)
				h.Set(""Content-Disposition"",
					fmt.Sprintf(`form-data; name=""file%v""; filename=""file%v""`, i, i))
				h.Set(""Content-Type"", ""application/octet-stream"")
				for j := 0; j < test.extraKeysPerFile; j++ {
					h.Set(fmt.Sprintf(""k%v"", j), ""v"")
				}
				w, _ := fw.CreatePart(h)
				fmt.Fprintf(w, ""value %v"", i)
			}
			if err := fw.Close(); err != nil {
				t.Fatal(err)
			}
			fr := NewReader(bytes.NewReader(buf.Bytes()), fw.Boundary())
			form, err := fr.ReadForm(1 << 10)
			if err == nil {
				defer form.RemoveAll()
			}
			if err != test.wantErr {
				t.Errorf(""ReadForm = %v, want %v"", err, test.wantErr)
			}
		})
	}
}
",,7917b5f31204528ea72e0629f0b7d52b35b27538,CVE-2023-24536,7917b5f31204528ea72e0629f0b7d52b35b27538,https://github.com/golang/go,CPE_GIT_REPOBASED,166,COMPLETED,"VAR VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR { VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR }{ {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 500, VAR: 500}, {VAR: 501, VAR: 500, VAR: VAR}, {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 1, VAR: 9998},  {VAR: 1, VAR: 10000, VAR: VAR}, {VAR: ""VAR=100"", VAR: 100}, {VAR: ""VAR=100"", VAR: 101, VAR: VAR}, {VAR: ""VAR=100"", VAR: 2, VAR: 48}, {VAR: ""VAR=100"", VAR: 2, VAR: 50, VAR: VAR}, } { VAR := VAR.VAR(""VAR=%VAR/VAR=%VAR/VAR=%VAR"", VAR.VAR, VAR.VAR, VAR.VAR) VAR VAR.VAR != """" { VAR += VAR.VAR(""/VAR=%VAR"", VAR.VAR) } VAR.VAR(VAR, VAR(VAR *VAR.VAR) { VAR VAR.VAR != """" { VAR.VAR(""VAR"", VAR.VAR) } VAR VAR VAR.VAR VAR := VAR(&VAR) VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR := VAR(VAR.VAR) VAR.VAR(""VAR-VAR"", VAR.VAR(`VAR-VAR; VAR=""VAR%VAR""; VAR=""VAR%VAR""`, VAR, VAR)) VAR.VAR(""VAR-VAR"", ""VAR/VAR-VAR"") VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR.VAR(VAR.VAR(""VAR%VAR"", VAR), ""VAR"") } VAR, VAR := VAR.VAR(VAR) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := VAR.VAR(); VAR != VAR { VAR.VAR(VAR) } VAR := VAR(VAR.VAR(VAR.VAR()), VAR.VAR()) VAR, VAR := VAR.VAR(1 << 10) VAR VAR == VAR { VAR VAR.VAR() } VAR VAR != VAR.VAR { VAR.VAR(""VAR = %VAR, VAR %VAR"", VAR, VAR.VAR) } }) } } ",6,6
go_7a359a651c7ebdb29e0a1c03102fce793e9f58f0,src/mime/multipart/formdata.go,"		const mapEntryOverhead = 200
		maxMemoryBytes -= mapEntryOverhead
		const fileHeaderSize = 100
		maxMemoryBytes -= mapEntryOverhead
		maxMemoryBytes -= fileHeaderSize
	size = 400
		size += 200 // map entry overhead","		maxMemoryBytes -= 100 // map overhead
		size += 100 // map entry overhead",7a359a651c7ebdb29e0a1c03102fce793e9f58f0,CVE-2023-24536,7a359a651c7ebdb29e0a1c03102fce793e9f58f0,https://github.com/golang/go,CPE_GIT_REPOBASED,154,COMPLETED,VAR VAR = 200 VAR -= VAR VAR VAR = 100 VAR -= VAR VAR -= VAR VAR = 400 VAR += 200  VAR -= 100  VAR += 100 ,6,6
go_99c30211b1e0b3ac4e5d32f3ae5eaf759c23195f,src/go/scanner/scanner_test.go,"	srcline      string // a line of source text
	filename     string // filename for current token
	line, column int    // line number for current token
	{""  line1"", filepath.Join(""dir"", ""TestLineDirectives""), 1, 3},
	{""\nline2"", filepath.Join(""dir"", ""TestLineDirectives""), 2, 1},
	{""\nline3  //line File1.go:100"", filepath.Join(""dir"", ""TestLineDirectives""), 3, 1}, // bad line comment, ignored
	{""\nline4"", filepath.Join(""dir"", ""TestLineDirectives""), 4, 1},
	{""\n//line File1.go:100\n  line100"", filepath.Join(""dir"", ""File1.go""), 100, 0},
	{""\n//line  \t :42\n  line1"", """", 42, 0},
	{""\n//line File2.go:200\n  line200"", filepath.Join(""dir"", ""File2.go""), 200, 0},
	{""\n//line foo\t:42\n  line42"", filepath.Join(""dir"", ""foo""), 42, 0},
	{""\n //line foo:42\n  line44"", filepath.Join(""dir"", ""foo""), 44, 0},           // bad line comment, ignored
	{""\n//line foo 42\n  line46"", filepath.Join(""dir"", ""foo""), 46, 0},            // bad line comment, ignored
	{""\n//line foo:42 extra text\n  line48"", filepath.Join(""dir"", ""foo""), 48, 0}, // bad line comment, ignored
	{""\n//line ./foo:42\n  line42"", filepath.Join(""dir"", ""foo""), 42, 0},
	{""\n//line a/b/c/File1.go:100\n  line100"", filepath.Join(""dir"", ""a"", ""b"", ""c"", ""File1.go""), 100, 0},

	// tests for new line directive syntax
	{""\n//line :100\na1"", """", 100, 0}, // missing filename means empty filename
	{""\n//line bar:100\nb1"", filepath.Join(""dir"", ""bar""), 100, 0},
	{""\n//line :100:10\nc1"", filepath.Join(""dir"", ""bar""), 100, 10}, // missing filename means current filename
	{""\n//line foo:100:10\nd1"", filepath.Join(""dir"", ""foo""), 100, 10},

	{""\n/*line :100*/a2"", """", 100, 0}, // missing filename means empty filename
	{""\n/*line bar:100*/b2"", filepath.Join(""dir"", ""bar""), 100, 0},
	{""\n/*line :100:10*/c2"", filepath.Join(""dir"", ""bar""), 100, 10}, // missing filename means current filename
	{""\n/*line foo:100:10*/d2"", filepath.Join(""dir"", ""foo""), 100, 10},
	{""\n/*line foo:100:10*/    e2"", filepath.Join(""dir"", ""foo""), 100, 14}, // line-directive relative column
	{""\n/*line foo:100:10*/\n\nf2"", filepath.Join(""dir"", ""foo""), 102, 1},  // absolute column since on new line
	{""\n//line /bar:42\n  line42"", ""/bar"", 42, 0},
	{""\n//line c:\\bar:42\n  line42"", ""c:\\bar"", 42, 0},
	{""\n//line c:\\dir\\File1.go:100\n  line100"", ""c:\\dir\\File1.go"", 100, 0},
// Verify that line directives are interpreted correctly.
func TestLineDirectives(t *testing.T) {
	file := fset.AddFile(filepath.Join(""dir"", ""TestLineDirectives""), fset.Base(), len(src))
	S.Init(file, []byte(src), func(pos token.Position, msg string) { t.Error(Error{pos, msg}) }, dontInsertSemis)
			Column:   s.column,","	srcline  string // a line of source text
	filename string // filename for current token
	line     int    // line number for current token
	{""  line1"", filepath.Join(""dir"", ""TestLineComments""), 1},
	{""\nline2"", filepath.Join(""dir"", ""TestLineComments""), 2},
	{""\nline3  //line File1.go:100"", filepath.Join(""dir"", ""TestLineComments""), 3}, // bad line comment, ignored
	{""\nline4"", filepath.Join(""dir"", ""TestLineComments""), 4},
	{""\n//line File1.go:100\n  line100"", filepath.Join(""dir"", ""File1.go""), 100},
	{""\n//line  \t :42\n  line1"", """", 42},
	{""\n//line File2.go:200\n  line200"", filepath.Join(""dir"", ""File2.go""), 200},
	{""\n//line foo\t:42\n  line42"", filepath.Join(""dir"", ""foo""), 42},
	{""\n //line foo:42\n  line44"", filepath.Join(""dir"", ""foo""), 44},           // bad line comment, ignored
	{""\n//line foo 42\n  line46"", filepath.Join(""dir"", ""foo""), 46},            // bad line comment, ignored
	{""\n//line foo:42 extra text\n  line48"", filepath.Join(""dir"", ""foo""), 48}, // bad line comment, ignored
	{""\n//line ./foo:42\n  line42"", filepath.Join(""dir"", ""foo""), 42},
	{""\n//line a/b/c/File1.go:100\n  line100"", filepath.Join(""dir"", ""a"", ""b"", ""c"", ""File1.go""), 100},
	{""\n//line /bar:42\n  line42"", ""/bar"", 42},
	{""\n//line c:\\bar:42\n  line42"", ""c:\\bar"", 42},
	{""\n//line c:\\dir\\File1.go:100\n  line100"", ""c:\\dir\\File1.go"", 100},
// Verify that comments of the form ""//line filename:line"" are interpreted correctly.
func TestLineComments(t *testing.T) {
	file := fset.AddFile(filepath.Join(""dir"", ""TestLineComments""), fset.Base(), len(src))
	S.Init(file, []byte(src), nil, dontInsertSemis)
			Column:   pos.Column,",99c30211b1e0b3ac4e5d32f3ae5eaf759c23195f,CVE-2023-24537,99c30211b1e0b3ac4e5d32f3ae5eaf759c23195f,https://github.com/golang/go,CPE_GIT_REPOBASED,70,COMPLETED,"VAR VAR  VAR VAR  VAR, VAR VAR  {"" VAR"", VAR.VAR(""VAR"", ""VAR""), 1, 3}, {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 2, 1}, {""\VAR  {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 4, 1}, {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR  {""\VAR {""\VAR {""\VAR {""\VAR  {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR"", """", 100, 0},  {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 100, 0}, {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 100, 10},  {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 100, 10}, {""\VAR VAR"", VAR.VAR(""VAR"", ""VAR""), 100, 14},  {""\VAR\VAR\VAR"", VAR.VAR(""VAR"", ""VAR""), 102, 1},  {""\VAR {""\VAR {""\VAR  VAR VAR(VAR *VAR.VAR) { VAR := VAR.VAR(VAR.VAR(""VAR"", ""VAR""), VAR.VAR(), VAR(VAR)) VAR.VAR(VAR, []VAR(VAR), VAR(VAR VAR.VAR, VAR VAR) { VAR.VAR(VAR{VAR, VAR}) }, VAR) VAR: VAR.VAR, VAR VAR  VAR VAR  VAR VAR  {"" VAR"", VAR.VAR(""VAR"", ""VAR""), 1}, {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 2}, {""\VAR  {""\VAR"", VAR.VAR(""VAR"", ""VAR""), 4}, {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR  {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR {""\VAR  VAR VAR(VAR *VAR.VAR) { VAR := VAR.VAR(VAR.VAR(""VAR"", ""VAR""), VAR.VAR(), VAR(VAR)) VAR.VAR(VAR, []VAR(VAR), VAR, VAR) VAR: VAR.VAR,",6,6
go_bf8c7c575c8a552d9d79deb29e80854dc88528d0,src/mime/multipart/formdata_test.go,"func TestReadFormLimits(t *testing.T) {
	for _, test := range []struct {
		values           int
		files            int
		extraKeysPerFile int
		wantErr          error
		godebug          string
	}{
		{values: 1000},
		{values: 1001, wantErr: ErrMessageTooLarge},
		{values: 500, files: 500},
		{values: 501, files: 500, wantErr: ErrMessageTooLarge},
		{files: 1000},
		{files: 1001, wantErr: ErrMessageTooLarge},
		{files: 1, extraKeysPerFile: 9998}, // plus Content-Disposition and Content-Type
		{files: 1, extraKeysPerFile: 10000, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxparts=100"", values: 100},
		{godebug: ""multipartmaxparts=100"", values: 101, wantErr: ErrMessageTooLarge},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 48},
		{godebug: ""multipartmaxheaders=100"", files: 2, extraKeysPerFile: 50, wantErr: ErrMessageTooLarge},
	} {
		name := fmt.Sprintf(""values=%v/files=%v/extraKeysPerFile=%v"", test.values, test.files, test.extraKeysPerFile)
		if test.godebug != """" {
			name += fmt.Sprintf(""/godebug=%v"", test.godebug)
		}
		t.Run(name, func(t *testing.T) {
			if test.godebug != """" {
				t.Setenv(""GODEBUG"", test.godebug)
			}
			var buf bytes.Buffer
			fw := NewWriter(&buf)
			for i := 0; i < test.values; i++ {
				w, _ := fw.CreateFormField(fmt.Sprintf(""field%v"", i))
				fmt.Fprintf(w, ""value %v"", i)
			}
			for i := 0; i < test.files; i++ {
				h := make(textproto.MIMEHeader)
				h.Set(""Content-Disposition"",
					fmt.Sprintf(`form-data; name=""file%v""; filename=""file%v""`, i, i))
				h.Set(""Content-Type"", ""application/octet-stream"")
				for j := 0; j < test.extraKeysPerFile; j++ {
					h.Set(fmt.Sprintf(""k%v"", j), ""v"")
				}
				w, _ := fw.CreatePart(h)
				fmt.Fprintf(w, ""value %v"", i)
			}
			if err := fw.Close(); err != nil {
				t.Fatal(err)
			}
			fr := NewReader(bytes.NewReader(buf.Bytes()), fw.Boundary())
			form, err := fr.ReadForm(1 << 10)
			if err == nil {
				defer form.RemoveAll()
			}
			if err != test.wantErr {
				t.Errorf(""ReadForm = %v, want %v"", err, test.wantErr)
			}
		})
	}
}
",,bf8c7c575c8a552d9d79deb29e80854dc88528d0,CVE-2023-24536,bf8c7c575c8a552d9d79deb29e80854dc88528d0,https://github.com/golang/go,CPE_GIT_REPOBASED,230,COMPLETED,"VAR VAR(VAR *VAR.VAR) { VAR VAR, VAR := VAR []VAR { VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR }{ {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 500, VAR: 500}, {VAR: 501, VAR: 500, VAR: VAR}, {VAR: 1000}, {VAR: 1001, VAR: VAR}, {VAR: 1, VAR: 9998},  {VAR: 1, VAR: 10000, VAR: VAR}, {VAR: ""VAR=100"", VAR: 100}, {VAR: ""VAR=100"", VAR: 101, VAR: VAR}, {VAR: ""VAR=100"", VAR: 2, VAR: 48}, {VAR: ""VAR=100"", VAR: 2, VAR: 50, VAR: VAR}, } { VAR := VAR.VAR(""VAR=%VAR/VAR=%VAR/VAR=%VAR"", VAR.VAR, VAR.VAR, VAR.VAR) VAR VAR.VAR != """" { VAR += VAR.VAR(""/VAR=%VAR"", VAR.VAR) } VAR.VAR(VAR, VAR(VAR *VAR.VAR) { VAR VAR.VAR != """" { VAR.VAR(""VAR"", VAR.VAR) } VAR VAR VAR.VAR VAR := VAR(&VAR) VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR, VAR := VAR.VAR(VAR.VAR(""VAR%VAR"", VAR)) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR := VAR(VAR.VAR) VAR.VAR(""VAR-VAR"", VAR.VAR(`VAR-VAR; VAR=""VAR%VAR""; VAR=""VAR%VAR""`, VAR, VAR)) VAR.VAR(""VAR-VAR"", ""VAR/VAR-VAR"") VAR VAR := 0; VAR < VAR.VAR; VAR++ { VAR.VAR(VAR.VAR(""VAR%VAR"", VAR), ""VAR"") } VAR, VAR := VAR.VAR(VAR) VAR.VAR(VAR, ""VAR %VAR"", VAR) } VAR VAR := VAR.VAR(); VAR != VAR { VAR.VAR(VAR) } VAR := VAR(VAR.VAR(VAR.VAR()), VAR.VAR()) VAR, VAR := VAR.VAR(1 << 10) VAR VAR == VAR { VAR VAR.VAR() } VAR VAR != VAR.VAR { VAR.VAR(""VAR = %VAR, VAR %VAR"", VAR, VAR.VAR) } }) } } ",6,6
go_ec18f62df59d8f857e63ed3d7480754c49b072c3,src/mime/multipart/formdata.go,"		const mapEntryOverhead = 200
		maxMemoryBytes -= mapEntryOverhead
		const fileHeaderSize = 100
		maxMemoryBytes -= mapEntryOverhead
		maxMemoryBytes -= fileHeaderSize
	size = 400
		size += 200 // map entry overhead","		maxMemoryBytes -= 100 // map overhead
		size += 100 // map entry overhead",ec18f62df59d8f857e63ed3d7480754c49b072c3,CVE-2023-24536,ec18f62df59d8f857e63ed3d7480754c49b072c3,https://github.com/golang/go,CPE_GIT_REPOBASED,158,COMPLETED,VAR VAR = 200 VAR -= VAR VAR VAR = 100 VAR -= VAR VAR -= VAR VAR = 400 VAR += 200  VAR -= 100  VAR += 100 ,6,6
go_fb979a50823e5a0575cf6166b3f17a13364cbf81,src/encoding/gogobencdec_test.go,"	""reflect""

func TestIngoreDepthLimit(t *testing.T) {
	// We don't test the actual depth limit because it requires building an
	// extremely large message, which takes quite a while.
	oldNestingDepth := maxIgnoreNestingDepth
	maxIgnoreNestingDepth = 100
	defer func() { maxIgnoreNestingDepth = oldNestingDepth }()
	b := new(bytes.Buffer)
	enc := NewEncoder(b)
	typ := reflect.TypeOf(int(0))
	nested := reflect.ArrayOf(1, typ)
	for i := 0; i < 100; i++ {
		nested = reflect.ArrayOf(1, nested)
	}
	badStruct := reflect.New(reflect.StructOf([]reflect.StructField{{Name: ""F"", Type: nested}}))
	enc.Encode(badStruct.Interface())
	dec := NewDecoder(b)
	var output struct{ Hello int }
	expectedErr := ""invalid nesting depth""
	if err := dec.Decode(&output); err == nil || err.Error() != expectedErr {
		t.Errorf(""Decode didn't fail with depth limit of 100: want %q, got %q"", expectedErr, err)
	}
}",,fb979a50823e5a0575cf6166b3f17a13364cbf81,CVE-2022-30635,fb979a50823e5a0575cf6166b3f17a13364cbf81,https://github.com/golang/go,CPE_GIT_REPOBASED,158,COMPLETED,"""VAR"" VAR VAR(VAR *VAR.VAR) {   VAR := VAR VAR = 100 VAR VAR() { VAR = VAR }() VAR := VAR(VAR.VAR) VAR := VAR(VAR) VAR := VAR.VAR(VAR(0)) VAR := VAR.VAR(1, VAR) VAR VAR := 0; VAR < 100; VAR++ { VAR = VAR.VAR(1, VAR) } VAR := VAR.VAR(VAR.VAR([]VAR.VAR{{VAR: ""VAR"", VAR: VAR}})) VAR.VAR(VAR.VAR()) VAR := VAR(VAR) VAR VAR VAR{ VAR VAR } VAR := ""VAR VAR VAR"" VAR VAR := VAR.VAR(&VAR); VAR == VAR || VAR.VAR() != VAR { VAR.VAR(""VAR VAR'VAR VAR VAR VAR VAR VAR 100: VAR %VAR, VAR %VAR"", VAR, VAR) } } ",6,6
gpac_4e56ad72ac1afb4e049a10f2d99e7512d7141f9d,src/odf/desc_private.c,"static GF_Err gf_odf_read_descriptor_internal(GF_BitStream *bs, GF_Descriptor *desc, u32 DescSize)
GF_Err gf_odf_read_descriptor(GF_BitStream *bs, GF_Descriptor *desc, u32 DescSize)
{
	u64 cookie = gf_bs_get_cookie(bs);
	//we allow 100 max desc in a hierarchy - see issue 2216
	if (cookie>100)
		return GF_NON_COMPLIANT_BITSTREAM;
	gf_bs_set_cookie(bs, cookie+1);
	GF_Err e = gf_odf_read_descriptor_internal(bs, desc, DescSize);
	gf_bs_set_cookie(bs, cookie);
	return e;
}","GF_Err gf_odf_read_descriptor(GF_BitStream *bs, GF_Descriptor *desc, u32 DescSize)
",4e56ad72ac1afb4e049a10f2d99e7512d7141f9d,CVE-2022-38530,4e56ad72ac1afb4e049a10f2d99e7512d7141f9d,https://github.com/gpac/gpac,NVD_GIT_REPOBASED,98,COMPLETED,"VAR VAR VAR(VAR *VAR, VAR *VAR, VAR VAR) VAR VAR(VAR *VAR, VAR *VAR, VAR VAR) { VAR VAR = VAR(VAR);  VAR (VAR>100) VAR VAR; VAR(VAR, VAR+1); VAR VAR = VAR(VAR, VAR, VAR); VAR(VAR, VAR); VAR VAR; } VAR VAR(VAR *VAR, VAR *VAR, VAR VAR)",6,6
langchain_a2f191a32229256dd41deadf97786fe41ce04cbb,langchain/tools/jira/prompt.py,"    The input to this tool is a dictionary specifying a function from atlassian-python-api's Jira API,
    as well as a list of arguments and dictionary of keyword arguments to pass into the function.
    For example, to get all the users in a group, while increasing the max number of results to 100, you would
    pass in the following dictionary: {{""function"": ""get_all_users_from_group"", ""args"": [""group""], ""kwargs"": {{""limit"":100}} }}
    {{""function"": ""projects""}}","    The input to this tool is line of python code that calls a function from atlassian-python-api's Jira API
    For example, to update the summary field of an issue, you would pass in the following string:
    self.jira.update_issue_field(key, {{""summary"": ""New summary""}})
    self.jira.projects()",a2f191a32229256dd41deadf97786fe41ce04cbb,CVE-2023-34540,a2f191a32229256dd41deadf97786fe41ce04cbb,https://github.com/langchain-ai/langchain,GHSD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR'VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR 100, VAR VAR VAR VAR VAR VAR VAR: {{""VAR"": ""VAR"", ""VAR"": [""VAR""], ""VAR"": {{""VAR"":100}} }} {{""VAR"": ""VAR""}} VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR'VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR: VAR.VAR.VAR(VAR, {{""VAR"": ""VAR VAR""}}) VAR.VAR.VAR()",6,6
langchain_a2f191a32229256dd41deadf97786fe41ce04cbb,langchain/tools/jira/prompt.py,"    The input to this tool is a dictionary specifying a function from atlassian-python-api's Jira API,
    as well as a list of arguments and dictionary of keyword arguments to pass into the function.
    For example, to get all the users in a group, while increasing the max number of results to 100, you would
    pass in the following dictionary: {{""function"": ""get_all_users_from_group"", ""args"": [""group""], ""kwargs"": {{""limit"":100}} }}
    {{""function"": ""projects""}}","    The input to this tool is line of python code that calls a function from atlassian-python-api's Jira API
    For example, to update the summary field of an issue, you would pass in the following string:
    self.jira.update_issue_field(key, {{""summary"": ""New summary""}})
    self.jira.projects()",a2f191a32229256dd41deadf97786fe41ce04cbb,CVE-2023-34540,a2f191a32229256dd41deadf97786fe41ce04cbb,https://github.com/hwchase17/langchain,NVD_GIT_REPOBASED,106,COMPLETED,"VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR'VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR 100, VAR VAR VAR VAR VAR VAR VAR: {{""VAR"": ""VAR"", ""VAR"": [""VAR""], ""VAR"": {{""VAR"":100}} }} {{""VAR"": ""VAR""}} VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR-VAR-VAR'VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR: VAR.VAR.VAR(VAR, {{""VAR"": ""VAR VAR""}}) VAR.VAR.VAR()",6,6
linux_1202cdd665315c525b5237e96e0bedc76d7e754f,include/uapi/linux/netfilter_decnet.h,,"/* SPDX-License-Identifier: GPL-2.0 WITH Linux-syscall-note */
#ifndef __LINUX_DECNET_NETFILTER_H
#define __LINUX_DECNET_NETFILTER_H

/* DECnet-specific defines for netfilter.
 * This file (C) Steve Whitehouse 1999 derived from the
 * ipv4 netfilter header file which is
 * (C)1998 Rusty Russell -- This code is GPL.
 */

#include <linux/netfilter.h>

/* only for userspace compatibility */
#ifndef __KERNEL__

#include <limits.h> /* for INT_MIN, INT_MAX */

/* kernel define is in netfilter_defs.h */
#define NF_DN_NUMHOOKS		7
#endif /* ! __KERNEL__ */

/* DECnet Hooks */
/* After promisc drops, checksum checks. */
#define NF_DN_PRE_ROUTING	0
/* If the packet is destined for this box. */
#define NF_DN_LOCAL_IN		1
/* If the packet is destined for another interface. */
#define NF_DN_FORWARD		2
/* Packets coming from a local process. */
#define NF_DN_LOCAL_OUT		3
/* Packets about to hit the wire. */
#define NF_DN_POST_ROUTING	4
/* Input Hello Packets */
#define NF_DN_HELLO		5
/* Input Routing Packets */
#define NF_DN_ROUTE		6

enum nf_dn_hook_priorities {
	NF_DN_PRI_FIRST = INT_MIN,
	NF_DN_PRI_CONNTRACK = -200,
	NF_DN_PRI_MANGLE = -150,
	NF_DN_PRI_NAT_DST = -100,
	NF_DN_PRI_FILTER = 0,
	NF_DN_PRI_NAT_SRC = 100,
	NF_DN_PRI_DNRTMSG = 200,
	NF_DN_PRI_LAST = INT_MAX,
};

struct nf_dn_rtmsg {
	int nfdn_ifindex;
};

#define NFDN_RTMSG(r) ((unsigned char *)(r) + NLMSG_ALIGN(sizeof(struct nf_dn_rtmsg)))

#ifndef __KERNEL__
/* backwards compatibility for userspace */
#define DNRMG_L1_GROUP 0x01
#define DNRMG_L2_GROUP 0x02
#endif

enum {
	DNRNG_NLGRP_NONE,
#define DNRNG_NLGRP_NONE	DNRNG_NLGRP_NONE
	DNRNG_NLGRP_L1,
#define DNRNG_NLGRP_L1		DNRNG_NLGRP_L1
	DNRNG_NLGRP_L2,
#define DNRNG_NLGRP_L2		DNRNG_NLGRP_L2
	__DNRNG_NLGRP_MAX
};
#define DNRNG_NLGRP_MAX	(__DNRNG_NLGRP_MAX - 1)

#endif /*__LINUX_DECNET_NETFILTER_H*/",1202cdd665315c525b5237e96e0bedc76d7e754f,CVE-2023-3338,1202cdd665315c525b5237e96e0bedc76d7e754f,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,96,COMPLETED,"    /* VAR-VAR VAR VAR VAR. * VAR VAR (VAR) VAR VAR 1999 VAR VAR VAR * VAR VAR VAR VAR VAR VAR * (VAR)1998 VAR VAR -- VAR VAR VAR VAR. */                       VAR VAR { VAR = VAR, VAR = -200, VAR = -150, VAR = -100, VAR = 0, VAR = 100, VAR = 200, VAR = VAR, }; VAR VAR { VAR VAR; };       VAR { VAR,  VAR,  VAR,  VAR };  ",6,6
linux_75ff39ccc1bd5d3c455b6822ab09e533c551f758,net/ipv4/tcp_input.c,"int sysctl_tcp_challenge_ack_limit = 1000;
	u32 count, now;
	/* Then check host-wide RFC 5961 rate limit. */
		u32 half = (sysctl_tcp_challenge_ack_limit + 1) >> 1;

		WRITE_ONCE(challenge_count, half +
			   prandom_u32_max(sysctl_tcp_challenge_ack_limit));
	count = READ_ONCE(challenge_count);
	if (count > 0) {
		WRITE_ONCE(challenge_count, count - 1);","int sysctl_tcp_challenge_ack_limit = 100;
	u32 now;
	/* Then check the check host-wide RFC 5961 rate limit. */
		challenge_count = 0;
	if (++challenge_count <= sysctl_tcp_challenge_ack_limit) {",75ff39ccc1bd5d3c455b6822ab09e533c551f758,CVE-2016-5696,75ff39ccc1bd5d3c455b6822ab09e533c551f758,https://github.com/torvalds/linux,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = 1000; VAR VAR, VAR;  VAR VAR = (VAR + 1) >> 1; VAR(VAR, VAR + VAR(VAR)); VAR = VAR(VAR); VAR (VAR > 0) { VAR(VAR, VAR - 1); VAR VAR = 100; VAR VAR;  VAR = 0; VAR (++VAR <= VAR) {",14,6
linux_8914a595110a6eca69a5e275b323f5d09e18f4f9,drivers/net/ethernet/broadcom/bnx2x/bnx2x_main.c,"	/*
	 * A skb with gso_size + header length > 9700 will cause a
	 * firmware panic. Drop GSO support.
	 *
	 * Eventually the upper layer should not pass these packets down.
	 *
	 * For speed, if the gso_size is <= 9000, assume there will
	 * not be 700 bytes of headers and pass it through. Only do a
	 * full (slow) validation if the gso_size is > 9000.
	 *
	 * (Due to the way SKB_BY_FRAGS works this will also do a full
	 * validation in that case.)
	 */
	if (unlikely(skb_is_gso(skb) &&
		     (skb_shinfo(skb)->gso_size > 9000) &&
		     !skb_gso_validate_mac_len(skb, 9700)))
		features &= ~NETIF_F_GSO_MASK;
",,8914a595110a6eca69a5e275b323f5d09e18f4f9,CVE-2018-1000026,8914a595110a6eca69a5e275b323f5d09e18f4f9,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,72,COMPLETED,"/* * VAR VAR VAR VAR + VAR VAR > 9700 VAR VAR VAR * VAR VAR. VAR VAR VAR. * * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. * * VAR VAR, VAR VAR VAR VAR <= 9000, VAR VAR VAR * VAR VAR 700 VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR * VAR (VAR) VAR VAR VAR VAR VAR > 9000. * * (VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * VAR VAR VAR VAR.) */ VAR (VAR(VAR(VAR) && (VAR(VAR)->VAR > 9000) && !VAR(VAR, 9700))) VAR &= ~VAR; ",0,6
linux_ab7ad7f6451580aa7eccc0ba62807c872088a8f9,drivers/gpu/drm/i915/intel_display.c,"/*
 * intel_wait_for_pipe_off - wait for pipe to turn off
 * On Gen4 and above:
 *   wait for the pipe register state bit to turn off
 *
 * Otherwise:
 *   wait for the display line value to settle (it usually
 *   ends up stopping at the start of the next frame).
 *
static void intel_wait_for_pipe_off(struct drm_device *dev, int pipe)

	if (INTEL_INFO(dev)->gen >= 4) {
		int pipeconf_reg = (pipe == 0 ? PIPEACONF : PIPEBCONF);

		/* Wait for the Pipe State to go off */
		if (wait_for((I915_READ(pipeconf_reg) & I965_PIPECONF_ACTIVE) == 0,
			     100, 0))
			DRM_DEBUG_KMS(""pipe_off wait timed out\n"");
	} else {
		u32 last_line;
		int pipedsl_reg = (pipe == 0 ? PIPEADSL : PIPEBDSL);
		unsigned long timeout = jiffies + msecs_to_jiffies(100);

		/* Wait for the display line to settle */
		do {
			last_line = I915_READ(pipedsl_reg) & DSL_LINEMASK;
			mdelay(5);
		} while (((I915_READ(pipedsl_reg) & DSL_LINEMASK) != last_line) &&
			 time_after(timeout, jiffies));
		if (time_after(jiffies, timeout))
			DRM_DEBUG_KMS(""pipe_off wait timed out\n"");
	}
		    (dev_priv->quirks & QUIRK_PIPEA_FORCE)) {
			/* Wait for vblank for the disable to take effect */
			intel_wait_for_vblank(dev, pipe);
		}
		/* Wait for the pipe to turn off */
		intel_wait_for_pipe_off(dev, pipe);","/**
 * intel_wait_for_vblank_off - wait for vblank after disabling a pipe
 * So this function waits for the display line value to settle (it
 * usually ends up stopping at the start of the next frame).
void intel_wait_for_vblank_off(struct drm_device *dev, int pipe)
	int pipedsl_reg = (pipe == 0 ? PIPEADSL : PIPEBDSL);
	unsigned long timeout = jiffies + msecs_to_jiffies(100);
	u32 last_line;

	/* Wait for the display line to settle */
	do {
		last_line = I915_READ(pipedsl_reg) & DSL_LINEMASK;
		mdelay(5);
	} while (((I915_READ(pipedsl_reg) & DSL_LINEMASK) != last_line) &&
		 time_after(timeout, jiffies));

	if (time_after(jiffies, timeout))
		DRM_DEBUG_KMS(""vblank wait timed out\n"");
		/* Wait for vblank for the disable to take effect */
		intel_wait_for_vblank_off(dev, pipe);

		    (dev_priv->quirks & QUIRK_PIPEA_FORCE))
		/* Wait for vblank for the disable to take effect. */
		intel_wait_for_vblank_off(dev, pipe);",ab7ad7f6451580aa7eccc0ba62807c872088a8f9,CVE-2010-2962,ab7ad7f6451580aa7eccc0ba62807c872088a8f9,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,80,COMPLETED,"/* * VAR - VAR VAR VAR VAR VAR VAR * VAR VAR VAR VAR: * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR * * VAR: * VAR VAR VAR VAR VAR VAR VAR VAR (VAR VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR). * VAR VAR VAR(VAR VAR *VAR, VAR VAR) VAR (VAR(VAR)->VAR >= 4) { VAR VAR = (VAR == 0 ? VAR : VAR);  VAR (VAR((VAR(VAR) & VAR) == 0, 100, 0)) VAR(""VAR VAR VAR VAR\VAR""); } VAR { VAR VAR; VAR VAR = (VAR == 0 ? VAR : VAR); VAR VAR VAR = VAR + VAR(100);  VAR { VAR = VAR(VAR) & VAR; VAR(5); } VAR (((VAR(VAR) & VAR) != VAR) && VAR(VAR, VAR)); VAR (VAR(VAR, VAR)) VAR(""VAR VAR VAR VAR\VAR""); } (VAR->VAR & VAR)) {  VAR(VAR, VAR); }  VAR(VAR, VAR); /** * VAR - VAR VAR VAR VAR VAR VAR VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR (VAR * VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR). VAR VAR(VAR VAR *VAR, VAR VAR) VAR VAR = (VAR == 0 ? VAR : VAR); VAR VAR VAR = VAR + VAR(100); VAR VAR;  VAR { VAR = VAR(VAR) & VAR; VAR(5); } VAR (((VAR(VAR) & VAR) != VAR) && VAR(VAR, VAR)); VAR (VAR(VAR, VAR)) VAR(""VAR VAR VAR VAR\VAR"");  VAR(VAR, VAR); (VAR->VAR & VAR))  VAR(VAR, VAR);",6,6
linux_ca22da2fbd693b54dc8e3b7b54ccc9f7e9ba3640,tools/testing/selftests/net/forwarding/tc_actions.sh,"	gact_trap_test mirred_egress_to_ingress_test \
	mirred_egress_to_ingress_tcp_test""
mirred_egress_to_ingress_tcp_test()
{
	local tmpfile=$(mktemp) tmpfile1=$(mktemp)

	RET=0
	dd conv=sparse status=none if=/dev/zero bs=1M count=2 of=$tmpfile
	tc filter add dev $h1 protocol ip pref 100 handle 100 egress flower \
		$tcflags ip_proto tcp src_ip 192.0.2.1 dst_ip 192.0.2.2 \
			action ct commit nat src addr 192.0.2.2 pipe \
			action ct clear pipe \
			action ct commit nat dst addr 192.0.2.1 pipe \
			action ct clear pipe \
			action skbedit ptype host pipe \
			action mirred ingress redirect dev $h1
	tc filter add dev $h1 protocol ip pref 101 handle 101 egress flower \
		$tcflags ip_proto icmp \
			action mirred ingress redirect dev $h1
	tc filter add dev $h1 protocol ip pref 102 handle 102 ingress flower \
		ip_proto icmp \
			action drop

	ip vrf exec v$h1 nc --recv-only -w10 -l -p 12345 -o $tmpfile1  &
	local rpid=$!
	ip vrf exec v$h1 nc -w1 --send-only 192.0.2.2 12345 <$tmpfile
	wait -n $rpid
	cmp -s $tmpfile $tmpfile1
	check_err $? ""server output check failed""

	$MZ $h1 -c 10 -p 64 -a $h1mac -b $h1mac -A 192.0.2.1 -B 192.0.2.1 \
		-t icmp ""ping,id=42,seq=5"" -q
	tc_check_packets ""dev $h1 egress"" 101 10
	check_err $? ""didn't mirred redirect ICMP""
	tc_check_packets ""dev $h1 ingress"" 102 10
	check_err $? ""didn't drop mirred ICMP""
	local overlimits=$(tc_rule_stats_get ${h1} 101 egress .overlimits)
	test ${overlimits} = 10
	check_err $? ""wrong overlimits, expected 10 got ${overlimits}""

	tc filter del dev $h1 egress protocol ip pref 100 handle 100 flower
	tc filter del dev $h1 egress protocol ip pref 101 handle 101 flower
	tc filter del dev $h1 ingress protocol ip pref 102 handle 102 flower

	rm -f $tmpfile $tmpfile1
	log_test ""mirred_egress_to_ingress_tcp ($tcflags)""
}
","	gact_trap_test mirred_egress_to_ingress_test""",ca22da2fbd693b54dc8e3b7b54ccc9f7e9ba3640,CVE-2022-4269,ca22da2fbd693b54dc8e3b7b54ccc9f7e9ba3640,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,80,COMPLETED,"VAR VAR \ VAR"" VAR() { VAR VAR=$(VAR) VAR=$(VAR) VAR=0 VAR VAR=VAR VAR=VAR VAR=/VAR/VAR VAR=1M VAR=2 VAR=$VAR VAR VAR VAR VAR $VAR VAR VAR VAR 100 VAR 100 VAR VAR \ $VAR VAR VAR VAR 192.0.2.1 VAR 192.0.2.2 \ VAR VAR VAR VAR VAR VAR 192.0.2.2 VAR \ VAR VAR VAR VAR \ VAR VAR VAR VAR VAR VAR 192.0.2.1 VAR \ VAR VAR VAR VAR \ VAR VAR VAR VAR VAR \ VAR VAR VAR VAR VAR $VAR VAR VAR VAR VAR $VAR VAR VAR VAR 101 VAR 101 VAR VAR \ $VAR VAR VAR \ VAR VAR VAR VAR VAR $VAR VAR VAR VAR VAR $VAR VAR VAR VAR 102 VAR 102 VAR VAR \ VAR VAR \ VAR VAR VAR VAR VAR VAR$VAR VAR --VAR-VAR -VAR -VAR -VAR 12345 -VAR $VAR & VAR VAR=$! VAR VAR VAR VAR$VAR VAR -VAR --VAR-VAR 192.0.2.2 12345 <$VAR VAR -VAR $VAR VAR -VAR $VAR $VAR VAR $? ""VAR VAR VAR VAR"" $VAR $VAR -VAR 10 -VAR 64 -VAR $VAR -VAR $VAR -VAR 192.0.2.1 -VAR 192.0.2.1 \ -VAR VAR ""VAR,VAR=42,VAR=5"" -VAR VAR ""VAR $VAR VAR"" 101 10 VAR $? ""VAR'VAR VAR VAR VAR"" VAR ""VAR $VAR VAR"" 102 10 VAR $? ""VAR'VAR VAR VAR VAR"" VAR VAR=$(VAR ${VAR} 101 VAR .VAR) VAR ${VAR} = 10 VAR $? ""VAR VAR, VAR 10 VAR ${VAR}"" VAR VAR VAR VAR $VAR VAR VAR VAR VAR 100 VAR 100 VAR VAR VAR VAR VAR $VAR VAR VAR VAR VAR 101 VAR 101 VAR VAR VAR VAR VAR $VAR VAR VAR VAR VAR 102 VAR 102 VAR VAR -VAR $VAR $VAR VAR ""VAR ($VAR)"" } VAR VAR""",0,6
linux_fc00a1d90d7b64e44c2475833cc3021066f67ea7,drivers/media/video/cx25840/cx25840-core.c,"			0, 65535, 65535 / 100, default_volume);","			0, 65335, 65535 / 100, default_volume);",fc00a1d90d7b64e44c2475833cc3021066f67ea7,CVE-2010-4079,fc00a1d90d7b64e44c2475833cc3021066f67ea7,https://github.com/torvalds/linux,CPE_DIRECT_COMMIT,68,COMPLETED,"0, 65535, 65535 / 100, VAR); 0, 65335, 65535 / 100, VAR);",0,6
MISP_75acd63c46506ad404764c3a3de7d4ca11d0560f,app/Model/User.php,"
    public function resetAllSyncAuthKeysRouter($user, $jobId = false)
    {
        if (Configure::read('MISP.background_jobs')) {
            $job = ClassRegistry::init('Job');
            $job->create();
            $eventModel = ClassRegistry::init('Event');
            $data = array(
                    'worker' => $eventModel->__getPrioWorkerIfPossible(),
                    'job_type' => __('reset_all_sync_api_keys'),
                    'job_input' => __('Reseting all API keys'),
                    'status' => 0,
                    'retries' => 0,
                    'org_id' => $user['org_id'],
                    'org' => $user['Organisation']['name'],
                    'message' => 'Issuing new API keys to all sync users.',
            );
            $job->save($data);
            $jobId = $job->id;
            $process_id = CakeResque::enqueue(
                    'prio',
                    'AdminShell',
                    array('resetSyncAuthkeys', $user['id'], $jobId),
                    true
            );
            $job->saveField('process_id', $process_id);
            return true;
        } else {
            return $this->resetAllSyncAuthKeys($user);
        }
    }

    public function resetAllSyncAuthKeys($user, $jobId = false)
    {
        $affected_users = $this->find('all', array(
            'recursive' => -1,
            'contain' => array('Role'),
            'conditions' => array(
                'OR' => array(
                    'Role.perm_sync' => 1,
                    'Role.perm_admin' => 1
                ),
                'Role.perm_site_admin' => 0
            )
        ));
        $results = array('success' => 0, 'fails' => 0);
        $user_count = count($affected_users);
        if ($jobId) {
            $job = ClassRegistry::init('Job');
            $existingJob = $job->find('first', array(
                'conditions' => array('Job.id' => $jobId),
                'recursive' => -1
            ));
            if (empty($existingJob)) {
                $jobId = false;
            }
        }
        foreach ($affected_users as $k => $affected_user) {
            try {
                $reset_result = $this->resetauthkey($user, $affected_user['User']['id'], true);
                if ($reset_result) {
                    $results['success'] += 1;
                } else {
                    $results['fails'] += 1;
                }
            } catch (Exception $e) {
                $results['fails'] += 1;
            }
            if ($jobId) {
                if ($k % 100 == 0) {
                    $job->id =  $jobId;
                    $job->saveField('progress', 100 * (($k + 1) / count($user_count)));
                    $job->saveField('message', __('Reset in progress - %s/%s.', $k, $user_count));
                }
            }
        }
        if ($jobId) {
            $message = __('%s authkeys reset, %s could not be reset', $results['success'], $results['fails']);
            $job->saveField('progress', 100);
            $job->saveField('message', $message);
            $job->saveField('status', 4);
        }
        return $results;
    }

    public function resetauthkey($user, $id, $alert = false)
    {
        $this->id = $id;
        if (!$id || !$this->exists($id)) {
            return false;
        }
        $updatedUser = $this->read();
        $oldKey = $this->data['User']['authkey'];
        if (empty($user['Role']['perm_site_admin']) && !($user['Role']['perm_admin'] && $user['org_id'] == $updatedUser['User']['org_id']) && ($user['id'] != $id)) {
            return false;
        }
        $newkey = $this->generateAuthKey();
        $this->saveField('authkey', $newkey);
        $this->extralog(
                $user,
                'reset_auth_key',
                sprintf(
                    __('Authentication key for user %s (%s) updated.'),
                    $updatedUser['User']['id'],
                    $updatedUser['User']['email']
                ),
                $fieldsResult = 'authkey(' . $oldKey . ') => (' . $newkey . ')',
                $updatedUser
        );
        if ($alert) {
            $baseurl = Configure::read('MISP.external_baseurl');
            if (empty($baseurl)) {
                $baseurl = Configure::read('MISP.baseurl');
            }
            $body = __(
                ""Dear user,\n\nan API key reset has been triggered by an administrator for your user account on %s.\n\nYour new API key is: %s\n\nPlease update your server's sync setup to reflect this change.\n\nWe apologise for the inconvenience."",
                $baseurl,
                $newkey
            );
            $bodyNoEnc = __(
                ""Dear user,\n\nan API key reset has been triggered by an administrator for your user account on %s.\n\nYour new API key can be retrieved by logging in using this sync user's account.\n\nPlease update your server's sync setup to reflect this change.\n\nWe apologise for the inconvenience."",
                $baseurl,
                $newkey
            );
            $this->sendEmail(
                $updatedUser,
                $body,
                $bodyNoEnc,
                __('API key reset by administrator')
            );
        }
        return $newkey;
    }

    public function extralog($user, $action = null, $description = null, $fieldsResult = null, $modifiedUser = null)
    {
        // new data
        $model = 'User';
        $modelId = $user['id'];
        if (!empty($modifiedUser)) {
            $modelId = $modifiedUser['User']['id'];
        }
        if ($action == 'login') {
            $description = ""User ("" . $user['id'] . ""): "" . $user['email'];
        } elseif ($action == 'logout') {
            $description = ""User ("" . $user['id'] . ""): "" . $user['email'];
        } elseif ($action == 'edit') {
            $description = ""User ("" . $modifiedUser['User']['id'] . ""): "" . $modifiedUser['User']['email'];
        } elseif ($action == 'change_pw') {
            $description = ""User ("" . $modifiedUser['User']['id'] . ""): "" . $modifiedUser['User']['email'];
            $fieldsResult = ""Password changed."";
        }

        // query
        $this->Log = ClassRegistry::init('Log');
        $this->Log->create();
        $this->Log->save(array(
            'org' => $user['Organisation']['name'],
            'model' => $model,
            'model_id' => $modelId,
            'email' => $user['email'],
            'action' => $action,
            'title' => $description,
            'change' => isset($fieldsResult) ? $fieldsResult : ''));

        // write to syslogd as well
        App::import('Lib', 'SysLog.SysLog');
        $syslog = new SysLog();
        $syslog->write('notice', $description . ' -- ' . $action . (empty($fieldResult) ? '' : '-- ' . $fieldResult));
    }",,75acd63c46506ad404764c3a3de7d4ca11d0560f,CVE-2019-16202,75acd63c46506ad404764c3a3de7d4ca11d0560f,https://github.com/MISP/MISP,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR VAR($VAR, $VAR = VAR) { VAR (VAR::VAR('VAR.VAR')) { $VAR = VAR::VAR('VAR'); $VAR->VAR(); $VAR = VAR::VAR('VAR'); $VAR = VAR( 'VAR' => $VAR->VAR(), 'VAR' => VAR('VAR'), 'VAR' => VAR('VAR VAR VAR VAR'), 'VAR' => 0, 'VAR' => 0, 'VAR' => $VAR['VAR'], 'VAR' => $VAR['VAR']['VAR'], 'VAR' => 'VAR VAR VAR VAR VAR VAR VAR VAR.', ); $VAR->VAR($VAR); $VAR = $VAR->VAR; $VAR = VAR::VAR( 'VAR', 'VAR', VAR('VAR', $VAR['VAR'], $VAR), VAR ); $VAR->VAR('VAR', $VAR); VAR VAR; } VAR { VAR $VAR->VAR($VAR); } } VAR VAR VAR($VAR, $VAR = VAR) { $VAR = $VAR->VAR('VAR', VAR( 'VAR' => -1, 'VAR' => VAR('VAR'), 'VAR' => VAR( 'VAR' => VAR( 'VAR.VAR' => 1, 'VAR.VAR' => 1 ), 'VAR.VAR' => 0 ) )); $VAR = VAR('VAR' => 0, 'VAR' => 0); $VAR = VAR($VAR); VAR ($VAR) { $VAR = VAR::VAR('VAR'); $VAR = $VAR->VAR('VAR', VAR( 'VAR' => VAR('VAR.VAR' => $VAR), 'VAR' => -1 )); VAR (VAR($VAR)) { $VAR = VAR; } } VAR ($VAR VAR $VAR => $VAR) { VAR { $VAR = $VAR->VAR($VAR, $VAR['VAR']['VAR'], VAR); VAR ($VAR) { $VAR['VAR'] += 1; } VAR { $VAR['VAR'] += 1; } } VAR (VAR $VAR) { $VAR['VAR'] += 1; } VAR ($VAR) { VAR ($VAR % 100 == 0) { $VAR->VAR = $VAR; $VAR->VAR('VAR', 100 * (($VAR + 1) / VAR($VAR))); $VAR->VAR('VAR', VAR('VAR VAR VAR - %VAR/%VAR.', $VAR, $VAR)); } } } VAR ($VAR) { $VAR = VAR('%VAR VAR VAR, %VAR VAR VAR VAR VAR', $VAR['VAR'], $VAR['VAR']); $VAR->VAR('VAR', 100); $VAR->VAR('VAR', $VAR); $VAR->VAR('VAR', 4); } VAR $VAR; } VAR VAR VAR($VAR, $VAR, $VAR = VAR) { $VAR->VAR = $VAR; VAR (!$VAR || !$VAR->VAR($VAR)) { VAR VAR; } $VAR = $VAR->VAR(); $VAR = $VAR->VAR['VAR']['VAR']; VAR (VAR($VAR['VAR']['VAR']) && !($VAR['VAR']['VAR'] && $VAR['VAR'] == $VAR['VAR']['VAR']) && ($VAR['VAR'] != $VAR)) { VAR VAR; } $VAR = $VAR->VAR(); $VAR->VAR('VAR', $VAR); $VAR->VAR( $VAR, 'VAR', VAR( VAR('VAR VAR VAR VAR %VAR (%VAR) VAR.'), $VAR['VAR']['VAR'], $VAR['VAR']['VAR'] ), $VAR = 'VAR(' . $VAR . ') => (' . $VAR . ')', $VAR ); VAR ($VAR) { $VAR = VAR::VAR('VAR.VAR'); VAR (VAR($VAR)) { $VAR = VAR::VAR('VAR.VAR'); } $VAR = VAR( ""VAR VAR,\VAR\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR %VAR.\VAR\VAR VAR VAR VAR VAR: %VAR\VAR\VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR VAR."", $VAR, $VAR ); $VAR = VAR( ""VAR VAR,\VAR\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR %VAR.\VAR\VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR.\VAR\VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR.\VAR\VAR VAR VAR VAR VAR."", $VAR, $VAR ); $VAR->VAR( $VAR, $VAR, $VAR, VAR('VAR VAR VAR VAR VAR') ); } VAR $VAR; } VAR VAR VAR($VAR, $VAR = VAR, $VAR = VAR, $VAR = VAR, $VAR = VAR) {  $VAR = 'VAR'; $VAR = $VAR['VAR']; VAR (!VAR($VAR)) { $VAR = $VAR['VAR']['VAR']; } VAR ($VAR == 'VAR') { $VAR = ""VAR ("" . $VAR['VAR'] . ""): "" . $VAR['VAR']; } VAR ($VAR == 'VAR') { $VAR = ""VAR ("" . $VAR['VAR'] . ""): "" . $VAR['VAR']; } VAR ($VAR == 'VAR') { $VAR = ""VAR ("" . $VAR['VAR']['VAR'] . ""): "" . $VAR['VAR']['VAR']; } VAR ($VAR == 'VAR') { $VAR = ""VAR ("" . $VAR['VAR']['VAR'] . ""): "" . $VAR['VAR']['VAR']; $VAR = ""VAR VAR.""; }  $VAR->VAR = VAR::VAR('VAR'); $VAR->VAR->VAR(); $VAR->VAR->VAR(VAR( 'VAR' => $VAR['VAR']['VAR'], 'VAR' => $VAR, 'VAR' => $VAR, 'VAR' => $VAR['VAR'], 'VAR' => $VAR, 'VAR' => $VAR, 'VAR' => VAR($VAR) ? $VAR : ''));  VAR::VAR('VAR', 'VAR.VAR'); $VAR = VAR VAR(); $VAR->VAR('VAR', $VAR . ' -- ' . $VAR . (VAR($VAR) ? '' : '-- ' . $VAR)); } ",6,6
parse-server_78b59fb26b1c36e3cdbd42ba9fec025003267f58,spec/ParseLiveQuery.spec.js,"  it('should not broadcast event to client with invalid session token - avisory GHSA-2xm2-xj2q-qgpj', async done => {
    await reconfigureServer({
      liveQuery: {
        classNames: ['TestObject'],
      },
      liveQueryServerOptions: {
        cacheTimeout: 100,
      },
      startLiveQueryServer: true,
      verbose: false,
      silent: true,
      cacheTTL: 100,
    });
    const user = new Parse.User();
    user.setUsername('username');
    user.setPassword('password');
    await user.signUp();
    const obj1 = new Parse.Object('TestObject');
    const obj1ACL = new Parse.ACL();
    obj1ACL.setPublicReadAccess(false);
    obj1ACL.setReadAccess(user, true);
    obj1.setACL(obj1ACL);
    const obj2 = new Parse.Object('TestObject');
    const obj2ACL = new Parse.ACL();
    obj2ACL.setPublicReadAccess(false);
    obj2ACL.setReadAccess(user, true);
    obj2.setACL(obj2ACL);
    const query = new Parse.Query('TestObject');
    const subscription = await query.subscribe();
    subscription.on('create', obj => {
      if (obj.id !== obj1.id) {
        done.fail('should not fire');
      }
    });
    await obj1.save();
    await Parse.User.logOut();
    await new Promise(resolve => setTimeout(resolve, 200));
    await obj2.save();
    await new Promise(resolve => setTimeout(resolve, 200));
    done();
  });
",,78b59fb26b1c36e3cdbd42ba9fec025003267f58,CVE-2020-15270,78b59fb26b1c36e3cdbd42ba9fec025003267f58,https://github.com/parse-community/parse-server,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR('VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR - VAR VAR-2xm2-VAR-VAR', VAR VAR => { VAR VAR({ VAR: { VAR: ['VAR'], }, VAR: { VAR: 100, }, VAR: VAR, VAR: VAR, VAR: VAR, VAR: 100, }); VAR VAR = VAR VAR.VAR(); VAR.VAR('VAR'); VAR.VAR('VAR'); VAR VAR.VAR(); VAR VAR = VAR VAR.VAR('VAR'); VAR VAR = VAR VAR.VAR(); VAR.VAR(VAR); VAR.VAR(VAR, VAR); VAR.VAR(VAR); VAR VAR = VAR VAR.VAR('VAR'); VAR VAR = VAR VAR.VAR(); VAR.VAR(VAR); VAR.VAR(VAR, VAR); VAR.VAR(VAR); VAR VAR = VAR VAR.VAR('VAR'); VAR VAR = VAR VAR.VAR(); VAR.VAR('VAR', VAR => { VAR (VAR.VAR !== VAR.VAR) { VAR.VAR('VAR VAR VAR'); } }); VAR VAR.VAR(); VAR VAR.VAR.VAR(); VAR VAR VAR(VAR => VAR(VAR, 200)); VAR VAR.VAR(); VAR VAR VAR(VAR => VAR(VAR, 200)); VAR(); }); ",6,6
strapi_dceea7201be843d7904c04eb83a6585140c4c0e2,packages/plugins/documentation/admin/src/pages/PluginPage/tests/server.js,"      ctx.delay(100),","      ctx.delay(1000),",dceea7201be843d7904c04eb83a6585140c4c0e2,CVE-2022-27263,dceea7201be843d7904c04eb83a6585140c4c0e2,https://github.com/strapi/strapi,NVD_GIT_REPOBASED,102,COMPLETED,"VAR.VAR(100), VAR.VAR(1000),",6,6
strapi_dceea7201be843d7904c04eb83a6585140c4c0e2,packages/plugins/documentation/admin/src/pages/PluginPage/tests/server.js,"      ctx.delay(100),","      ctx.delay(1000),",dceea7201be843d7904c04eb83a6585140c4c0e2,CVE-2022-29894,dceea7201be843d7904c04eb83a6585140c4c0e2,https://github.com/strapi/strapi,NVD_GIT_REPOBASED,110,COMPLETED,"VAR.VAR(100), VAR.VAR(1000),",6,6
tuleap_ff75f2899c60a4546ee2d532e68a3febd07bdd14,src/www/cvs/commit_utils.php,"/**
 * @psalm-return array<array{order:""ASC""|""DESC"", column: ""id""|""revision""|""did""|""description""|""c_when""|""date""|""f_when""|""who""}>
 */
function commit_criteria_list_to_query(string $criteria_list): array
    $order_list = [];
    foreach (explode(',', $criteria_list) as $criteria) {
        if (preg_match('/^(?<column>[a-z]+)(?<order>[<>]?)$/', $criteria, $matches) === 1) {
            $column = $matches['column'];
            if (! in_array($column, ['id', 'revision', 'did', 'description', 'c_when', 'date', 'f_when', 'who'], true)) {
                continue;
            }
            $order = 'ASC';
            if ($matches['order'] === '<') {
                $order = 'DESC';
            }
            $order_list[] = ['order' => $order, 'column' => $column];
        }
    }
    return $order_list;
        $purifier = Codendi_HTMLPurifier::instance();

            $arr_text[] = '<a href=""' . $url . '&morder=' . $purifier->purify(urlencode($morder)) . '#results"">' .
            $purifier->purify(commit_field_get_label($attr)) . '</a><img src=""' . util_get_dir_image_theme() .
/**
 * @psalm-param array<array{order:""ASC""|""DESC"", column: ""id""|""revision""|""did""|""description""|""c_when""|""date""|""f_when""|""who""}> $order_by
 */
function cvs_get_revisions($project, $offset, $chunksz, $_tag = 100, $_branch = 100, $_commit_id = '', $_commiter = 100, $_srch = '', array $order_by = [], $pv = 0)
    if (empty($order_by)) {
        $order_by_sql = ' ORDER BY id desc, f_when desc ';
    } else {
        $order_by_sql = ' ORDER BY ';
        $order_by_sql .= implode(
            ',',
            array_map(
                static function (array $order_by_row) {
                    return $order_by_row['column'] . ' ' . $order_by_row['order'];
                },
                $order_by
            )
        );
        $order_by_sql .= ' ';
    $order_by_sql .","// Transform criteria list to SQL query (+ means ascending
// - is descending)
function commit_criteria_list_to_query($criteria_list)
    $criteria_list = str_replace('>', ' ASC', $criteria_list);
    $criteria_list = str_replace('<', ' DESC', $criteria_list);

    return $criteria_list;
            $arr_text[] = '<a href=""' . $url . '&morder=' . $morder . '#results"">' .
            commit_field_get_label($attr) . '</a><img src=""' . util_get_dir_image_theme() .
function cvs_get_revisions(&$project, $offset, $chunksz, $_tag = 100, $_branch = 100, $_commit_id = '', $_commiter = 100, $_srch = '', $order_by = '', $pv = 0)
    if (! $order_by) {
        $order_by = "" ORDER BY id desc, f_when desc "";
    $order_by .",ff75f2899c60a4546ee2d532e68a3febd07bdd14,CVE-2021-41155,ff75f2899c60a4546ee2d532e68a3febd07bdd14,https://github.com/Enalean/tuleap,NVD_DIRECT_COMMIT,1337,COMPLETED,"/** * @VAR-VAR VAR<VAR{VAR:""VAR""|""VAR"", VAR: ""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""}> */ VAR VAR(VAR $VAR): VAR $VAR = []; VAR (VAR(',', $VAR) VAR $VAR) { VAR (VAR('/^(?<VAR>[VAR-VAR]+)(?<VAR>[<>]?)$/', $VAR, $VAR) === 1) { $VAR = $VAR['VAR']; VAR (! VAR($VAR, ['VAR', 'VAR', 'VAR', 'VAR', 'VAR', 'VAR', 'VAR', 'VAR'], VAR)) { VAR; } $VAR = 'VAR'; VAR ($VAR['VAR'] === '<') { $VAR = 'VAR'; } $VAR[] = ['VAR' => $VAR, 'VAR' => $VAR]; } } VAR $VAR; $VAR = VAR::VAR(); $VAR[] = '<VAR VAR=""' . $VAR . '&VAR=' . $VAR->VAR(VAR($VAR)) . ' $VAR->VAR(VAR($VAR)) . '</VAR><VAR VAR=""' . VAR() . /** * @VAR-VAR VAR<VAR{VAR:""VAR""|""VAR"", VAR: ""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""|""VAR""}> $VAR */ VAR VAR($VAR, $VAR, $VAR, $VAR = 100, $VAR = 100, $VAR = '', $VAR = 100, $VAR = '', VAR $VAR = [], $VAR = 0) VAR (VAR($VAR)) { $VAR = ' VAR VAR VAR VAR, VAR VAR '; } VAR { $VAR = ' VAR VAR '; $VAR .= VAR( ',', VAR( VAR VAR (VAR $VAR) { VAR $VAR['VAR'] . ' ' . $VAR['VAR']; }, $VAR ) ); $VAR .= ' '; $VAR .   VAR VAR($VAR) $VAR = VAR('>', ' VAR', $VAR); $VAR = VAR('<', ' VAR', $VAR); VAR $VAR; $VAR[] = '<VAR VAR=""' . $VAR . '&VAR=' . $VAR . ' VAR($VAR) . '</VAR><VAR VAR=""' . VAR() . VAR VAR(&$VAR, $VAR, $VAR, $VAR = 100, $VAR = 100, $VAR = '', $VAR = 100, $VAR = '', $VAR = '', $VAR = 0) VAR (! $VAR) { $VAR = "" VAR VAR VAR VAR, VAR VAR ""; $VAR .",6,6
urllib3_0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,codecov.yml,"coverage:
    status:
        patch:
            default:
                target: '100'
        project:
            default:
                target: '100'",,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,CVE-2019-11236,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,98,COMPLETED,VAR: VAR: VAR: VAR: VAR: '100' VAR: VAR: VAR: '100' ,6,6
urllib3_0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,docs/contributing.rst,"Contributing
============

urllib3 is a community-maintained project and we happily accept contributions.

If you wish to add a new feature or fix a bug:

#. `Check for open issues <https://github.com/urllib3/urllib3/issues>`_ or open
   a fresh issue to start a discussion around a feature idea or a bug. There is
   a *Contributor Friendly* tag for issues that should be ideal for people who
   are not very familiar with the codebase yet.
#. Fork the `urllib3 repository on Github <https://github.com/urllib3/urllib3>`_
   to start making your changes.
#. Write a test which shows that the bug was fixed or that the feature works
   as expected.
#. Send a pull request and bug the maintainer until it gets merged and published.
   :) Make sure to add yourself to ``CONTRIBUTORS.txt``.


Setting up your development environment
---------------------------------------

It is recommended, and even enforced by the make file, that you use a
`virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ python3 -m venv venv3
  $ source venv3/bin/activate
  $ pip install -r dev-requirements.txt


Running the tests
-----------------

We use some external dependencies, multiple interpreters and code coverage
analysis while running test suite. Our ``Makefile`` handles much of this for
you as long as you're running it `inside of a virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ make test-quick
  [... magically installs dependencies and runs tests on your virtualenv]
  Ran 182 tests in 1.633s

  OK (SKIP=6)

There is also a make target for running all of our tests and multiple python
versions.

  $ make test-all

Note that code coverage less than 100% is regarded as a failing run. Some
platform-specific tests are skipped unless run in that platform.  To make sure
the code works in all of urllib3's supported platforms, you can run our ``tox``
suite::

  $ make test-all
  [... tox creates a virtualenv for every platform and runs tests inside of each]
  py27: commands succeeded
  py34: commands succeeded
  py35: commands succeeded
  py36: commands succeeded
  py37: commands succeeded
  pypy: commands succeeded

Our test suite `runs continuously on Travis CI
<https://travis-ci.org/urllib3/urllib3>`_ with every pull request.


Sponsorship
-----------

Please consider sponsoring urllib3 development, especially if your company
benefits from this library.

We welcome your patronage on `Bountysource <https://www.bountysource.com/teams/urllib3>`_:

* `Contribute a recurring amount to the team <https://salt.bountysource.com/checkout/amount?team=urllib3>`_
* `Place a bounty on a specific feature <https://www.bountysource.com/teams/urllib3>`_

Your contribution will go towards adding new features to urllib3 and making
sure all functionality continues to meet our high quality standards.

We also welcome sponsorship in the form of time. We greatly appreciate companies
who encourage employees to contribute on an ongoing basis during their work hours.
Please let us know and we'll be glad to add you to our sponsors list!


Project Grant
-------------

A grant for contiguous full-time development has the biggest impact for
progress. Periods of 3 to 10 days allow a contributor to tackle substantial
complex issues which are otherwise left to linger until somebody can't afford
to not fix them.

Contact `@shazow <https://github.com/shazow>`_ to arrange a grant for a core
contributor.

Huge thanks to all the companies and individuals who financially contributed to
the development of urllib3. Please send a PR if you've donated and would like
to be listed.

* `Stripe <https://stripe.com/>`_ (June 23, 2014)

.. * [Company] ([date])",,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,CVE-2019-11236,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,98,COMPLETED,"VAR ============ VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR *VAR VAR* VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR.  VAR VAR.  :) VAR VAR VAR VAR VAR VAR ``VAR.VAR``. VAR VAR VAR VAR VAR --------------------------------------- VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR `VAR <VAR: $ VAR -VAR VAR VAR $ VAR VAR/VAR/VAR $ VAR VAR -VAR VAR-VAR.VAR VAR VAR VAR ----------------- VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR ``VAR`` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR `VAR VAR VAR VAR <VAR: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR 182 VAR VAR 1.633s VAR (VAR=6) VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. $ VAR VAR-VAR VAR VAR VAR VAR VAR VAR 100% VAR VAR VAR VAR VAR VAR. VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR, VAR VAR VAR VAR ``VAR`` VAR:: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR VAR VAR `VAR VAR VAR VAR VAR <VAR: VAR ----------- VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR `VAR <VAR: * `VAR VAR VAR VAR VAR VAR VAR <VAR: * `VAR VAR VAR VAR VAR VAR VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR ------------- VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR 3 VAR 10 VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR. VAR `@VAR <VAR: VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. * `VAR <VAR: .. * [VAR] ([VAR]) ",0,6
urllib3_0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,docs/index.rst,"urllib3
=======

.. toctree::
   :hidden:
   :maxdepth: 2

   user-guide
   advanced-usage
   reference/index
   contributing

urllib3 is a powerful, *sanity-friendly* HTTP client for Python. Much of the
Python ecosystem :ref:`already uses <who-uses>` urllib3 and you should too.
urllib3 brings many critical features that are missing from the Python
standard libraries:

- Thread safety.
- Connection pooling.
- Client-side SSL/TLS verification.
- File uploads with multipart encoding.
- Helpers for retrying requests and dealing with HTTP redirects.
- Support for gzip and deflate encoding.
- Proxy support for HTTP and SOCKS.
- 100% test coverage.

urllib3 is powerful and easy to use::

    >>> import urllib3
    >>> http = urllib3.PoolManager()
    >>> r = http.request('GET', 'http://httpbin.org/robots.txt')
    >>> r.status
    200
    >>> r.data
    'User-agent: *\nDisallow: /deny\n'

Installing
----------

urllib3 can be installed with `pip <https://pip.pypa.io>`_::

    $ pip install urllib3

Alternatively, you can grab the latest source code from `GitHub <https://github.com/urllib3/urllib3>`_::

    $ git clone git://github.com/shazow/urllib3.git
    $ python setup.py install

Usage
-----

The :doc:`user-guide` is the place to go to learn how to use the library and
accomplish common tasks. The more in-depth :doc:`advanced-usage` guide is the place to go for lower-level tweaking.

The :doc:`reference/index` documentation provides API-level documentation.

.. _who-uses:

Who uses urllib3?
-----------------

* `Requests <http://python-requests.org/>`_
* `Pip <https://pip.pypa.io>`_
* & more!

License
-------

urllib3 is made available under the MIT License. For more details, see `LICENSE.txt <https://github.com/urllib3/urllib3/blob/master/LICENSE.txt>`_.

Contributing
------------

We happily welcome contributions, please see :doc:`contributing` for details.",,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,CVE-2019-11236,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,98,COMPLETED,"VAR ======= .. VAR:: :VAR: :VAR: 2 VAR-VAR VAR-VAR VAR/VAR VAR VAR VAR VAR VAR, *VAR-VAR* VAR VAR VAR VAR. VAR VAR VAR VAR VAR :VAR:`VAR VAR <VAR-VAR>` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - VAR VAR. - VAR VAR. - VAR-VAR VAR/VAR VAR. - VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - 100% VAR VAR. VAR VAR VAR VAR VAR VAR VAR:: >>> VAR VAR >>> VAR = VAR.VAR() >>> VAR = VAR.VAR('VAR', 'VAR: >>> VAR.VAR 200 >>> VAR.VAR 'VAR-VAR: *\VAR: /VAR\VAR' VAR ---------- VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR: $ VAR VAR.VAR VAR VAR ----- VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR-VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR. VAR :VAR:`VAR/VAR` VAR VAR VAR-VAR VAR. .. VAR-VAR: VAR VAR VAR? ----------------- * `VAR <VAR: * `VAR <VAR: * & VAR! VAR ------- VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR `VAR.VAR <VAR: VAR ------------ VAR VAR VAR VAR, VAR VAR :VAR:`VAR` VAR VAR. ",6,6
urllib3_0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,src/urllib3/contrintlmpool.py,"""""""
NTLM authenticating pool, contributed by erikcederstran

Issue #10, see: http://code.google.com/p/urllib3/issues/detail?id=10
""""""
from __future__ import absolute_import

from logging import getLogger
from ntlm import ntlm

from .. import HTTPSConnectionPool
from ..packages.six.moves.http_client import HTTPSConnection


log = getLogger(__name__)


class NTLMConnectionPool(HTTPSConnectionPool):
    """"""
    Implements an NTLM authentication version of an urllib3 connection pool
    """"""

    scheme = 'https'

    def __init__(self, user, pw, authurl, *args, **kwargs):
        """"""
        authurl is a random URL on the server that is protected by NTLM.
        user is the Windows user, probably in the DOMAIN\\username format.
        pw is the password for the user.
        """"""
        super(NTLMConnectionPool, self).__init__(*args, **kwargs)
        self.authurl = authurl
        self.rawuser = user
        user_parts = user.split('\\', 1)
        self.domain = user_parts[0].upper()
        self.user = user_parts[1]
        self.pw = pw

    def _new_conn(self):
        # Performs the NTLM handshake that secures the connection. The socket
        # must be kept open while requests are performed.
        self.num_connections += 1
        log.debug('Starting NTLM HTTPS connection no. %d: https://%s%s',
                  self.num_connections, self.host, self.authurl)

        headers = {'Connection': 'Keep-Alive'}
        req_header = 'Authorization'
        resp_header = 'www-authenticate'

        conn = HTTPSConnection(host=self.host, port=self.port)

        # Send negotiation message
        headers[req_header] = (
            'NTLM %s' % ntlm.create_NTLM_NEGOTIATE_MESSAGE(self.rawuser))
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        reshdr = dict(res.getheaders())
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', reshdr)
        log.debug('Response data: %s [...]', res.read(100))

        # Remove the reference to the socket, so that it can not be closed by
        # the response object (we want to keep the socket open)
        res.fp = None

        # Server should respond with a challenge message
        auth_header_values = reshdr[resp_header].split(', ')
        auth_header_value = None
        for s in auth_header_values:
            if s[:5] == 'NTLM ':
                auth_header_value = s[5:]
        if auth_header_value is None:
            raise Exception('Unexpected %s response header: %s' %
                            (resp_header, reshdr[resp_header]))

        # Send authentication message
        ServerChallenge, NegotiateFlags = \
            ntlm.parse_NTLM_CHALLENGE_MESSAGE(auth_header_value)
        auth_msg = ntlm.create_NTLM_AUTHENTICATE_MESSAGE(ServerChallenge,
                                                         self.user,
                                                         self.domain,
                                                         self.pw,
                                                         NegotiateFlags)
        headers[req_header] = 'NTLM %s' % auth_msg
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', dict(res.getheaders()))
        log.debug('Response data: %s [...]', res.read()[:100])
        if res.status != 200:
            if res.status == 401:
                raise Exception('Server rejected request: wrong '
                                'username or password')
            raise Exception('Wrong server response: %s %s' %
                            (res.status, res.reason))

        res.fp = None
        log.debug('Connection established')
        return conn

    def urlopen(self, method, url, body=None, headers=None, retries=3,
                redirect=True, assert_same_host=True):
        if headers is None:
            headers = {}
        headers['Connection'] = 'Keep-Alive'
        return super(NTLMConnectionPool, self).urlopen(method, url, body,
                                                       headers, retries,
                                                       redirect,
                                                       assert_same_host)",,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,CVE-2019-11236,0aa3e24fcd75f1bb59ab159e9f8adb44055b2271,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,98,COMPLETED,""""""" VAR VAR VAR, VAR VAR VAR VAR  """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR .. VAR VAR VAR ..VAR.VAR.VAR.VAR VAR VAR VAR = VAR(VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR """""" VAR = 'VAR' VAR VAR(VAR, VAR, VAR, VAR, *VAR, **VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR, VAR VAR VAR VAR\\VAR VAR. VAR VAR VAR VAR VAR VAR VAR. """""" VAR(VAR, VAR).VAR(*VAR, **VAR) VAR.VAR = VAR VAR.VAR = VAR VAR = VAR.VAR('\\', 1) VAR.VAR = VAR[0].VAR() VAR.VAR = VAR[1] VAR.VAR = VAR VAR VAR(VAR):   VAR.VAR += 1 VAR.VAR('VAR VAR VAR VAR VAR. %VAR: VAR: VAR.VAR, VAR.VAR, VAR.VAR) VAR = {'VAR': 'VAR-VAR'} VAR = 'VAR' VAR = 'VAR-VAR' VAR = VAR(VAR=VAR.VAR, VAR=VAR.VAR)  VAR[VAR] = ( 'VAR %VAR' % VAR.VAR(VAR.VAR)) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR = VAR(VAR.VAR()) VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR(100))   VAR.VAR = VAR  VAR = VAR[VAR].VAR(', ') VAR = VAR VAR VAR VAR VAR: VAR VAR[:5] == 'VAR ': VAR = VAR[5:] VAR VAR VAR VAR: VAR VAR('VAR %VAR VAR VAR: %VAR' % (VAR, VAR[VAR]))  VAR, VAR = \ VAR.VAR(VAR) VAR = VAR.VAR(VAR, VAR.VAR, VAR.VAR, VAR.VAR, VAR) VAR[VAR] = 'VAR %VAR' % VAR VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR(VAR.VAR())) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR()[:100]) VAR VAR.VAR != 200: VAR VAR.VAR == 401: VAR VAR('VAR VAR VAR: VAR ' 'VAR VAR VAR') VAR VAR('VAR VAR VAR: %VAR %VAR' % (VAR.VAR, VAR.VAR)) VAR.VAR = VAR VAR.VAR('VAR VAR') VAR VAR VAR VAR(VAR, VAR, VAR, VAR=VAR, VAR=VAR, VAR=3, VAR=VAR, VAR=VAR): VAR VAR VAR VAR: VAR = {} VAR['VAR'] = 'VAR-VAR' VAR VAR(VAR, VAR).VAR(VAR, VAR, VAR, VAR, VAR, VAR, VAR) ",6,6
urllib3_2d4a3fee6de2fa45eb82169361918f759269b4ec,README.rst,".. raw:: html

   <p align=""center"">
      <a href=""https://github.com/urllib3/urllib3"">
         <img src=""./docs/images/banner.svg"" width=""60%"" alt=""urllib3"" />
      </a>
   </p>
   <p align=""center"">
      <a href=""https://pypi.org/project/urllib3""><img alt=""PyPI Version"" src=""https://img.shields.io/pypi/v/urllib3.svg?maxAge=86400"" /></a>
      <a href=""https://pypi.org/project/urllib3""><img alt=""Python Versions"" src=""https://img.shields.io/pypi/pyversions/urllib3.svg?maxAge=86400"" /></a>
      <a href=""https://discord.gg/CHEgCZN""><img alt=""Join our Discord"" src=""https://img.shields.io/discord/756342717725933608?color=%237289da&label=discord"" /></a>
      <a href=""https://codecov.io/gh/urllib3/urllib3""><img alt=""Coverage Status"" src=""https://img.shields.io/codecov/c/github/urllib3/urllib3.svg"" /></a>
      <a href=""https://github.com/urllib3/urllib3/actions?query=workflow%3ACI""><img alt=""Build Status on GitHub"" src=""https://github.com/urllib3/urllib3/workflows/CI/badge.svg"" /></a>
      <a href=""https://travis-ci.org/urllib3/urllib3""><img alt=""Build Status on Travis"" src=""https://travis-ci.org/urllib3/urllib3.svg?branch=master"" /></a>
      <a href=""https://urllib3.readthedocs.io""><img alt=""Documentation Status"" src=""https://readthedocs.org/projects/urllib3/badge/?version=latest"" /></a>
   </p>

urllib3 is a powerful, *user-friendly* HTTP client for Python. Much of the
Python ecosystem already uses urllib3 and you should too.
urllib3 brings many critical features that are missing from the Python
standard libraries:

- Thread safety.
- Connection pooling.
- Client-side SSL/TLS verification.
- File uploads with multipart encoding.
- Helpers for retrying requests and dealing with HTTP redirects.
- Support for gzip, deflate, and brotli encoding.
- Proxy support for HTTP and SOCKS.
- 100% test coverage.

urllib3 is powerful and easy to use:

.. code-block:: python

    >>> import urllib3
    >>> http = urllib3.PoolManager()
    >>> r = http.request('GET', 'http://httpbin.org/robots.txt')
    >>> r.status
    200
    >>> r.data
    'User-agent: *\nDisallow: /deny\n'


Installing
----------

urllib3 can be installed with `pip <https://pip.pypa.io>`_::

    $ python -m pip install urllib3

Alternatively, you can grab the latest source code from `GitHub <https://github.com/urllib3/urllib3>`_::

    $ git clone git://github.com/urllib3/urllib3.git
    $ python setup.py install


Documentation
-------------

urllib3 has usage and reference documentation at `urllib3.readthedocs.io <https://urllib3.readthedocs.io>`_.


Contributing
------------

urllib3 happily accepts contributions. Please see our
`contributing documentation <https://urllib3.readthedocs.io/en/latest/contributing.html>`_
for some tips on getting started.


Security Disclosures
--------------------

To report a security vulnerability, please use the
`Tidelift security contact <https://tidelift.com/security>`_.
Tidelift will coordinate the fix and disclosure with maintainers.


Maintainers
-----------

- `@sethmlarson <https://github.com/sethmlarson>`__ (Seth M. Larson)
- `@pquentin <https://github.com/pquentin>`__ (Quentin Pradet)
- `@theacodes <https://github.com/theacodes>`__ (Thea Flowers)
- `@haikuginger <https://github.com/haikuginger>`__ (Jess Shapiro)
- `@lukasa <https://github.com/lukasa>`__ (Cory Benfield)
- `@sigmavirus24 <https://github.com/sigmavirus24>`__ (Ian Stapleton Cordasco)
- `@shazow <https://github.com/shazow>`__ (Andrey Petrov)




Sponsorship
-----------

If your company benefits from this library, please consider `sponsoring its
development <https://urllib3.readthedocs.io/en/latest/sponsors.html>`_.


For Enterprise
--------------

.. |tideliftlogo| image:: https://nedbatchelder.com/pix/Tidelift_Logos_RGB_Tidelift_Shorthand_On-White_small.png
   :width: 75
   :alt: Tidelift

.. list-table::
   :widths: 10 100

   * - |tideliftlogo|
     - Professional support for urllib3 is available as part of the `Tidelift
       Subscription`_.  Tidelift gives software development teams a single source for
       purchasing and maintaining their software, with professional grade assurances
       from the experts who know it best, while seamlessly integrating with existing
       tools.

.. _Tidelift Subscription: https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=readme",,2d4a3fee6de2fa45eb82169361918f759269b4ec,CVE-2021-33503,2d4a3fee6de2fa45eb82169361918f759269b4ec,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,".. VAR:: VAR <VAR VAR=""VAR""> <VAR VAR=""VAR: <VAR VAR=""./VAR/VAR/VAR.VAR"" VAR=""60%"" VAR=""VAR"" /> </VAR> </VAR> <VAR VAR=""VAR""> <VAR VAR=""VAR: <VAR VAR=""VAR: <VAR VAR=""VAR: <VAR VAR=""VAR: <VAR VAR=""VAR: <VAR VAR=""VAR: <VAR VAR=""VAR: </VAR> VAR VAR VAR VAR, *VAR-VAR* VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - VAR VAR. - VAR VAR. - VAR-VAR VAR/VAR VAR. - VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR, VAR, VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - 100% VAR VAR. VAR VAR VAR VAR VAR VAR VAR: .. VAR-VAR:: VAR >>> VAR VAR >>> VAR = VAR.VAR() >>> VAR = VAR.VAR('VAR', 'VAR: >>> VAR.VAR 200 >>> VAR.VAR 'VAR-VAR: *\VAR: /VAR\VAR' VAR ---------- VAR VAR VAR VAR VAR `VAR <VAR: $ VAR -VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR: $ VAR VAR.VAR VAR VAR ------------- VAR VAR VAR VAR VAR VAR VAR `VAR.VAR.VAR <VAR: VAR ------------ VAR VAR VAR VAR. VAR VAR VAR `VAR VAR <VAR: VAR VAR VAR VAR VAR VAR. VAR VAR -------------------- VAR VAR VAR VAR VAR, VAR VAR VAR `VAR VAR VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR ----------- - `@VAR <VAR: - `@VAR <VAR: - `@VAR <VAR: - `@VAR <VAR: - `@VAR <VAR: - `@VAR <VAR: - `@VAR <VAR:  VAR ----------- VAR VAR VAR VAR VAR VAR VAR, VAR VAR `VAR VAR VAR <VAR: VAR VAR -------------- .. |VAR| VAR:: VAR: :VAR: 75 :VAR: VAR .. VAR-VAR:: :VAR: 10 100 * - |VAR| - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR VAR`VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. .. VAR VAR: VAR: ",6,6
urllib3_2d4a3fee6de2fa45eb82169361918f759269b4ec,codecov.yml,"coverage:
    status:
        patch:
            default:
                target: '100'
        project:
            default:
                target: '100'",,2d4a3fee6de2fa45eb82169361918f759269b4ec,CVE-2021-33503,2d4a3fee6de2fa45eb82169361918f759269b4ec,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR: VAR: VAR: VAR: VAR: '100' VAR: VAR: VAR: '100' ,6,6
urllib3_2d4a3fee6de2fa45eb82169361918f759269b4ec,docs/index.rst,"urllib3
=======

.. toctree::
   :hidden:
   :maxdepth: 3

   For Enterprise <https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs>
   v2-roadmap
   sponsors
   user-guide
   advanced-usage
   reference/index
   contributing

urllib3 is a powerful, *user-friendly* HTTP client for Python.
:ref:`Much of the Python ecosystem already uses <who-uses>` urllib3 and you should too.

urllib3 brings many critical features that are missing from the Python
standard libraries:

- Thread safety.
- Connection pooling.
- Client-side TLS/SSL verification.
- File uploads with multipart encoding.
- Helpers for retrying requests and dealing with HTTP redirects.
- Support for gzip, deflate, and brotli encoding.
- Proxy support for HTTP and SOCKS.
- 100% test coverage.

urllib3 is powerful and easy to use:

.. code-block:: python

    >>> import urllib3
    >>> http = urllib3.PoolManager()
    >>> r = http.request('GET', 'http://httpbin.org/robots.txt')
    >>> r.status
    200
    >>> r.data
    'User-agent: *\nDisallow: /deny\n'

For Enterprise
--------------

.. |tideliftlogo| image:: https://nedbatchelder.com/pix/Tidelift_Logos_RGB_Tidelift_Shorthand_On-White_small.png
   :width: 75
   :alt: Tidelift

.. list-table::
   :widths: 10 100

   * - |tideliftlogo|_
     - Professional support for urllib3 is available as part of the `Tidelift
       Subscription`_.  Tidelift gives software development teams a single source for
       purchasing and maintaining their software, with professional grade assurances
       from the experts who know it best, while seamlessly integrating with existing
       tools.

.. _Tidelift Subscription: https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs
.. _tideliftlogo: https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs

|learn-more|_ |request-a-demo|_

.. |learn-more| image:: https://raw.githubusercontent.com/urllib3/urllib3/master/docs/images/learn-more-button.png
   :width: 49%
   :alt: Learn more about Tidelift Subscription
.. _learn-more: https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs

.. |request-a-demo| image:: https://raw.githubusercontent.com/urllib3/urllib3/master/docs/images/demo-button.png
   :width: 49%
   :alt: Request a Demo for the Tidelift Subscription
.. _request-a-demo: https://tidelift.com/subscription/request-a-demo?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs

Installing
----------

urllib3 can be installed with `pip <https://pip.pypa.io>`_

.. code-block:: bash

  $ python -m pip install urllib3

Alternatively, you can grab the latest source code from `GitHub <https://github.com/urllib3/urllib3>`_:

.. code-block:: bash

  $ git clone git://github.com/urllib3/urllib3.git
  $ python setup.py install

Usage
-----

The :doc:`user-guide` is the place to go to learn how to use the library and
accomplish common tasks. The more in-depth :doc:`advanced-usage` guide is the place to go for lower-level tweaking.

The :doc:`reference/index` documentation provides API-level documentation.

.. _who-uses:

Who uses urllib3?
-----------------

`urllib3 is one of the most downloaded packages on PyPI <https://pypistats.org/top>`_
and is a dependency of many popular Python packages like `Requests <https://requests.readthedocs.io>`_,
`Pip <https://pip.pypa.io>`_, and more!

License
-------

urllib3 is made available under the MIT License. For more details, see `LICENSE.txt <https://github.com/urllib3/urllib3/blob/master/LICENSE.txt>`_.

Contributing
------------

We happily welcome contributions, please see :doc:`contributing` for details.",,2d4a3fee6de2fa45eb82169361918f759269b4ec,CVE-2021-33503,2d4a3fee6de2fa45eb82169361918f759269b4ec,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ======= .. VAR:: :VAR: :VAR: 3 VAR VAR <VAR: VAR-VAR VAR VAR-VAR VAR-VAR VAR/VAR VAR VAR VAR VAR VAR, *VAR-VAR* VAR VAR VAR VAR. :VAR:`VAR VAR VAR VAR VAR VAR VAR <VAR-VAR>` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - VAR VAR. - VAR VAR. - VAR-VAR VAR/VAR VAR. - VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR, VAR, VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - 100% VAR VAR. VAR VAR VAR VAR VAR VAR VAR: .. VAR-VAR:: VAR >>> VAR VAR >>> VAR = VAR.VAR() >>> VAR = VAR.VAR('VAR', 'VAR: >>> VAR.VAR 200 >>> VAR.VAR 'VAR-VAR: *\VAR: /VAR\VAR' VAR VAR -------------- .. |VAR| VAR:: VAR: :VAR: 75 :VAR: VAR .. VAR-VAR:: :VAR: 10 100 * - |VAR|VAR - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR VAR`VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. .. VAR VAR: VAR: .. VAR: VAR: |VAR-VAR|VAR |VAR-VAR-VAR|VAR .. |VAR-VAR| VAR:: VAR: :VAR: 49% :VAR: VAR VAR VAR VAR VAR .. VAR-VAR: VAR: .. |VAR-VAR-VAR| VAR:: VAR: :VAR: 49% :VAR: VAR VAR VAR VAR VAR VAR VAR .. VAR-VAR-VAR: VAR: VAR ---------- VAR VAR VAR VAR VAR `VAR <VAR: .. VAR-VAR:: VAR $ VAR -VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: .. VAR-VAR:: VAR $ VAR VAR VAR: $ VAR VAR.VAR VAR VAR ----- VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR-VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR. VAR :VAR:`VAR/VAR` VAR VAR VAR-VAR VAR. .. VAR-VAR: VAR VAR VAR? ----------------- `VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: `VAR <VAR: VAR ------- VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR `VAR.VAR <VAR: VAR ------------ VAR VAR VAR VAR, VAR VAR :VAR:`VAR` VAR VAR. ",0,6
urllib3_2d4a3fee6de2fa45eb82169361918f759269b4ec,src/urllib3/contrintlmpool.py,"""""""
NTLM authenticating pool, contributed by erikcederstran

Issue #10, see: http://code.google.com/p/urllib3/issues/detail?id=10
""""""
from __future__ import absolute_import

from logging import getLogger

from ntlm import ntlm

from .. import HTTPSConnectionPool
from ..packages.six.moves.http_client import HTTPSConnection

log = getLogger(__name__)


class NTLMConnectionPool(HTTPSConnectionPool):
    """"""
    Implements an NTLM authentication version of an urllib3 connection pool
    """"""

    scheme = ""https""

    def __init__(self, user, pw, authurl, *args, **kwargs):
        """"""
        authurl is a random URL on the server that is protected by NTLM.
        user is the Windows user, probably in the DOMAIN\\username format.
        pw is the password for the user.
        """"""
        super(NTLMConnectionPool, self).__init__(*args, **kwargs)
        self.authurl = authurl
        self.rawuser = user
        user_parts = user.split(""\\"", 1)
        self.domain = user_parts[0].upper()
        self.user = user_parts[1]
        self.pw = pw

    def _new_conn(self):
        # Performs the NTLM handshake that secures the connection. The socket
        # must be kept open while requests are performed.
        self.num_connections += 1
        log.debug(
            ""Starting NTLM HTTPS connection no. %d: https://%s%s"",
            self.num_connections,
            self.host,
            self.authurl,
        )

        headers = {""Connection"": ""Keep-Alive""}
        req_header = ""Authorization""
        resp_header = ""www-authenticate""

        conn = HTTPSConnection(host=self.host, port=self.port)

        # Send negotiation message
        headers[req_header] = ""NTLM %s"" % ntlm.create_NTLM_NEGOTIATE_MESSAGE(
            self.rawuser
        )
        log.debug(""Request headers: %s"", headers)
        conn.request(""GET"", self.authurl, None, headers)
        res = conn.getresponse()
        reshdr = dict(res.getheaders())
        log.debug(""Response status: %s %s"", res.status, res.reason)
        log.debug(""Response headers: %s"", reshdr)
        log.debug(""Response data: %s [...]"", res.read(100))

        # Remove the reference to the socket, so that it can not be closed by
        # the response object (we want to keep the socket open)
        res.fp = None

        # Server should respond with a challenge message
        auth_header_values = reshdr[resp_header].split("", "")
        auth_header_value = None
        for s in auth_header_values:
            if s[:5] == ""NTLM "":
                auth_header_value = s[5:]
        if auth_header_value is None:
            raise Exception(
                ""Unexpected %s response header: %s"" % (resp_header, reshdr[resp_header])
            )

        # Send authentication message
        ServerChallenge, NegotiateFlags = ntlm.parse_NTLM_CHALLENGE_MESSAGE(
            auth_header_value
        )
        auth_msg = ntlm.create_NTLM_AUTHENTICATE_MESSAGE(
            ServerChallenge, self.user, self.domain, self.pw, NegotiateFlags
        )
        headers[req_header] = ""NTLM %s"" % auth_msg
        log.debug(""Request headers: %s"", headers)
        conn.request(""GET"", self.authurl, None, headers)
        res = conn.getresponse()
        log.debug(""Response status: %s %s"", res.status, res.reason)
        log.debug(""Response headers: %s"", dict(res.getheaders()))
        log.debug(""Response data: %s [...]"", res.read()[:100])
        if res.status != 200:
            if res.status == 401:
                raise Exception(""Server rejected request: wrong username or password"")
            raise Exception(""Wrong server response: %s %s"" % (res.status, res.reason))

        res.fp = None
        log.debug(""Connection established"")
        return conn

    def urlopen(
        self,
        method,
        url,
        body=None,
        headers=None,
        retries=3,
        redirect=True,
        assert_same_host=True,
    ):
        if headers is None:
            headers = {}
        headers[""Connection""] = ""Keep-Alive""
        return super(NTLMConnectionPool, self).urlopen(
            method, url, body, headers, retries, redirect, assert_same_host
        )",,2d4a3fee6de2fa45eb82169361918f759269b4ec,CVE-2021-33503,2d4a3fee6de2fa45eb82169361918f759269b4ec,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,""""""" VAR VAR VAR, VAR VAR VAR VAR  """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR .. VAR VAR VAR ..VAR.VAR.VAR.VAR VAR VAR VAR = VAR(VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR """""" VAR = ""VAR"" VAR VAR(VAR, VAR, VAR, VAR, *VAR, **VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR, VAR VAR VAR VAR\\VAR VAR. VAR VAR VAR VAR VAR VAR VAR. """""" VAR(VAR, VAR).VAR(*VAR, **VAR) VAR.VAR = VAR VAR.VAR = VAR VAR = VAR.VAR(""\\"", 1) VAR.VAR = VAR[0].VAR() VAR.VAR = VAR[1] VAR.VAR = VAR VAR VAR(VAR):   VAR.VAR += 1 VAR.VAR( ""VAR VAR VAR VAR VAR. %VAR: VAR: VAR.VAR, VAR.VAR, VAR.VAR, ) VAR = {""VAR"": ""VAR-VAR""} VAR = ""VAR"" VAR = ""VAR-VAR"" VAR = VAR(VAR=VAR.VAR, VAR=VAR.VAR)  VAR[VAR] = ""VAR %VAR"" % VAR.VAR( VAR.VAR ) VAR.VAR(""VAR VAR: %VAR"", VAR) VAR.VAR(""VAR"", VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR = VAR(VAR.VAR()) VAR.VAR(""VAR VAR: %VAR %VAR"", VAR.VAR, VAR.VAR) VAR.VAR(""VAR VAR: %VAR"", VAR) VAR.VAR(""VAR VAR: %VAR [...]"", VAR.VAR(100))   VAR.VAR = VAR  VAR = VAR[VAR].VAR("", "") VAR = VAR VAR VAR VAR VAR: VAR VAR[:5] == ""VAR "": VAR = VAR[5:] VAR VAR VAR VAR: VAR VAR( ""VAR %VAR VAR VAR: %VAR"" % (VAR, VAR[VAR]) )  VAR, VAR = VAR.VAR( VAR ) VAR = VAR.VAR( VAR, VAR.VAR, VAR.VAR, VAR.VAR, VAR ) VAR[VAR] = ""VAR %VAR"" % VAR VAR.VAR(""VAR VAR: %VAR"", VAR) VAR.VAR(""VAR"", VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR.VAR(""VAR VAR: %VAR %VAR"", VAR.VAR, VAR.VAR) VAR.VAR(""VAR VAR: %VAR"", VAR(VAR.VAR())) VAR.VAR(""VAR VAR: %VAR [...]"", VAR.VAR()[:100]) VAR VAR.VAR != 200: VAR VAR.VAR == 401: VAR VAR(""VAR VAR VAR: VAR VAR VAR VAR"") VAR VAR(""VAR VAR VAR: %VAR %VAR"" % (VAR.VAR, VAR.VAR)) VAR.VAR = VAR VAR.VAR(""VAR VAR"") VAR VAR VAR VAR( VAR, VAR, VAR, VAR=VAR, VAR=VAR, VAR=3, VAR=VAR, VAR=VAR, ): VAR VAR VAR VAR: VAR = {} VAR[""VAR""] = ""VAR-VAR"" VAR VAR(VAR, VAR).VAR( VAR, VAR, VAR, VAR, VAR, VAR, VAR ) ",6,6
urllib3_9b76785331243689a9d52cef3db05ef7462cb02d,codecov.yml,"coverage:
    status:
        patch:
            default:
                target: '100'
        project:
            default:
                target: '100'",,9b76785331243689a9d52cef3db05ef7462cb02d,CVE-2019-11236,9b76785331243689a9d52cef3db05ef7462cb02d,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,70,COMPLETED,VAR: VAR: VAR: VAR: VAR: '100' VAR: VAR: VAR: '100' ,6,6
urllib3_9b76785331243689a9d52cef3db05ef7462cb02d,docs/contributing.rst,"Contributing
============

urllib3 is a community-maintained project and we happily accept contributions.

If you wish to add a new feature or fix a bug:

#. `Check for open issues <https://github.com/urllib3/urllib3/issues>`_ or open
   a fresh issue to start a discussion around a feature idea or a bug. There is
   a *Contributor Friendly* tag for issues that should be ideal for people who
   are not very familiar with the codebase yet.
#. Fork the `urllib3 repository on Github <https://github.com/urllib3/urllib3>`_
   to start making your changes.
#. Write a test which shows that the bug was fixed or that the feature works
   as expected.
#. Send a pull request and bug the maintainer until it gets merged and published.
   :) Make sure to add yourself to ``CONTRIBUTORS.txt``.


Setting up your development environment
---------------------------------------

It is recommended, and even enforced by the make file, that you use a
`virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ python3 -m venv venv3
  $ source venv3/bin/activate
  $ pip install -r dev-requirements.txt


Running the tests
-----------------

We use some external dependencies, multiple interpreters and code coverage
analysis while running test suite. Our ``Makefile`` handles much of this for
you as long as you're running it `inside of a virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ make test-quick
  [... magically installs dependencies and runs tests on your virtualenv]
  Ran 182 tests in 1.633s

  OK (SKIP=6)

There is also a make target for running all of our tests and multiple python
versions.

  $ make test-all

Note that code coverage less than 100% is regarded as a failing run. Some
platform-specific tests are skipped unless run in that platform.  To make sure
the code works in all of urllib3's supported platforms, you can run our ``tox``
suite::

  $ make test-all
  [... tox creates a virtualenv for every platform and runs tests inside of each]
  py27: commands succeeded
  py34: commands succeeded
  py35: commands succeeded
  py36: commands succeeded
  py37: commands succeeded
  pypy: commands succeeded

Our test suite `runs continuously on Travis CI
<https://travis-ci.org/urllib3/urllib3>`_ with every pull request.


Sponsorship
-----------

Please consider sponsoring urllib3 development, especially if your company
benefits from this library.

We welcome your patronage on `Bountysource <https://www.bountysource.com/teams/urllib3>`_:

* `Contribute a recurring amount to the team <https://salt.bountysource.com/checkout/amount?team=urllib3>`_
* `Place a bounty on a specific feature <https://www.bountysource.com/teams/urllib3>`_

Your contribution will go towards adding new features to urllib3 and making
sure all functionality continues to meet our high quality standards.

We also welcome sponsorship in the form of time. We greatly appreciate companies
who encourage employees to contribute on an ongoing basis during their work hours.
Please let us know and we'll be glad to add you to our sponsors list!


Project Grant
-------------

A grant for contiguous full-time development has the biggest impact for
progress. Periods of 3 to 10 days allow a contributor to tackle substantial
complex issues which are otherwise left to linger until somebody can't afford
to not fix them.

Contact `@shazow <https://github.com/shazow>`_ to arrange a grant for a core
contributor.

Huge thanks to all the companies and individuals who financially contributed to
the development of urllib3. Please send a PR if you've donated and would like
to be listed.

* `Stripe <https://stripe.com/>`_ (June 23, 2014)

.. * [Company] ([date])",,9b76785331243689a9d52cef3db05ef7462cb02d,CVE-2019-11236,9b76785331243689a9d52cef3db05ef7462cb02d,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,70,COMPLETED,"VAR ============ VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR *VAR VAR* VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR.  VAR VAR.  :) VAR VAR VAR VAR VAR VAR ``VAR.VAR``. VAR VAR VAR VAR VAR --------------------------------------- VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR `VAR <VAR: $ VAR -VAR VAR VAR $ VAR VAR/VAR/VAR $ VAR VAR -VAR VAR-VAR.VAR VAR VAR VAR ----------------- VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR ``VAR`` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR `VAR VAR VAR VAR <VAR: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR 182 VAR VAR 1.633s VAR (VAR=6) VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. $ VAR VAR-VAR VAR VAR VAR VAR VAR VAR 100% VAR VAR VAR VAR VAR VAR. VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR, VAR VAR VAR VAR ``VAR`` VAR:: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR VAR VAR `VAR VAR VAR VAR VAR <VAR: VAR ----------- VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR `VAR <VAR: * `VAR VAR VAR VAR VAR VAR VAR <VAR: * `VAR VAR VAR VAR VAR VAR VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR ------------- VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR 3 VAR 10 VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR. VAR `@VAR <VAR: VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. * `VAR <VAR: .. * [VAR] ([VAR]) ",0,6
urllib3_9b76785331243689a9d52cef3db05ef7462cb02d,docs/index.rst,"urllib3
=======

.. toctree::
   :hidden:
   :maxdepth: 2

   user-guide
   advanced-usage
   reference/index
   contributing

urllib3 is a powerful, *sanity-friendly* HTTP client for Python. Much of the
Python ecosystem :ref:`already uses <who-uses>` urllib3 and you should too.
urllib3 brings many critical features that are missing from the Python
standard libraries:

- Thread safety.
- Connection pooling.
- Client-side SSL/TLS verification.
- File uploads with multipart encoding.
- Helpers for retrying requests and dealing with HTTP redirects.
- Support for gzip and deflate encoding.
- Proxy support for HTTP and SOCKS.
- 100% test coverage.

urllib3 is powerful and easy to use::

    >>> import urllib3
    >>> http = urllib3.PoolManager()
    >>> r = http.request('GET', 'http://httpbin.org/robots.txt')
    >>> r.status
    200
    >>> r.data
    'User-agent: *\nDisallow: /deny\n'

Installing
----------

urllib3 can be installed with `pip <https://pip.pypa.io>`_::

    $ pip install urllib3

Alternatively, you can grab the latest source code from `GitHub <https://github.com/urllib3/urllib3>`_::

    $ git clone git://github.com/shazow/urllib3.git
    $ python setup.py install

Usage
-----

The :doc:`user-guide` is the place to go to learn how to use the library and
accomplish common tasks. The more in-depth :doc:`advanced-usage` guide is the place to go for lower-level tweaking.

The :doc:`reference/index` documentation provides API-level documentation.

.. _who-uses:

Who uses urllib3?
-----------------

* `Requests <http://python-requests.org/>`_
* `Pip <https://pip.pypa.io>`_
* & more!

License
-------

urllib3 is made available under the MIT License. For more details, see `LICENSE.txt <https://github.com/urllib3/urllib3/blob/master/LICENSE.txt>`_.

Contributing
------------

We happily welcome contributions, please see :doc:`contributing` for details.",,9b76785331243689a9d52cef3db05ef7462cb02d,CVE-2019-11236,9b76785331243689a9d52cef3db05ef7462cb02d,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,70,COMPLETED,"VAR ======= .. VAR:: :VAR: :VAR: 2 VAR-VAR VAR-VAR VAR/VAR VAR VAR VAR VAR VAR, *VAR-VAR* VAR VAR VAR VAR. VAR VAR VAR VAR VAR :VAR:`VAR VAR <VAR-VAR>` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - VAR VAR. - VAR VAR. - VAR-VAR VAR/VAR VAR. - VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - 100% VAR VAR. VAR VAR VAR VAR VAR VAR VAR:: >>> VAR VAR >>> VAR = VAR.VAR() >>> VAR = VAR.VAR('VAR', 'VAR: >>> VAR.VAR 200 >>> VAR.VAR 'VAR-VAR: *\VAR: /VAR\VAR' VAR ---------- VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR: $ VAR VAR.VAR VAR VAR ----- VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR-VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR. VAR :VAR:`VAR/VAR` VAR VAR VAR-VAR VAR. .. VAR-VAR: VAR VAR VAR? ----------------- * `VAR <VAR: * `VAR <VAR: * & VAR! VAR ------- VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR `VAR.VAR <VAR: VAR ------------ VAR VAR VAR VAR, VAR VAR :VAR:`VAR` VAR VAR. ",6,6
urllib3_9b76785331243689a9d52cef3db05ef7462cb02d,src/urllib3/contrintlmpool.py,"""""""
NTLM authenticating pool, contributed by erikcederstran

Issue #10, see: http://code.google.com/p/urllib3/issues/detail?id=10
""""""
from __future__ import absolute_import

from logging import getLogger
from ntlm import ntlm

from .. import HTTPSConnectionPool
from ..packages.six.moves.http_client import HTTPSConnection


log = getLogger(__name__)


class NTLMConnectionPool(HTTPSConnectionPool):
    """"""
    Implements an NTLM authentication version of an urllib3 connection pool
    """"""

    scheme = 'https'

    def __init__(self, user, pw, authurl, *args, **kwargs):
        """"""
        authurl is a random URL on the server that is protected by NTLM.
        user is the Windows user, probably in the DOMAIN\\username format.
        pw is the password for the user.
        """"""
        super(NTLMConnectionPool, self).__init__(*args, **kwargs)
        self.authurl = authurl
        self.rawuser = user
        user_parts = user.split('\\', 1)
        self.domain = user_parts[0].upper()
        self.user = user_parts[1]
        self.pw = pw

    def _new_conn(self):
        # Performs the NTLM handshake that secures the connection. The socket
        # must be kept open while requests are performed.
        self.num_connections += 1
        log.debug('Starting NTLM HTTPS connection no. %d: https://%s%s',
                  self.num_connections, self.host, self.authurl)

        headers = {'Connection': 'Keep-Alive'}
        req_header = 'Authorization'
        resp_header = 'www-authenticate'

        conn = HTTPSConnection(host=self.host, port=self.port)

        # Send negotiation message
        headers[req_header] = (
            'NTLM %s' % ntlm.create_NTLM_NEGOTIATE_MESSAGE(self.rawuser))
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        reshdr = dict(res.getheaders())
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', reshdr)
        log.debug('Response data: %s [...]', res.read(100))

        # Remove the reference to the socket, so that it can not be closed by
        # the response object (we want to keep the socket open)
        res.fp = None

        # Server should respond with a challenge message
        auth_header_values = reshdr[resp_header].split(', ')
        auth_header_value = None
        for s in auth_header_values:
            if s[:5] == 'NTLM ':
                auth_header_value = s[5:]
        if auth_header_value is None:
            raise Exception('Unexpected %s response header: %s' %
                            (resp_header, reshdr[resp_header]))

        # Send authentication message
        ServerChallenge, NegotiateFlags = \
            ntlm.parse_NTLM_CHALLENGE_MESSAGE(auth_header_value)
        auth_msg = ntlm.create_NTLM_AUTHENTICATE_MESSAGE(ServerChallenge,
                                                         self.user,
                                                         self.domain,
                                                         self.pw,
                                                         NegotiateFlags)
        headers[req_header] = 'NTLM %s' % auth_msg
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', dict(res.getheaders()))
        log.debug('Response data: %s [...]', res.read()[:100])
        if res.status != 200:
            if res.status == 401:
                raise Exception('Server rejected request: wrong '
                                'username or password')
            raise Exception('Wrong server response: %s %s' %
                            (res.status, res.reason))

        res.fp = None
        log.debug('Connection established')
        return conn

    def urlopen(self, method, url, body=None, headers=None, retries=3,
                redirect=True, assert_same_host=True):
        if headers is None:
            headers = {}
        headers['Connection'] = 'Keep-Alive'
        return super(NTLMConnectionPool, self).urlopen(method, url, body,
                                                       headers, retries,
                                                       redirect,
                                                       assert_same_host)",,9b76785331243689a9d52cef3db05ef7462cb02d,CVE-2019-11236,9b76785331243689a9d52cef3db05ef7462cb02d,https://github.com/urllib3/urllib3,NVD_GIT_REPOBASED,70,COMPLETED,""""""" VAR VAR VAR, VAR VAR VAR VAR  """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR .. VAR VAR VAR ..VAR.VAR.VAR.VAR VAR VAR VAR = VAR(VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR """""" VAR = 'VAR' VAR VAR(VAR, VAR, VAR, VAR, *VAR, **VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR, VAR VAR VAR VAR\\VAR VAR. VAR VAR VAR VAR VAR VAR VAR. """""" VAR(VAR, VAR).VAR(*VAR, **VAR) VAR.VAR = VAR VAR.VAR = VAR VAR = VAR.VAR('\\', 1) VAR.VAR = VAR[0].VAR() VAR.VAR = VAR[1] VAR.VAR = VAR VAR VAR(VAR):   VAR.VAR += 1 VAR.VAR('VAR VAR VAR VAR VAR. %VAR: VAR: VAR.VAR, VAR.VAR, VAR.VAR) VAR = {'VAR': 'VAR-VAR'} VAR = 'VAR' VAR = 'VAR-VAR' VAR = VAR(VAR=VAR.VAR, VAR=VAR.VAR)  VAR[VAR] = ( 'VAR %VAR' % VAR.VAR(VAR.VAR)) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR = VAR(VAR.VAR()) VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR(100))   VAR.VAR = VAR  VAR = VAR[VAR].VAR(', ') VAR = VAR VAR VAR VAR VAR: VAR VAR[:5] == 'VAR ': VAR = VAR[5:] VAR VAR VAR VAR: VAR VAR('VAR %VAR VAR VAR: %VAR' % (VAR, VAR[VAR]))  VAR, VAR = \ VAR.VAR(VAR) VAR = VAR.VAR(VAR, VAR.VAR, VAR.VAR, VAR.VAR, VAR) VAR[VAR] = 'VAR %VAR' % VAR VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR(VAR.VAR())) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR()[:100]) VAR VAR.VAR != 200: VAR VAR.VAR == 401: VAR VAR('VAR VAR VAR: VAR ' 'VAR VAR VAR') VAR VAR('VAR VAR VAR: %VAR %VAR' % (VAR.VAR, VAR.VAR)) VAR.VAR = VAR VAR.VAR('VAR VAR') VAR VAR VAR VAR(VAR, VAR, VAR, VAR=VAR, VAR=VAR, VAR=3, VAR=VAR, VAR=VAR): VAR VAR VAR VAR: VAR = {} VAR['VAR'] = 'VAR-VAR' VAR VAR(VAR, VAR).VAR(VAR, VAR, VAR, VAR, VAR, VAR, VAR) ",6,6
urllib3_a74c9cfbaed9f811e7563cfc3dce894928e0221a,codecov.yml,"coverage:
    status:
        patch:
            default:
                target: '100'
        project:
            default:
                target: '100'",,a74c9cfbaed9f811e7563cfc3dce894928e0221a,CVE-2020-7212,a74c9cfbaed9f811e7563cfc3dce894928e0221a,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,VAR: VAR: VAR: VAR: VAR: '100' VAR: VAR: VAR: '100' ,6,6
urllib3_a74c9cfbaed9f811e7563cfc3dce894928e0221a,docs/contributing.rst,"Contributing
============

urllib3 is a community-maintained project and we happily accept contributions.

If you wish to add a new feature or fix a bug:

#. `Check for open issues <https://github.com/urllib3/urllib3/issues>`_ or open
   a fresh issue to start a discussion around a feature idea or a bug. There is
   a *Contributor Friendly* tag for issues that should be ideal for people who
   are not very familiar with the codebase yet.
#. Fork the `urllib3 repository on Github <https://github.com/urllib3/urllib3>`_
   to start making your changes.
#. Write a test which shows that the bug was fixed or that the feature works
   as expected.
#. Send a pull request and bug the maintainer until it gets merged and published.
   :) Make sure to add yourself to ``CONTRIBUTORS.txt``.


Setting up your development environment
---------------------------------------

It is recommended, and even enforced by the make file, that you use a
`virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ python3 -m venv venv3
  $ source venv3/bin/activate
  $ pip install -r dev-requirements.txt


Running the tests
-----------------

We use some external dependencies, multiple interpreters and code coverage
analysis while running test suite. Our ``Makefile`` handles much of this for
you as long as you're running it `inside of a virtualenv
<http://docs.python-guide.org/en/latest/dev/virtualenvs/>`_::

  $ make test-quick
  [... magically installs dependencies and runs tests on your virtualenv]
  Ran 182 tests in 1.633s

  OK (SKIP=6)

There is also a make target for running all of our tests and multiple python
versions.

  $ make test-all

Note that code coverage less than 100% is regarded as a failing run. Some
platform-specific tests are skipped unless run in that platform.  To make sure
the code works in all of urllib3's supported platforms, you can run our ``tox``
suite::

  $ make test-all
  [... tox creates a virtualenv for every platform and runs tests inside of each]
  py27: commands succeeded
  py34: commands succeeded
  py35: commands succeeded
  py36: commands succeeded
  py37: commands succeeded
  pypy: commands succeeded

Our test suite `runs continuously on Travis CI
<https://travis-ci.org/urllib3/urllib3>`_ with every pull request.

Releases
--------

A release candidate can be created by any contributor by creating a branch
named ``release-x.x`` where ``x.x`` is the version of the proposed release.

- Update ``CHANGES.rst`` and ``urllib3/__init__.py`` with the proper version number
  and commit the changes to ``release-x.x``.
- Open a pull request to merge the ``release-x.x`` branch into the ``master`` branch.
- Integration tests are run against the release candidate on Travis. From here on all
  the steps below will be handled by a maintainer so unless you receive review comments
  you are done here.
- Once the pull request is squash merged into master the merging maintainer the
  pull request will tag the merge commit with the version number:

  - ``git tag -a 1.24.1 [commit sha]``
  - ``git push origin master --tags``

- After the commit is tagged Travis will build the tagged commit and upload the sdist and wheel
  to PyPI and create a draft release on GitHub for the tag. The merging maintainer will
  ensure that the PyPI sdist and wheel are properly uploaded.
- The merging maintainer will mark the draft release on GitHub as an approved release.

Sponsorship
-----------

.. |tideliftlogo| image:: https://nedbatchelder.com/pix/Tidelift_Logos_RGB_Tidelift_Shorthand_On-White_small.png
   :width: 75
   :alt: Tidelift

.. list-table::
   :widths: 10 100

   * - |tideliftlogo|
     - Professional support for urllib3 is available as part of the `Tidelift
       Subscription`_.  Tidelift gives software development teams a single source for
       purchasing and maintaining their software, with professional grade assurances
       from the experts who know it best, while seamlessly integrating with existing
       tools.

.. _Tidelift Subscription: https://tidelift.com/subscription/pkg/pypi-urllib3?utm_source=pypi-urllib3&utm_medium=referral&utm_campaign=docs

Please consider sponsoring urllib3 development, especially if your company
benefits from this library.

Your contribution will go towards adding new features to urllib3 and making
sure all functionality continues to meet our high quality standards.

We also welcome sponsorship in the form of time. We greatly appreciate companies
who encourage employees to contribute on an ongoing basis during their work hours.
Please let us know and we'll be glad to add you to our sponsors list!

A grant for contiguous full-time development has the biggest impact for
progress. Periods of 3 to 10 days allow a contributor to tackle substantial
complex issues which are otherwise left to linger until somebody can't afford
to not fix them.

Contact `@theacodes <https://github.com/theacodes>`_ or `@shazow <https://github.com/shazow>`_
to arrange a grant for a core contributor.

Huge thanks to all the companies and individuals who financially contributed to
the development of urllib3. Please send a PR if you've donated and would like
to be listed.

* `GOVCERT.LU <https://govcert.lu/>`_ (October 23, 2018)

* `Stripe <https://stripe.com/>`_ (June 23, 2014)

.. * [Company] ([date])",,a74c9cfbaed9f811e7563cfc3dce894928e0221a,CVE-2020-7212,a74c9cfbaed9f811e7563cfc3dce894928e0221a,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ============ VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR:  VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR *VAR VAR* VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR.  VAR VAR VAR VAR VAR.  VAR VAR.  :) VAR VAR VAR VAR VAR VAR ``VAR.VAR``. VAR VAR VAR VAR VAR --------------------------------------- VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR `VAR <VAR: $ VAR -VAR VAR VAR $ VAR VAR/VAR/VAR $ VAR VAR -VAR VAR-VAR.VAR VAR VAR VAR ----------------- VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR ``VAR`` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR `VAR VAR VAR VAR <VAR: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR 182 VAR VAR 1.633s VAR (VAR=6) VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. $ VAR VAR-VAR VAR VAR VAR VAR VAR VAR 100% VAR VAR VAR VAR VAR VAR. VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR, VAR VAR VAR VAR ``VAR`` VAR:: $ VAR VAR-VAR [... VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR] VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR: VAR VAR VAR VAR VAR `VAR VAR VAR VAR VAR <VAR: VAR -------- VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR-VAR.VAR`` VAR ``VAR.VAR`` VAR VAR VAR VAR VAR VAR VAR. - VAR ``VAR.VAR`` VAR ``VAR/VAR.VAR`` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR ``VAR-VAR.VAR``. - VAR VAR VAR VAR VAR VAR VAR ``VAR-VAR.VAR`` VAR VAR VAR ``VAR`` VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - ``VAR VAR -VAR 1.24.1 [VAR VAR]`` - ``VAR VAR VAR VAR --VAR`` - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR ----------- .. |VAR| VAR:: VAR: :VAR: 75 :VAR: VAR .. VAR-VAR:: :VAR: 10 100 * - |VAR| - VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR `VAR VAR`VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR. .. VAR VAR: VAR: VAR VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR! VAR VAR VAR VAR VAR-VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR 3 VAR 10 VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR. VAR `@VAR <VAR: VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR'VAR VAR VAR VAR VAR VAR VAR VAR. * `VAR.VAR <VAR: * `VAR <VAR: .. * [VAR] ([VAR]) ",0,6
urllib3_a74c9cfbaed9f811e7563cfc3dce894928e0221a,docs/index.rst,"urllib3
=======

.. toctree::
   :hidden:
   :maxdepth: 2

   user-guide
   advanced-usage
   reference/index
   contributing

urllib3 is a powerful, *sanity-friendly* HTTP client for Python. Much of the
Python ecosystem :ref:`already uses <who-uses>` urllib3 and you should too.
urllib3 brings many critical features that are missing from the Python
standard libraries:

- Thread safety.
- Connection pooling.
- Client-side SSL/TLS verification.
- File uploads with multipart encoding.
- Helpers for retrying requests and dealing with HTTP redirects.
- Support for gzip and deflate encoding.
- Proxy support for HTTP and SOCKS.
- 100% test coverage.

urllib3 is powerful and easy to use::

    >>> import urllib3
    >>> http = urllib3.PoolManager()
    >>> r = http.request('GET', 'http://httpbin.org/robots.txt')
    >>> r.status
    200
    >>> r.data
    'User-agent: *\nDisallow: /deny\n'

Installing
----------

urllib3 can be installed with `pip <https://pip.pypa.io>`_::

    $ pip install urllib3

Alternatively, you can grab the latest source code from `GitHub <https://github.com/urllib3/urllib3>`_::

    $ git clone git://github.com/shazow/urllib3.git
    $ python setup.py install

Usage
-----

The :doc:`user-guide` is the place to go to learn how to use the library and
accomplish common tasks. The more in-depth :doc:`advanced-usage` guide is the place to go for lower-level tweaking.

The :doc:`reference/index` documentation provides API-level documentation.

.. _who-uses:

Who uses urllib3?
-----------------

* `Requests <http://python-requests.org/>`_
* `Pip <https://pip.pypa.io>`_
* & more!

License
-------

urllib3 is made available under the MIT License. For more details, see `LICENSE.txt <https://github.com/urllib3/urllib3/blob/master/LICENSE.txt>`_.

Contributing
------------

We happily welcome contributions, please see :doc:`contributing` for details.",,a74c9cfbaed9f811e7563cfc3dce894928e0221a,CVE-2020-7212,a74c9cfbaed9f811e7563cfc3dce894928e0221a,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR ======= .. VAR:: :VAR: :VAR: 2 VAR-VAR VAR-VAR VAR/VAR VAR VAR VAR VAR VAR, *VAR-VAR* VAR VAR VAR VAR. VAR VAR VAR VAR VAR :VAR:`VAR VAR <VAR-VAR>` VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR: - VAR VAR. - VAR VAR. - VAR-VAR VAR/VAR VAR. - VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - VAR VAR VAR VAR VAR VAR. - 100% VAR VAR. VAR VAR VAR VAR VAR VAR VAR:: >>> VAR VAR >>> VAR = VAR.VAR() >>> VAR = VAR.VAR('VAR', 'VAR: >>> VAR.VAR 200 >>> VAR.VAR 'VAR-VAR: *\VAR: /VAR\VAR' VAR ---------- VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR VAR, VAR VAR VAR VAR VAR VAR VAR VAR `VAR <VAR: $ VAR VAR VAR: $ VAR VAR.VAR VAR VAR ----- VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR-VAR :VAR:`VAR-VAR` VAR VAR VAR VAR VAR VAR VAR VAR-VAR VAR. VAR :VAR:`VAR/VAR` VAR VAR VAR-VAR VAR. .. VAR-VAR: VAR VAR VAR? ----------------- * `VAR <VAR: * `VAR <VAR: * & VAR! VAR ------- VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR, VAR `VAR.VAR <VAR: VAR ------------ VAR VAR VAR VAR, VAR VAR :VAR:`VAR` VAR VAR. ",6,6
urllib3_a74c9cfbaed9f811e7563cfc3dce894928e0221a,src/urllib3/contrintlmpool.py,"""""""
NTLM authenticating pool, contributed by erikcederstran

Issue #10, see: http://code.google.com/p/urllib3/issues/detail?id=10
""""""
from __future__ import absolute_import

from logging import getLogger
from ntlm import ntlm

from .. import HTTPSConnectionPool
from ..packages.six.moves.http_client import HTTPSConnection


log = getLogger(__name__)


class NTLMConnectionPool(HTTPSConnectionPool):
    """"""
    Implements an NTLM authentication version of an urllib3 connection pool
    """"""

    scheme = 'https'

    def __init__(self, user, pw, authurl, *args, **kwargs):
        """"""
        authurl is a random URL on the server that is protected by NTLM.
        user is the Windows user, probably in the DOMAIN\\username format.
        pw is the password for the user.
        """"""
        super(NTLMConnectionPool, self).__init__(*args, **kwargs)
        self.authurl = authurl
        self.rawuser = user
        user_parts = user.split('\\', 1)
        self.domain = user_parts[0].upper()
        self.user = user_parts[1]
        self.pw = pw

    def _new_conn(self):
        # Performs the NTLM handshake that secures the connection. The socket
        # must be kept open while requests are performed.
        self.num_connections += 1
        log.debug('Starting NTLM HTTPS connection no. %d: https://%s%s',
                  self.num_connections, self.host, self.authurl)

        headers = {'Connection': 'Keep-Alive'}
        req_header = 'Authorization'
        resp_header = 'www-authenticate'

        conn = HTTPSConnection(host=self.host, port=self.port)

        # Send negotiation message
        headers[req_header] = (
            'NTLM %s' % ntlm.create_NTLM_NEGOTIATE_MESSAGE(self.rawuser))
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        reshdr = dict(res.getheaders())
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', reshdr)
        log.debug('Response data: %s [...]', res.read(100))

        # Remove the reference to the socket, so that it can not be closed by
        # the response object (we want to keep the socket open)
        res.fp = None

        # Server should respond with a challenge message
        auth_header_values = reshdr[resp_header].split(', ')
        auth_header_value = None
        for s in auth_header_values:
            if s[:5] == 'NTLM ':
                auth_header_value = s[5:]
        if auth_header_value is None:
            raise Exception('Unexpected %s response header: %s' %
                            (resp_header, reshdr[resp_header]))

        # Send authentication message
        ServerChallenge, NegotiateFlags = \
            ntlm.parse_NTLM_CHALLENGE_MESSAGE(auth_header_value)
        auth_msg = ntlm.create_NTLM_AUTHENTICATE_MESSAGE(ServerChallenge,
                                                         self.user,
                                                         self.domain,
                                                         self.pw,
                                                         NegotiateFlags)
        headers[req_header] = 'NTLM %s' % auth_msg
        log.debug('Request headers: %s', headers)
        conn.request('GET', self.authurl, None, headers)
        res = conn.getresponse()
        log.debug('Response status: %s %s', res.status, res.reason)
        log.debug('Response headers: %s', dict(res.getheaders()))
        log.debug('Response data: %s [...]', res.read()[:100])
        if res.status != 200:
            if res.status == 401:
                raise Exception('Server rejected request: wrong '
                                'username or password')
            raise Exception('Wrong server response: %s %s' %
                            (res.status, res.reason))

        res.fp = None
        log.debug('Connection established')
        return conn

    def urlopen(self, method, url, body=None, headers=None, retries=3,
                redirect=True, assert_same_host=True):
        if headers is None:
            headers = {}
        headers['Connection'] = 'Keep-Alive'
        return super(NTLMConnectionPool, self).urlopen(method, url, body,
                                                       headers, retries,
                                                       redirect,
                                                       assert_same_host)",,a74c9cfbaed9f811e7563cfc3dce894928e0221a,CVE-2020-7212,a74c9cfbaed9f811e7563cfc3dce894928e0221a,https://github.com/urllib3/urllib3,NVD_DIRECT_COMMIT,1337,COMPLETED,""""""" VAR VAR VAR, VAR VAR VAR VAR  """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR .. VAR VAR VAR ..VAR.VAR.VAR.VAR VAR VAR VAR = VAR(VAR) VAR VAR(VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR """""" VAR = 'VAR' VAR VAR(VAR, VAR, VAR, VAR, *VAR, **VAR): """""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. VAR VAR VAR VAR VAR, VAR VAR VAR VAR\\VAR VAR. VAR VAR VAR VAR VAR VAR VAR. """""" VAR(VAR, VAR).VAR(*VAR, **VAR) VAR.VAR = VAR VAR.VAR = VAR VAR = VAR.VAR('\\', 1) VAR.VAR = VAR[0].VAR() VAR.VAR = VAR[1] VAR.VAR = VAR VAR VAR(VAR):   VAR.VAR += 1 VAR.VAR('VAR VAR VAR VAR VAR. %VAR: VAR: VAR.VAR, VAR.VAR, VAR.VAR) VAR = {'VAR': 'VAR-VAR'} VAR = 'VAR' VAR = 'VAR-VAR' VAR = VAR(VAR=VAR.VAR, VAR=VAR.VAR)  VAR[VAR] = ( 'VAR %VAR' % VAR.VAR(VAR.VAR)) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR = VAR(VAR.VAR()) VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR(100))   VAR.VAR = VAR  VAR = VAR[VAR].VAR(', ') VAR = VAR VAR VAR VAR VAR: VAR VAR[:5] == 'VAR ': VAR = VAR[5:] VAR VAR VAR VAR: VAR VAR('VAR %VAR VAR VAR: %VAR' % (VAR, VAR[VAR]))  VAR, VAR = \ VAR.VAR(VAR) VAR = VAR.VAR(VAR, VAR.VAR, VAR.VAR, VAR.VAR, VAR) VAR[VAR] = 'VAR %VAR' % VAR VAR.VAR('VAR VAR: %VAR', VAR) VAR.VAR('VAR', VAR.VAR, VAR, VAR) VAR = VAR.VAR() VAR.VAR('VAR VAR: %VAR %VAR', VAR.VAR, VAR.VAR) VAR.VAR('VAR VAR: %VAR', VAR(VAR.VAR())) VAR.VAR('VAR VAR: %VAR [...]', VAR.VAR()[:100]) VAR VAR.VAR != 200: VAR VAR.VAR == 401: VAR VAR('VAR VAR VAR: VAR ' 'VAR VAR VAR') VAR VAR('VAR VAR VAR: %VAR %VAR' % (VAR.VAR, VAR.VAR)) VAR.VAR = VAR VAR.VAR('VAR VAR') VAR VAR VAR VAR(VAR, VAR, VAR, VAR=VAR, VAR=VAR, VAR=3, VAR=VAR, VAR=VAR): VAR VAR VAR VAR: VAR = {} VAR['VAR'] = 'VAR-VAR' VAR VAR(VAR, VAR).VAR(VAR, VAR, VAR, VAR, VAR, VAR, VAR) ",6,6
vim_34f8117dec685ace52cd9e578e2729db278163fc,src/testdir/test_assert.vim,"
  "" many composing characters are handled properly
  call setline(1, ' ')
  norm 100gr
  call assert_equal(1, getline(1))
  call assert_match(""Expected 1 but got '.* occurs 100 times]'"", v:errors[0])
  call remove(v:errors, 0)
  bwipe!",,34f8117dec685ace52cd9e578e2729db278163fc,CVE-2022-0629,34f8117dec685ace52cd9e578e2729db278163fc,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,""" VAR VAR VAR VAR VAR VAR VAR VAR(1, ' ') VAR 100gr VAR VAR(1, VAR(1)) VAR VAR(""VAR 1 VAR VAR '.* VAR 100 VAR]'"", VAR:VAR[0]) VAR VAR(VAR:VAR, 0) VAR! ",6,6
vim_44a3f3353e0407e9fffee138125a6927d1c9e7e5,src/ex_docmd.c,"    size_t  len = STRLEN(IObuff);
    char_u  *s = cmd;
    char_u  *d;
    if (len > IOSIZE - 100)
    {
	// Not enough space, truncate and put in ""..."".
	d = IObuff + IOSIZE - 100;
	d -= mb_head_off(IObuff, d);
	STRCPY(d, ""..."");
    }","    char_u *s = cmd;
    char_u *d;",44a3f3353e0407e9fffee138125a6927d1c9e7e5,CVE-2022-2000,44a3f3353e0407e9fffee138125a6927d1c9e7e5,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = VAR(VAR); VAR *VAR = VAR; VAR *VAR; VAR (VAR > VAR - 100) {  VAR = VAR + VAR - 100; VAR -= VAR(VAR, VAR); VAR(VAR, ""...""); } VAR *VAR = VAR; VAR *VAR;",6,6
vim_8d02ce1ed75d008c34a5c9aaa51b67cbb9d33baa,src/testdir/test_visual.vim,""" This was leaving the end of the Visual area beyond the end of a line.
"" Set 'undolevels' to start a new undo block.
func Test_visual_undo_deletes_last_line()
  new
  call setline(1, [""aaa"", ""ccc"", ""dyd""])
  set undolevels=100
  exe ""normal obbbbbbbbbxbb\<Esc>""
  set undolevels=100
  /y
  exe ""normal ggvjfxO""
  undo
  normal gNU
  bwipe!
endfunc
",,8d02ce1ed75d008c34a5c9aaa51b67cbb9d33baa,CVE-2022-0368,8d02ce1ed75d008c34a5c9aaa51b67cbb9d33baa,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,""" VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR VAR. "" VAR 'VAR' VAR VAR VAR VAR VAR VAR. VAR VAR() VAR VAR VAR(1, [""VAR"", ""VAR"", ""VAR""]) VAR VAR=100 VAR ""VAR VAR\<VAR>"" VAR VAR=100 /VAR VAR ""VAR VAR"" VAR VAR VAR VAR! VAR ",6,6
vim_ee9166eb3b41846661a39b662dc7ebe8b5e15139,src/testdir/test_crash.vim,"  let file = 'crash/poc_tagfunc.vim'
  let args = printf(cmn_args, vim, file)
  call term_sendkeys(buf, args ..
    \ '  || echo ""crash 5: [OK]"" >> X_crash1_result.txt' .. ""\<cr>"")

  call TermWait(buf, 100)

      \ 'crash 5: [OK]',","
  call delete('Xerr')",ee9166eb3b41846661a39b662dc7ebe8b5e15139,CVE-2023-4752,ee9166eb3b41846661a39b662dc7ebe8b5e15139,https://github.com/vim/vim,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR = 'VAR/VAR.VAR' VAR VAR = VAR(VAR, VAR, VAR) VAR VAR(VAR, VAR .. \ ' || VAR ""VAR 5: [VAR]"" >> VAR.VAR' .. ""\<VAR>"") VAR VAR(VAR, 100) \ 'VAR 5: [VAR]', VAR VAR('VAR')",6,6
vyper_2c73f8352635c0a433423a5b94740de1a118e508,tests/parser/types/test_string.py,"string_equality_tests = [
    (
        100,
        ""The quick brown fox jumps over the lazy dog"",
        ""The quick brown fox jumps over the lazy hog"",
    ),
    # check <= 32 codepath
    (32, ""abc"", ""abc\0""),
    (32, ""abc"", ""abc\1""),  # use a_init dirty bytes
    (32, ""abc\2"", ""abc""),  # use b_init dirty bytes
    (32, """", ""\0""),
    (32, """", ""\1""),
    (33, """", ""\1""),
    (33, """", ""\0""),
]


@pytest.mark.parametrize(""len_,a,b"", string_equality_tests)
def test_string_equality(get_contract_with_gas_estimation, len_, a, b):
    # fixtures to initialize strings with dirty bytes
    a_init = ""\\1"" * len_
    b_init = ""\\2"" * len_
    string1 = a.encode(""unicode_escape"").decode(""utf-8"")
    string2 = b.encode(""unicode_escape"").decode(""utf-8"")
    code = f""""""
a: String[{len_}]
b: String[{len_}]
    a: String[{len_}] = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    a = ""{string1}""
    b = ""{string1}""
    return a == b
    a: String[{len_}] = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    a = ""{string1}""
    b = ""{string2}""
    return a == b
    a: String[{len_}] = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    a = ""{string1}""
    b = ""{string2}""
    return a != b
    a: String[{len_}] = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    a = ""{string1}""
    b = ""{string1}""
    return a != b
    return ""{string1}"" == ""{string1}""
    return ""{string1}"" == ""{string2}""
    return ""{string1}"" != ""{string2}""
    return ""{string1}"" != ""{string1}""
    self.a = ""{a_init}""
    self.b = ""{b_init}""
    self.a = ""{string1}""
    self.b = ""{string1}""
    return self.a == self.b
    self.a = ""{a_init}""
    self.b = ""{b_init}""
    self.a = ""{string1}""
    self.b = ""{string2}""
    return self.a == self.b
    self.a = ""{a_init}""
    self.b = ""{b_init}""
    self.a = ""{string1}""
    self.b = ""{string2}""
    return self.a != self.b
    self.a = ""{a_init}""
    self.b = ""{b_init}""
    self.a = ""{string1}""
    self.b = ""{string1}""
    return self.a != self.b
def string_compare_equal(str1: String[{len_}], str2: String[{len_}]) -> bool:
def string_compare_not_equal(str1: String[{len_}], str2: String[{len_}]) -> bool:
def compare_passed_storage_equal(str_: String[{len_}]) -> bool:
    self.a = ""{a_init}""
    self.a = ""{string1}""
    return self.a == str_
def compare_passed_storage_not_equal(str_: String[{len_}]) -> bool:
    self.a = ""{a_init}""
    self.a = ""{string1}""
    return self.a != str_
    self.a = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    self.a = ""{string1}""
    b = ""{string1}""
    return self.a == b
    self.a = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    self.a = ""{string1}""
    b = ""{string2}""
    return self.a == b
    self.a = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    self.a = ""{string1}""
    b = ""{string2}""
    return self.a != b
    self.a = ""{a_init}""
    b: String[{len_}] = ""{b_init}""
    self.a = ""{string1}""
    b = ""{string1}""
    return self.a != b","def test_string_equality(get_contract_with_gas_estimation):
    code = """"""
_compA: String[100]
_compB: String[100]
    compA: String[100] = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy dog""
    return compA == compB
    compA: String[100] = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy hog""
    return compA == compB
    compA: String[100] = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy hog""
    return compA != compB
    compA: String[100] = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy dog""
    return compA != compB
    return ""The quick brown fox jumps over the lazy dog"" == \
    ""The quick brown fox jumps over the lazy dog""
    return ""The quick brown fox jumps over the lazy dog"" == \
    ""The quick brown fox jumps over the lazy hog""
    return ""The quick brown fox jumps over the lazy dog"" != \
    ""The quick brown fox jumps over the lazy hog""
    return ""The quick brown fox jumps over the lazy dog"" != \
    ""The quick brown fox jumps over the lazy dog""
    self._compA = ""The quick brown fox jumps over the lazy dog""
    self._compB = ""The quick brown fox jumps over the lazy dog""
    return self._compA == self._compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    self._compB = ""The quick brown fox jumps over the lazy hog""
    return self._compA == self._compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    self._compB = ""The quick brown fox jumps over the lazy hog""
    return self._compA != self._compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    self._compB = ""The quick brown fox jumps over the lazy dog""
    return self._compA != self._compB
def string_compare_equal(str1: String[100], str2: String[100]) -> bool:
def string_compare_not_equal(str1: String[100], str2: String[100]) -> bool:
def compare_passed_storage_equal(str: String[100]) -> bool:
    self._compA = ""The quick brown fox jumps over the lazy dog""
    return self._compA == str
def compare_passed_storage_not_equal(str: String[100]) -> bool:
    self._compA = ""The quick brown fox jumps over the lazy dog""
    return self._compA != str
    self._compA = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy dog""
    return self._compA == compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy hog""
    return self._compA == compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy hog""
    return self._compA != compB
    self._compA = ""The quick brown fox jumps over the lazy dog""
    compB: String[100] = ""The quick brown fox jumps over the lazy dog""
    return self._compA != compB
    a = ""The quick brown fox jumps over the lazy dog""
    b = ""The quick brown fox jumps over the lazy hog""",2c73f8352635c0a433423a5b94740de1a118e508,CVE-2022-24787,2c73f8352635c0a433423a5b94740de1a118e508,https://github.com/vyperlang/vyper,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR = [ ( 100, ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"", ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"", ),  (32, ""VAR"", ""VAR\0""), (32, ""VAR"", ""VAR\1""),  (32, ""VAR\2"", ""VAR""),  (32, """", ""\0""), (32, """", ""\1""), (33, """", ""\1""), (33, """", ""\0""), ] @VAR.VAR.VAR(""VAR,VAR,VAR"", VAR) VAR VAR(VAR, VAR, VAR, VAR):  VAR = ""\\1"" * VAR VAR = ""\\2"" * VAR VAR = VAR.VAR(""VAR"").VAR(""VAR-8"") VAR = VAR.VAR(""VAR"").VAR(""VAR-8"") VAR = VAR"""""" VAR: VAR[{VAR}] VAR: VAR[{VAR}] VAR: VAR[{VAR}] = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR == VAR VAR: VAR[{VAR}] = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR == VAR VAR: VAR[{VAR}] = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR != VAR VAR: VAR[{VAR}] = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR != VAR VAR ""{VAR}"" == ""{VAR}"" VAR ""{VAR}"" == ""{VAR}"" VAR ""{VAR}"" != ""{VAR}"" VAR ""{VAR}"" != ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR == VAR.VAR VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR == VAR.VAR VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR != VAR.VAR VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR != VAR.VAR VAR VAR(VAR: VAR[{VAR}], VAR: VAR[{VAR}]) -> VAR: VAR VAR(VAR: VAR[{VAR}], VAR: VAR[{VAR}]) -> VAR: VAR VAR(VAR: VAR[{VAR}]) -> VAR: VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR == VAR VAR VAR(VAR: VAR[{VAR}]) -> VAR: VAR.VAR = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR VAR.VAR != VAR VAR.VAR = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR.VAR == VAR VAR.VAR = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR.VAR == VAR VAR.VAR = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR.VAR != VAR VAR.VAR = ""{VAR}"" VAR: VAR[{VAR}] = ""{VAR}"" VAR.VAR = ""{VAR}"" VAR = ""{VAR}"" VAR VAR.VAR != VAR VAR VAR(VAR): VAR = """""" VAR: VAR[100] VAR: VAR[100] VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR == VAR VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR == VAR VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR != VAR VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR != VAR VAR ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" == \ ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" == \ ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" != \ ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" != \ ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR == VAR.VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR == VAR.VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR != VAR.VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR != VAR.VAR VAR VAR(VAR: VAR[100], VAR: VAR[100]) -> VAR: VAR VAR(VAR: VAR[100], VAR: VAR[100]) -> VAR: VAR VAR(VAR: VAR[100]) -> VAR: VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR == VAR VAR VAR(VAR: VAR[100]) -> VAR: VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR != VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR == VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR == VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR != VAR VAR.VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR: VAR[100] = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR VAR.VAR != VAR VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR"" VAR = ""VAR VAR VAR VAR VAR VAR VAR VAR VAR""",6,6
xwiki-platform_71f889db9962df2d385f4298e29cfbc9050b828a,xwiki-platform-core/xwiki-platform-livetable/xwiki-platform-livetable-ui/src/test/java/org/xwiki/livetable/LiveTableResultsTest.java,"import java.util.stream.Stream;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;
import org.xwiki.mail.GeneralMailConfiguration;
import org.xwiki.mail.MailSender;
import org.xwiki.mail.script.MailScriptServiceComponentList;
import org.xwiki.test.junit5.mockito.MockComponent;
import com.xpn.xwiki.objects.BaseObject;
import static java.util.Collections.singletonList;
import static org.xwiki.rendering.syntax.Syntax.XWIKI_2_1;
 *
@MailScriptServiceComponentList
    @MockComponent
    private GeneralMailConfiguration generalMailConfiguration;


        // Mock this component as we are not interested in mail sending in this test suite.
        this.componentManager.registerMockComponent(MailSender.class);
        this.componentManager.registerMockComponent(ScriptService.class, ""mail.storage"");
    private static Stream<Arguments> provideObfuscateEmails()
    {
        return Stream.of(
            Arguments.of(
                true,
                "", BaseObject as obj , StringProperty as prop_name  ""
                    + ""where obj.name=doc.fullName ""
                    + ""and obj.className = :className ""
                    + ""and doc.fullName not in (:classTemplate1, :classTemplate2)  ""
                    + ""and obj.id = prop_name.id.id ""
                    + ""and prop_name.id.name = :prop_name_id_name ""
                    + ""and (upper(prop_name.value) like upper(:prop_name_value_1)) "",
                Map.of(
                    ""className"", ""Space.MyClass"",
                    ""classTemplate1"", ""Space.MyClassTemplate"",
                    ""classTemplate2"", ""Space.MyTemplate"",
                    ""prop_name_id_name"", ""name"",
                    ""prop_name_value_1"", ""%filtername%""
                ),
                ""t...@mail.com"",
                ""t...@mail.com""
            ),
            Arguments.of(
                false,
                "", BaseObject as obj , StringProperty as prop_mail, StringProperty as prop_name  ""
                    + ""where obj.name=doc.fullName ""
                    + ""and obj.className = :className ""
                    + ""and doc.fullName not in (:classTemplate1, :classTemplate2)  ""
                    + ""and obj.id = prop_mail.id.id ""
                    + ""and prop_mail.id.name = :prop_mail_id_name ""
                    + ""and (upper(prop_mail.value) like upper(:prop_mail_value_1)) ""
                    + ""and obj.id = prop_name.id.id ""
                    + ""and prop_name.id.name = :prop_name_id_name ""
                    + ""and (upper(prop_name.value) like upper(:prop_name_value_1)) "",
                Map.of(
                    ""className"", ""Space.MyClass"",
                    ""classTemplate1"", ""Space.MyClassTemplate"",
                    ""classTemplate2"", ""Space.MyTemplate"",
                    ""prop_mail_id_name"", ""mail"",
                    ""prop_mail_value_1"", ""%filtermail%"",
                    ""prop_name_id_name"", ""name"",
                    ""prop_name_value_1"", ""%filtername%""),
                ""<a href=\""mailto:test@mail.com\"">test@mail.com</a>"",
                ""test@mail.com""
            )
        );
    }

    @ParameterizedTest
    @MethodSource(""provideObfuscateEmails"")
    void obfuscateEmails(boolean obfuscate, String expectedHql, Map<String, Object> expectedBindValues,
        String expectedMail, String expectedMailValue) throws Exception
    {
        // TODO: We mock the mail configuration as it relies on document that are loaded through xar files from external
        //  modules, which is currently not possible (would it be loaded using a mandatory document initializer, it
        //  would work though).
        when(this.generalMailConfiguration.shouldObfuscate()).thenReturn(obfuscate);

        DocumentReference myClassReference = new DocumentReference(""xwiki"", ""Space"", ""MyClass"");
        XWikiDocument xClassDocument = new XWikiDocument(myClassReference);
        xClassDocument.getXClass().addEmailField(""mail"", ""Email"", 100);
        xClassDocument.getXClass().addTextField(""name"", ""Name"", 100);
        this.xwiki.saveDocument(xClassDocument, this.context);

        XWikiDocument xObjectDocument = new XWikiDocument(new DocumentReference(""xwiki"", ""Space"", ""MyObject""));
        xObjectDocument.setSyntax(XWIKI_2_1);
        BaseObject baseObject = xObjectDocument.newXObject(myClassReference, this.context);
        baseObject.set(""mail"", ""test@mail.com"", this.context);
        baseObject.set(""name"", ""testName"", this.context);
        this.xwiki.saveDocument(xObjectDocument, this.context);

        setColumns(""mail,name"");
        setClassName(""Space.MyClass"");
        setFilter(""mail"", ""filtermail"");
        setFilter(""name"", ""filtername"");

        when(this.queryService.hql(anyString())).thenReturn(this.query);
        when(this.query.setLimit(anyInt())).thenReturn(this.query);
        when(this.query.setOffset(anyInt())).thenReturn(this.query);
        when(this.query.bindValues(any(Map.class))).thenReturn(this.query);
        when(this.query.count()).thenReturn(1L);
        when(this.query.execute()).thenReturn(singletonList(""Space.MyObject""));

        renderPage();

        List<Map<String, Object>> rows = getRows();
        assertEquals(expectedMail, StringUtils.trim((String) rows.get(0).get(""mail"")));
        assertEquals(expectedMailValue, rows.get(0).get(""mail_value""));

        verify(this.queryService).hql(expectedHql);
        verify(this.query).bindValues(expectedBindValues);
    }
", *,71f889db9962df2d385f4298e29cfbc9050b828a,CVE-2023-34467,71f889db9962df2d385f4298e29cfbc9050b828a,https://github.com/xwiki/xwiki-platform,NVD_DIRECT_COMMIT,1337,COMPLETED,"VAR VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR.VAR; VAR VAR.VAR.VAR.VAR.VAR; VAR VAR VAR.VAR.VAR.VAR; VAR VAR VAR.VAR.VAR.VAR.VAR.VAR; * @VAR @VAR VAR VAR VAR;  VAR.VAR.VAR(VAR.VAR); VAR.VAR.VAR(VAR.VAR, ""VAR.VAR""); VAR VAR VAR<VAR> VAR() { VAR VAR.VAR( VAR.VAR( VAR, "", VAR VAR VAR , VAR VAR VAR "" + ""VAR VAR.VAR=VAR.VAR "" + ""VAR VAR.VAR = :VAR "" + ""VAR VAR.VAR VAR VAR (:VAR, :VAR) "" + ""VAR VAR.VAR = VAR.VAR.VAR "" + ""VAR VAR.VAR.VAR = :VAR "" + ""VAR (VAR(VAR.VAR) VAR VAR(:VAR)) "", VAR.VAR( ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR"", ""VAR"", ""%VAR%"" ), ""VAR...@VAR.VAR"", ""VAR...@VAR.VAR"" ), VAR.VAR( VAR, "", VAR VAR VAR , VAR VAR VAR, VAR VAR VAR "" + ""VAR VAR.VAR=VAR.VAR "" + ""VAR VAR.VAR = :VAR "" + ""VAR VAR.VAR VAR VAR (:VAR, :VAR) "" + ""VAR VAR.VAR = VAR.VAR.VAR "" + ""VAR VAR.VAR.VAR = :VAR "" + ""VAR (VAR(VAR.VAR) VAR VAR(:VAR)) "" + ""VAR VAR.VAR = VAR.VAR.VAR "" + ""VAR VAR.VAR.VAR = :VAR "" + ""VAR (VAR(VAR.VAR) VAR VAR(:VAR)) "", VAR.VAR( ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR.VAR"", ""VAR"", ""VAR"", ""VAR"", ""%VAR%"", ""VAR"", ""VAR"", ""VAR"", ""%VAR%""), ""<VAR VAR=\""VAR:VAR@VAR.VAR\"">VAR@VAR.VAR</VAR>"", ""VAR@VAR.VAR"" ) ); } @VAR @VAR(""VAR"") VAR VAR(VAR VAR, VAR VAR, VAR<VAR, VAR> VAR, VAR VAR, VAR VAR) VAR VAR {    VAR(VAR.VAR.VAR()).VAR(VAR); VAR VAR = VAR VAR(""VAR"", ""VAR"", ""VAR""); VAR VAR = VAR VAR(VAR); VAR.VAR().VAR(""VAR"", ""VAR"", 100); VAR.VAR().VAR(""VAR"", ""VAR"", 100); VAR.VAR.VAR(VAR, VAR.VAR); VAR VAR = VAR VAR(VAR VAR(""VAR"", ""VAR"", ""VAR"")); VAR.VAR(VAR); VAR VAR = VAR.VAR(VAR, VAR.VAR); VAR.VAR(""VAR"", ""VAR@VAR.VAR"", VAR.VAR); VAR.VAR(""VAR"", ""VAR"", VAR.VAR); VAR.VAR.VAR(VAR, VAR.VAR); VAR(""VAR,VAR""); VAR(""VAR.VAR""); VAR(""VAR"", ""VAR""); VAR(""VAR"", ""VAR""); VAR(VAR.VAR.VAR(VAR())).VAR(VAR.VAR); VAR(VAR.VAR.VAR(VAR())).VAR(VAR.VAR); VAR(VAR.VAR.VAR(VAR())).VAR(VAR.VAR); VAR(VAR.VAR.VAR(VAR(VAR.VAR))).VAR(VAR.VAR); VAR(VAR.VAR.VAR()).VAR(1L); VAR(VAR.VAR.VAR()).VAR(VAR(""VAR.VAR"")); VAR(); VAR<VAR<VAR, VAR>> VAR = VAR(); VAR(VAR, VAR.VAR((VAR) VAR.VAR(0).VAR(""VAR""))); VAR(VAR, VAR.VAR(0).VAR(""VAR"")); VAR(VAR.VAR).VAR(VAR); VAR(VAR.VAR).VAR(VAR); } *",6,6
